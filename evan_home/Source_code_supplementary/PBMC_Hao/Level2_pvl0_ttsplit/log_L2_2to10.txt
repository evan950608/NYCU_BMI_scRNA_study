nohup: ignoring input
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
Original adata: (32340, 20568)
all cell types: ['ASDC', 'B_intermediate', 'B_memory', 'B_naive', 'CD14_Mono', 'CD16_Mono', 'CD4_CTL', 'CD4_Naive', 'CD4_Proliferating', 'CD4_TCM', 'CD4_TEM', 'CD8_Naive', 'CD8_Proliferating', 'CD8_TCM', 'CD8_TEM', 'Doublet', 'Eryth', 'HSPC', 'ILC', 'MAIT', 'NK', 'NK_CD56bright', 'NK_Proliferating', 'Plasmablast', 'Platelet', 'Treg', 'cDC1', 'cDC2', 'dnT', 'gdT', 'pDC']
cts ['B_intermediate', 'B_memory', 'B_naive', 'CD14_Mono', 'CD16_Mono', 'CD4_CTL', 'CD4_Naive', 'CD4_Proliferating', 'CD4_TCM']
====================
Original adata: (32340, 20568)
adata celltype shape: (486, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 15319)
====================
Starting job for B_intermediate
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.303 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 12.539 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 11.625 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 11.966 min
==========
Lambda: 0.0002154434690031884
QWL-QN convergence
lambda is : 0.0002154434690031884, cost : 47.684 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 12.177 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 12.362 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 12.451 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 12.882 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 14.306 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 15.46 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 19.818 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 20.112 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 25.929 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 27.286 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 30.692 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 33.775 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 31.756 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 33.876 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 55.163 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 53.281 min
==========
Lambda: 0.00010000000000000009
QWL-QN convergence
lambda is : 0.00010000000000000009, cost : 55.424 min
==========
Lambda: 0.0010000000000000002
QWL-QN did not convergence
lambda is : 0.0010000000000000002, cost : 64.259 min
==========
Lambda: 0.0004641588833612784
QWL-QN did not convergence
lambda is : 0.0004641588833612784, cost : 64.49 min
==========
Lambda: 0.0006812920690579617
QWL-QN did not convergence
lambda is : 0.0006812920690579617, cost : 65.055 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.046415888336127815
B_intermediate Time elapsed: 65.10381679534912 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (657, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 15674)
====================
Starting job for B_memory
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.282 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 11.781 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 12.535 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 12.856 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 12.875 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 14.772 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 15.164 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 18.794 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 19.054 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 21.024 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 21.047 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 23.541 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 24.758 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 26.122 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 30.431 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 32.222 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 40.562 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 44.25 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 46.251 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 51.318 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 54.699 min
==========
Lambda: 0.00010000000000000009
QWL-QN convergence
lambda is : 0.00010000000000000009, cost : 55.8 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 61.099 min
==========
Lambda: 0.0014677992676220707
QWL-QN did not convergence
lambda is : 0.0014677992676220707, cost : 64.18 min
==========
Lambda: 0.0002154434690031884
QWL-QN did not convergence
lambda is : 0.0002154434690031884, cost : 64.736 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.046415888336127815
B_memory Time elapsed: 64.78407170772553 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (1543, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 16507)
====================
Starting job for B_naive
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.324 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 0.494 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 0.499 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 0.555 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 52.456 min
==========
Lambda: 0.00010000000000000009
QWL-QN convergence
lambda is : 0.00010000000000000009, cost : 0.565 min
==========
Lambda: 0.0002154434690031884
QWL-QN convergence
lambda is : 0.0002154434690031884, cost : 0.572 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 7.862 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 9.721 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 9.965 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 10.98 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 13.71 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 19.044 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 19.254 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 21.28 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 19.438 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 21.368 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 24.389 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 26.963 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 29.513 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 33.307 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 33.694 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 34.785 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 37.135 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 38.797 min
==========
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_tuning.py:753: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, ax1 = plt.subplots(figsize = (fig_width,fig_height))
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.0006812920690579617
B_naive Time elapsed: 52.507130984465284 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (8538, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 19144)
====================
Starting job for CD14_Mono
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.293 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 23.474 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 0.313 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 49.474 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 0.325 min
==========
Lambda: 0.0010000000000000002
QWL-QN did not convergence
lambda is : 0.0010000000000000002, cost : 67.207 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 9.607 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 12.463 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 24.399 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 25.891 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 26.919 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 30.507 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 37.342 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 38.514 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 44.943 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 48.953 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 49.855 min
==========
Lambda: 0.00010000000000000009
QWL-QN convergence
lambda is : 0.00010000000000000009, cost : 49.735 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 57.378 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 60.819 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 61.648 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 66.171 min
==========
Lambda: 0.0006812920690579617
QWL-QN did not convergence
lambda is : 0.0006812920690579617, cost : 66.405 min
==========
Lambda: 0.0002154434690031884
QWL-QN did not convergence
lambda is : 0.0002154434690031884, cost : 67.045 min
==========
Lambda: 0.0014677992676220707
QWL-QN did not convergence
lambda is : 0.0014677992676220707, cost : 67.32 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.004641588833612781
CD14_Mono Time elapsed: 67.37442657550176 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (1264, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 16819)
====================
Starting job for CD16_Mono
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.284 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 0.58 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 33.152 min
==========
Lambda: 0.0002154434690031884
QWL-QN convergence
lambda is : 0.0002154434690031884, cost : 0.602 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 0.687 min
==========
Lambda: 0.00010000000000000009
QWL-QN convergence
lambda is : 0.00010000000000000009, cost : 0.692 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 8.849 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 10.572 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 10.594 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 10.717 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 10.935 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 12.935 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 14.401 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 14.974 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 20.928 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 22.159 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 30.115 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 33.646 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 37.241 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 39.967 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 41.275 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 41.365 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 42.042 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 43.805 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 61.63 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.003162277660168382
CD16_Mono Time elapsed: 61.68309869766235 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (347, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 13458)
====================
Starting job for CD4_CTL
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.298 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 17.548 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 10.973 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 48.918 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 12.052 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 12.137 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 12.951 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 13.527 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 14.965 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 18.989 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 20.019 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 21.299 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 21.566 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 22.409 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 29.374 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 35.953 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 37.515 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 44.187 min
==========
Lambda: 0.00010000000000000009
QWL-QN convergence
lambda is : 0.00010000000000000009, cost : 48.407 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 54.299 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 55.025 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 55.063 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 56.843 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 57.32 min
==========
Lambda: 0.0002154434690031884
QWL-QN convergence
lambda is : 0.0002154434690031884, cost : 62.547 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.046415888336127815
CD4_CTL Time elapsed: 62.592504445711775 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (3495, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 17449)
====================
Starting job for CD4_Naive
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.329 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 0.552 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 0.623 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 0.653 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 0.657 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 0.664 min
==========
Lambda: 0.00010000000000000009
QWL-QN convergence
lambda is : 0.00010000000000000009, cost : 0.665 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 0.669 min
==========
Lambda: 0.0002154434690031884
QWL-QN convergence
lambda is : 0.0002154434690031884, cost : 0.681 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 8.887 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 9.445 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 10.18 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 10.923 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 11.009 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 15.473 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 17.086 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 22.203 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 24.287 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 25.615 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 41.265 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 41.496 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 31.952 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 45.86 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 46.604 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 51.244 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.0010000000000000002
CD4_Naive Time elapsed: 51.3022502541542 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (21, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 8587)
====================
Starting job for CD4_Proliferating
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_tuning.py:158: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.242 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 10.693 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 17.219 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 11.077 min
==========
Lambda: 0.00014677992676220703
QWL-QN did not convergence
lambda is : 0.00014677992676220703, cost : 55.655 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 11.462 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 11.509 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 12.394 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 12.415 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 13.732 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 15.522 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 15.87 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 15.9 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 17.09 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 17.536 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 17.683 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 19.983 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 21.878 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 20.178 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 24.327 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 48.245 min
==========
Lambda: 0.0002154434690031884
QWL-QN did not convergence
lambda is : 0.0002154434690031884, cost : 55.549 min
==========
Lambda: 0.0003162277660168384
QWL-QN did not convergence
lambda is : 0.0003162277660168384, cost : 55.616 min
==========
Lambda: 0.00010000000000000009
QWL-QN did not convergence
lambda is : 0.00010000000000000009, cost : 55.66 min
==========
Lambda: 0.0004641588833612784
QWL-QN did not convergence
lambda is : 0.0004641588833612784, cost : 55.815 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.010000000000000004
CD4_Proliferating Time elapsed: 55.85996204217275 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (2977, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 17368)
====================
Starting job for CD4_TCM
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.3 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 0.592 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 0.597 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 17.715 min
==========
Lambda: 0.0002154434690031884
QWL-QN convergence
lambda is : 0.0002154434690031884, cost : 0.598 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 0.612 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 0.623 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 0.625 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 0.64 min
==========
Lambda: 0.00010000000000000009
QWL-QN convergence
lambda is : 0.00010000000000000009, cost : 0.676 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 9.568 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 10.101 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 10.715 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 10.717 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 12.38 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 10.826 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 13.334 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 18.701 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 21.261 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 31.239 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 33.178 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 33.498 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 33.589 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 37.511 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 46.141 min
==========
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.0010000000000000002
CD4_TCM Time elapsed: 46.200775516033175 minutes.
***** Finished lambda tuning
====================

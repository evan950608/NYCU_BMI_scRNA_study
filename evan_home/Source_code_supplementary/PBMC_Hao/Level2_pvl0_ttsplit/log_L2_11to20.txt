nohup: ignoring input
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
Original adata: (32340, 20568)
all cell types: ['ASDC', 'B_intermediate', 'B_memory', 'B_naive', 'CD14_Mono', 'CD16_Mono', 'CD4_CTL', 'CD4_Naive', 'CD4_Proliferating', 'CD4_TCM', 'CD4_TEM', 'CD8_Naive', 'CD8_Proliferating', 'CD8_TCM', 'CD8_TEM', 'Doublet', 'Eryth', 'HSPC', 'ILC', 'MAIT', 'NK', 'NK_CD56bright', 'NK_Proliferating', 'Plasmablast', 'Platelet', 'Treg', 'cDC1', 'cDC2', 'dnT', 'gdT', 'pDC']
cts ['CD4_TEM', 'CD8_Naive', 'CD8_Proliferating', 'CD8_TCM', 'CD8_TEM', 'Doublet', 'Eryth', 'HSPC', 'ILC', 'MAIT']
====================
Original adata: (32340, 20568)
adata celltype shape: (856, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 15467)
====================
Starting job for CD4_TEM
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.308 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 13.328 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 11.372 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 11.853 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 42.52 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 11.973 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 12.16 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 14.365 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 14.539 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 14.843 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 15.302 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 23.818 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 24.296 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 25.089 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 26.475 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 32.356 min
==========
Lambda: 0.00010000000000000009
QWL-QN convergence
lambda is : 0.00010000000000000009, cost : 37.7 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 38.293 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 39.498 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 40.995 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 44.467 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 46.234 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 47.405 min
==========
Lambda: 0.0002154434690031884
QWL-QN convergence
lambda is : 0.0002154434690031884, cost : 48.223 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 52.54 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.06812920690579614
CD4_TEM Time elapsed: 52.58892039457957 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (2153, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 17112)
====================
Starting job for CD8_Naive
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.318 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 22.238 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 0.55 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 39.444 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 0.554 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 0.561 min
==========
Lambda: 0.0002154434690031884
QWL-QN convergence
lambda is : 0.0002154434690031884, cost : 0.565 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 0.576 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 0.588 min
==========
Lambda: 0.00010000000000000009
QWL-QN convergence
lambda is : 0.00010000000000000009, cost : 0.615 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 9.97 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 10.011 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 10.239 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 10.451 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 12.069 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 23.903 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 24.256 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 25.591 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 25.771 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 30.449 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 38.248 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 39.181 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 39.314 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 55.997 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 40.359 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.0006812920690579617
CD8_Naive Time elapsed: 56.04587130943934 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (18, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 9184)
====================
Starting job for CD8_Proliferating
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.244 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 11.201 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 11.8 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 27.403 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 11.853 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 12.135 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 12.853 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 13.603 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 14.606 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 14.639 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 14.758 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 14.87 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 16.026 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 16.864 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 19.023 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 19.996 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 21.456 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 21.554 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 24.444 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 25.872 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 34.261 min
==========
Lambda: 0.00014677992676220703
QWL-QN did not convergence
lambda is : 0.00014677992676220703, cost : 57.315 min
==========
Lambda: 0.0002154434690031884
QWL-QN did not convergence
lambda is : 0.0002154434690031884, cost : 57.065 min
==========
Lambda: 0.00010000000000000009
QWL-QN did not convergence
lambda is : 0.00010000000000000009, cost : 57.382 min
==========
Lambda: 0.0003162277660168384
QWL-QN did not convergence
lambda is : 0.0003162277660168384, cost : 57.58 min
==========
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_tuning.py:753: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, ax1 = plt.subplots(figsize = (fig_width,fig_height))
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.010000000000000004
CD8_Proliferating Time elapsed: 57.62985082467397 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (576, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 15046)
====================
Starting job for CD8_TCM
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.29 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 11.962 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 11.895 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 12.071 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 12.237 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 12.259 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 12.677 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 12.779 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 12.926 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 13.954 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 16.639 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 16.961 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 21.648 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 32.915 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 38.005 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 42.962 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 34.061 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 44.984 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 43.421 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 47.034 min
==========
Lambda: 0.0002154434690031884
QWL-QN convergence
lambda is : 0.0002154434690031884, cost : 45.019 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 45.625 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 46.608 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.046415888336127815
CD8_TCM Time elapsed: 49.239512995878854 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (2345, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 17078)
====================
Starting job for CD8_TEM
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.328 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 0.639 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 0.65 min
==========
Lambda: 0.0002154434690031884
QWL-QN convergence
lambda is : 0.0002154434690031884, cost : 0.65 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 0.656 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 0.66 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 0.663 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 0.672 min
==========
Lambda: 0.00010000000000000009
QWL-QN convergence
lambda is : 0.00010000000000000009, cost : 0.724 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 6.075 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 7.921 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 9.346 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 10.041 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 10.259 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 11.415 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 21.116 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 21.222 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 23.958 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 24.248 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 25.91 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 25.95 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 38.154 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 28.926 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.0010000000000000002
CD8_TEM Time elapsed: 38.21606027682622 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (121, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 13100)
====================
Starting job for Doublet
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 11.835 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 12.004 min
==========
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.267 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 58.857 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 12.382 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 13.632 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 13.641 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 15.141 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 15.244 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 15.648 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 15.837 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 15.846 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 18.661 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 19.16 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 19.835 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 21.927 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 24.0 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 42.584 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 45.732 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 43.326 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 46.954 min
==========
Lambda: 0.0002154434690031884
QWL-QN did not convergence
lambda is : 0.0002154434690031884, cost : 63.982 min
==========
Lambda: 0.0003162277660168384
QWL-QN did not convergence
lambda is : 0.0003162277660168384, cost : 64.033 min
==========
Lambda: 0.0014677992676220707
QWL-QN did not convergence
lambda is : 0.0014677992676220707, cost : 64.568 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.014677992676220709
Doublet Time elapsed: 64.61929319699605 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (16, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 2804)
====================
Starting job for Eryth
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 5.441 min
==========
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.113 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 5.638 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 5.769 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 5.897 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 5.963 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 5.966 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 5.997 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 6.051 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 6.221 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 6.227 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 6.707 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 6.898 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 7.549 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 8.928 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 7.765 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 8.337 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 8.368 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 12.796 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 15.13 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 15.651 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 26.235 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 15.84 min
==========
Lambda: 0.0002154434690031884
QWL-QN convergence
lambda is : 0.0002154434690031884, cost : 16.502 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.010000000000000004
Eryth Time elapsed: 26.30174123843511 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (65, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 12633)
====================
Starting job for HSPC
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 14.51 min
==========
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.26 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 14.759 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 15.2 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 27.914 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 15.823 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 16.435 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 16.86 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 17.936 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 18.0 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 18.457 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 19.723 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 20.607 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 20.787 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 21.58 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 24.089 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 39.92 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 51.128 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 28.773 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 62.173 min
==========
Lambda: 0.0002154434690031884
QWL-QN did not convergence
lambda is : 0.0002154434690031884, cost : 63.975 min
==========
Lambda: 0.00014677992676220703
QWL-QN did not convergence
lambda is : 0.00014677992676220703, cost : 64.134 min
==========
Lambda: 0.00010000000000000009
QWL-QN did not convergence
lambda is : 0.00010000000000000009, cost : 64.173 min
==========
Lambda: 0.0004641588833612784
QWL-QN did not convergence
lambda is : 0.0004641588833612784, cost : 64.265 min
==========
Lambda: 0.0006812920690579617
QWL-QN did not convergence
lambda is : 0.0006812920690579617, cost : 64.986 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.014677992676220709
HSPC Time elapsed: 65.03782977660497 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (26, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 8935)
====================
Starting job for ILC
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.249 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 11.064 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 11.9 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 12.38 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 12.514 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 14.799 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 12.62 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 15.341 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 15.381 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 16.373 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 17.238 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 18.224 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 19.168 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 19.76 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 20.857 min
==========
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 22.186 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 22.88 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 25.519 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 27.251 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 54.119 min
==========
Lambda: 0.0003162277660168384
QWL-QN did not convergence
lambda is : 0.0003162277660168384, cost : 58.826 min
==========
Lambda: 0.0002154434690031884
QWL-QN did not convergence
lambda is : 0.0002154434690031884, cost : 58.712 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 28.529 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 29.858 min
==========
/opt/conda/lib/python3.11/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.010000000000000004
ILC Time elapsed: 58.90464565753937 minutes.
***** Finished lambda tuning
====================
Original adata: (32340, 20568)
adata celltype shape: (556, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 14526)
====================
Starting job for MAIT
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:460: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 0.6812920690579616
QWL-QN convergence
lambda is : 0.6812920690579616, cost : 11.904 min
==========
Lambda: 1.0
QWL-QN convergence
lambda is : 1.0, cost : 0.26 min
==========
Lambda: 0.31622776601683833
QWL-QN convergence
lambda is : 0.31622776601683833, cost : 12.332 min
==========
Lambda: 0.146779926762207
QWL-QN convergence
lambda is : 0.146779926762207, cost : 12.401 min
==========
Lambda: 0.10000000000000006
QWL-QN convergence
lambda is : 0.10000000000000006, cost : 12.436 min
==========
Lambda: 0.06812920690579614
QWL-QN convergence
lambda is : 0.06812920690579614, cost : 13.193 min
==========
Lambda: 0.02154434690031885
QWL-QN convergence
lambda is : 0.02154434690031885, cost : 13.332 min
==========
Lambda: 0.031622776601683826
QWL-QN convergence
lambda is : 0.031622776601683826, cost : 13.494 min
==========
Lambda: 0.046415888336127815
QWL-QN convergence
lambda is : 0.046415888336127815, cost : 13.635 min
==========
Lambda: 0.014677992676220709
QWL-QN convergence
lambda is : 0.014677992676220709, cost : 17.41 min
==========
Lambda: 0.010000000000000004
QWL-QN convergence
lambda is : 0.010000000000000004, cost : 21.464 min
==========
Lambda: 0.46415888336127825
QWL-QN convergence
lambda is : 0.46415888336127825, cost : 13.879 min
==========
Lambda: 0.004641588833612781
QWL-QN convergence
lambda is : 0.004641588833612781, cost : 32.417 min
==========
Lambda: 0.003162277660168382
QWL-QN convergence
lambda is : 0.003162277660168382, cost : 30.723 min
==========
Lambda: 0.21544346900318853
QWL-QN convergence
lambda is : 0.21544346900318853, cost : 24.65 min
==========
Lambda: 0.006812920690579619
QWL-QN convergence
lambda is : 0.006812920690579619, cost : 35.365 min
==========
Lambda: 0.0021544346900318864
QWL-QN convergence
lambda is : 0.0021544346900318864, cost : 36.06 min
==========
Lambda: 0.0014677992676220707
QWL-QN convergence
lambda is : 0.0014677992676220707, cost : 40.666 min
==========
Lambda: 0.0003162277660168384
QWL-QN convergence
lambda is : 0.0003162277660168384, cost : 53.558 min
==========
Lambda: 0.0004641588833612784
QWL-QN convergence
lambda is : 0.0004641588833612784, cost : 51.62 min
==========
Lambda: 0.0002154434690031884
QWL-QN convergence
lambda is : 0.0002154434690031884, cost : 53.599 min
==========
Lambda: 0.0006812920690579617
QWL-QN convergence
lambda is : 0.0006812920690579617, cost : 45.464 min
==========
Lambda: 0.0010000000000000002
QWL-QN convergence
lambda is : 0.0010000000000000002, cost : 54.191 min
==========
Lambda: 0.00010000000000000009
QWL-QN convergence
lambda is : 0.00010000000000000009, cost : 59.105 min
==========
Lambda: 0.00014677992676220703
QWL-QN convergence
lambda is : 0.00014677992676220703, cost : 61.112 min
==========
*** Start parallel lambda tuning ***
*** Collecting results ***
Optimal lambda: 0.046415888336127815
MAIT Time elapsed: 61.1640572309494 minutes.
***** Finished lambda tuning
====================

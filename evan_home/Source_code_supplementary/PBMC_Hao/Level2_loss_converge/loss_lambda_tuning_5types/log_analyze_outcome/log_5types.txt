nohup: ignoring input
/opt/conda/lib/python3.10/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
Original adata: (32340, 20568)
all cell types: ['ASDC', 'B_intermediate', 'B_memory', 'B_naive', 'CD14_Mono', 'CD16_Mono', 'CD4_CTL', 'CD4_Naive', 'CD4_Proliferating', 'CD4_TCM', 'CD4_TEM', 'CD8_Naive', 'CD8_Proliferating', 'CD8_TCM', 'CD8_TEM', 'Doublet', 'Eryth', 'HSPC', 'ILC', 'MAIT', 'NK', 'NK_CD56bright', 'NK_Proliferating', 'Plasmablast', 'Platelet', 'Treg', 'cDC1', 'cDC2', 'dnT', 'gdT', 'pDC']
====================
cts ['B_memory', 'CD16_Mono', 'CD4_CTL', 'CD4_TCM', 'NK']
====================
Original adata: (32340, 20568)
adata celltype shape: (657, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 15674)
====================
Starting job for B_memory
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
Hessian initialization fail, gradient diff = 0
lambda is : 1.0, cost : 0.301 min
==========
Lambda: 0.31622776601683833
Hessian initialization fail, gradient diff = 0
lambda is : 0.31622776601683833, cost : 12.547 min
==========
Lambda: 0.6812920690579616
Hessian initialization fail, gradient diff = 0
lambda is : 0.6812920690579616, cost : 17.022 min
==========
Lambda: 0.02154434690031885
Hessian initialization fail, gradient diff = 0
lambda is : 0.02154434690031885, cost : 19.028 min
==========
Lambda: 0.06812920690579614
Hessian initialization fail, gradient diff = 0
lambda is : 0.06812920690579614, cost : 20.324 min
==========
Lambda: 0.46415888336127825
Hessian initialization fail, gradient diff = 0
lambda is : 0.46415888336127825, cost : 20.559 min
==========
Lambda: 0.21544346900318853
Hessian initialization fail, gradient diff = 0
lambda is : 0.21544346900318853, cost : 20.628 min
==========
Lambda: 0.046415888336127815
Hessian initialization fail, gradient diff = 0
lambda is : 0.046415888336127815, cost : 23.982 min
==========
Lambda: 0.146779926762207
Hessian initialization fail, gradient diff = 0
lambda is : 0.146779926762207, cost : 27.742 min
==========
Lambda: 0.10000000000000006
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000006, cost : 30.703 min
==========
Lambda: 0.031622776601683826
Hessian initialization fail, gradient diff = 0
lambda is : 0.031622776601683826, cost : 32.695 min
==========
Lambda: 0.010000000000000004
Hessian initialization fail, gradient diff = 0
lambda is : 0.010000000000000004, cost : 41.727 min
==========
Lambda: 0.0010000000000000002
OWL-QN did not convergence
lambda is : 0.0010000000000000002, cost : 65.723 min
==========
Lambda: 0.0014677992676220707
OWL-QN did not convergence
lambda is : 0.0014677992676220707, cost : 65.247 min
==========
Lambda: 0.00010000000000000009
OWL-QN did not convergence
lambda is : 0.00010000000000000009, cost : 65.571 min
==========
Lambda: 0.0002154434690031884
OWL-QN did not convergence
lambda is : 0.0002154434690031884, cost : 65.586 min
==========
Lambda: 0.014677992676220709
Hessian initialization fail, gradient diff = 0
lambda is : 0.014677992676220709, cost : 44.58 min
==========
Lambda: 0.0021544346900318864
OWL-QN did not convergence
lambda is : 0.0021544346900318864, cost : 65.919 min
==========
Lambda: 0.0006812920690579617
OWL-QN did not convergence
lambda is : 0.0006812920690579617, cost : 66.107 min
==========
Lambda: 0.0003162277660168384
OWL-QN did not convergence
lambda is : 0.0003162277660168384, cost : 66.205 min
==========
Lambda: 0.00014677992676220703
OWL-QN did not convergence
lambda is : 0.00014677992676220703, cost : 67.258 min
==========
Lambda: 0.003162277660168382
OWL-QN did not convergence
lambda is : 0.003162277660168382, cost : 68.675 min
==========
Lambda: 0.004641588833612781
OWL-QN did not convergence
lambda is : 0.004641588833612781, cost : 73.222 min
==========
Lambda: 0.0004641588833612784
OWL-QN did not convergence
lambda is : 0.0004641588833612784, cost : 69.406 min
==========
Lambda: 0.006812920690579619
OWL-QN did not convergence
lambda is : 0.006812920690579619, cost : 77.702 min
==========
/opt/conda/lib/python3.10/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
B_memory Time elapsed: 77.75209213892619 minutes.
Original adata: (32340, 20568)
adata celltype shape: (1264, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 16819)
====================
Starting job for CD16_Mono
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 0.46415888336127825
Hessian approximation fail, yTs = 0
lambda is : 0.46415888336127825, cost : 11.398 min
==========
Lambda: 0.31622776601683833
Hessian initialization fail, gradient diff = 0
lambda is : 0.31622776601683833, cost : 17.264 min
==========
Lambda: 1.0
Hessian initialization fail, gradient diff = 0
lambda is : 1.0, cost : 0.299 min
==========
Lambda: 0.146779926762207
Hessian initialization fail, gradient diff = 0
lambda is : 0.146779926762207, cost : 11.74 min
==========
Lambda: 0.06812920690579614
Hessian initialization fail, gradient diff = 0
lambda is : 0.06812920690579614, cost : 13.062 min
==========
Lambda: 0.6812920690579616
Hessian approximation fail, yTs = 0
lambda is : 0.6812920690579616, cost : 17.772 min
==========
Lambda: 0.10000000000000006
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000006, cost : 13.224 min
==========
Lambda: 0.046415888336127815
Hessian initialization fail, gradient diff = 0
lambda is : 0.046415888336127815, cost : 21.012 min
==========
Lambda: 0.031622776601683826
Hessian initialization fail, gradient diff = 0
lambda is : 0.031622776601683826, cost : 37.703 min
==========
Lambda: 0.21544346900318853
Hessian approximation fail, yTs = 0
lambda is : 0.21544346900318853, cost : 32.011 min
==========
Lambda: 0.00014677992676220703
OWL-QN did not convergence
lambda is : 0.00014677992676220703, cost : 65.811 min
==========
Lambda: 0.0002154434690031884
OWL-QN did not convergence
lambda is : 0.0002154434690031884, cost : 66.64 min
==========
Lambda: 0.0010000000000000002
OWL-QN did not convergence
lambda is : 0.0010000000000000002, cost : 66.621 min
==========
Lambda: 0.0006812920690579617
OWL-QN did not convergence
lambda is : 0.0006812920690579617, cost : 66.676 min
==========
Lambda: 0.0003162277660168384
OWL-QN did not convergence
lambda is : 0.0003162277660168384, cost : 66.975 min
==========
Lambda: 0.00010000000000000009
OWL-QN did not convergence
lambda is : 0.00010000000000000009, cost : 67.024 min
==========
Lambda: 0.010000000000000004
OWL-QN did not convergence
lambda is : 0.010000000000000004, cost : 66.867 min
==========
Lambda: 0.0014677992676220707
OWL-QN did not convergence
lambda is : 0.0014677992676220707, cost : 67.235 min
==========
Lambda: 0.02154434690031885
OWL-QN did not convergence
lambda is : 0.02154434690031885, cost : 67.423 min
==========
Lambda: 0.014677992676220709
Hessian approximation fail, yTs = 0
lambda is : 0.014677992676220709, cost : 67.676 min
==========
Lambda: 0.0021544346900318864
OWL-QN did not convergence
lambda is : 0.0021544346900318864, cost : 68.016 min
==========
Lambda: 0.003162277660168382
OWL-QN did not convergence
lambda is : 0.003162277660168382, cost : 70.239 min
==========
Lambda: 0.004641588833612781
OWL-QN did not convergence
lambda is : 0.004641588833612781, cost : 70.977 min
==========
Lambda: 0.006812920690579619
OWL-QN did not convergence
lambda is : 0.006812920690579619, cost : 71.889 min
==========
Lambda: 0.0004641588833612784
OWL-QN did not convergence
lambda is : 0.0004641588833612784, cost : 69.122 min
==========
/opt/conda/lib/python3.10/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
CD16_Mono Time elapsed: 71.94370594819387 minutes.
Original adata: (32340, 20568)
adata celltype shape: (347, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 13458)
====================
Starting job for CD4_CTL
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Lambda: 1.0
Hessian initialization fail, gradient diff = 0
lambda is : 1.0, cost : 0.28 min
==========
Lambda: 0.31622776601683833
Hessian approximation fail, yTs = 0
lambda is : 0.31622776601683833, cost : 11.83 min
==========
Lambda: 0.6812920690579616
Hessian approximation fail, yTs = 0
lambda is : 0.6812920690579616, cost : 12.254 min
==========
Lambda: 0.02154434690031885
Hessian approximation fail, yTs = 0
lambda is : 0.02154434690031885, cost : 12.882 min
==========
Lambda: 0.46415888336127825
Hessian initialization fail, gradient diff = 0
lambda is : 0.46415888336127825, cost : 13.191 min
==========
Lambda: 0.046415888336127815
Hessian initialization fail, gradient diff = 0
lambda is : 0.046415888336127815, cost : 14.083 min
==========
Lambda: 0.06812920690579614
Hessian initialization fail, gradient diff = 0
lambda is : 0.06812920690579614, cost : 15.663 min
==========
Lambda: 0.010000000000000004
Hessian initialization fail, gradient diff = 0
lambda is : 0.010000000000000004, cost : 16.961 min
==========
Lambda: 0.21544346900318853
Hessian approximation fail, yTs = 0
lambda is : 0.21544346900318853, cost : 18.383 min
==========
Lambda: 0.146779926762207
Hessian approximation fail, yTs = 0
lambda is : 0.146779926762207, cost : 21.412 min
==========
Lambda: 0.10000000000000006
Hessian approximation fail, yTs = 0
lambda is : 0.10000000000000006, cost : 24.287 min
==========
Lambda: 0.014677992676220709
Hessian initialization fail, gradient diff = 0
lambda is : 0.014677992676220709, cost : 26.631 min
==========
Lambda: 0.0014677992676220707
OWL-QN did not convergence
lambda is : 0.0014677992676220707, cost : 64.537 min
==========
Lambda: 0.003162277660168382
OWL-QN did not convergence
lambda is : 0.003162277660168382, cost : 64.528 min
==========
Lambda: 0.0021544346900318864
OWL-QN did not convergence
lambda is : 0.0021544346900318864, cost : 64.565 min
==========
Lambda: 0.00010000000000000009
OWL-QN did not convergence
lambda is : 0.00010000000000000009, cost : 65.113 min
==========
Lambda: 0.031622776601683826
Hessian approximation fail, yTs = 0
lambda is : 0.031622776601683826, cost : 42.942 min
==========
Lambda: 0.0004641588833612784
OWL-QN did not convergence
lambda is : 0.0004641588833612784, cost : 64.599 min
==========
Lambda: 0.0006812920690579617
OWL-QN did not convergence
lambda is : 0.0006812920690579617, cost : 64.696 min
==========
Lambda: 0.00014677992676220703
OWL-QN did not convergence
lambda is : 0.00014677992676220703, cost : 64.694 min
==========
Lambda: 0.0003162277660168384
OWL-QN did not convergence
lambda is : 0.0003162277660168384, cost : 64.942 min
==========
Lambda: 0.0010000000000000002
OWL-QN did not convergence
lambda is : 0.0010000000000000002, cost : 65.643 min
==========
Lambda: 0.0002154434690031884
OWL-QN did not convergence
lambda is : 0.0002154434690031884, cost : 66.421 min
==========
Lambda: 0.004641588833612781
OWL-QN did not convergence
lambda is : 0.004641588833612781, cost : 81.66 min
==========
Lambda: 0.006812920690579619
Hessian initialization fail, gradient diff = 0
lambda is : 0.006812920690579619, cost : 85.443 min
==========
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:998: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, ax1 = plt.subplots(figsize = (fig_width,fig_height))
/opt/conda/lib/python3.10/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
CD4_CTL Time elapsed: 85.49912443558375 minutes.
Original adata: (32340, 20568)
adata celltype shape: (2977, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 17368)
====================
Starting job for CD4_TCM
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 1.0
Hessian initialization fail, gradient diff = 0
lambda is : 1.0, cost : 0.298 min
==========
Lambda: 0.146779926762207
Hessian initialization fail, gradient diff = 0
lambda is : 0.146779926762207, cost : 11.892 min
==========
Lambda: 0.46415888336127825
Hessian initialization fail, gradient diff = 0
lambda is : 0.46415888336127825, cost : 16.625 min
==========
Lambda: 0.21544346900318853
Hessian approximation fail, yTs = 0
lambda is : 0.21544346900318853, cost : 18.219 min
==========
Lambda: 0.31622776601683833
Hessian initialization fail, gradient diff = 0
lambda is : 0.31622776601683833, cost : 20.295 min
==========
Lambda: 0.06812920690579614
Hessian initialization fail, gradient diff = 0
lambda is : 0.06812920690579614, cost : 20.42 min
==========
Lambda: 0.10000000000000006
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000006, cost : 23.03 min
==========
Lambda: 0.6812920690579616
Hessian approximation fail, yTs = 0
lambda is : 0.6812920690579616, cost : 28.789 min
==========
Lambda: 0.00010000000000000009
OWL-QN did not convergence
lambda is : 0.00010000000000000009, cost : 66.56 min
==========
Lambda: 0.046415888336127815
Hessian initialization fail, gradient diff = 0
lambda is : 0.046415888336127815, cost : 52.893 min
==========
Lambda: 0.00014677992676220703
OWL-QN did not convergence
lambda is : 0.00014677992676220703, cost : 66.606 min
==========
Lambda: 0.0002154434690031884
OWL-QN did not convergence
lambda is : 0.0002154434690031884, cost : 66.748 min
==========
Lambda: 0.02154434690031885
Hessian initialization fail, gradient diff = 0
lambda is : 0.02154434690031885, cost : 66.978 min
==========
Lambda: 0.0010000000000000002
OWL-QN did not convergence
lambda is : 0.0010000000000000002, cost : 66.983 min
==========
Lambda: 0.0003162277660168384
OWL-QN did not convergence
lambda is : 0.0003162277660168384, cost : 67.277 min
==========
Lambda: 0.0004641588833612784
OWL-QN did not convergence
lambda is : 0.0004641588833612784, cost : 67.38 min
==========
Lambda: 0.0014677992676220707
OWL-QN did not convergence
lambda is : 0.0014677992676220707, cost : 67.569 min
==========
Lambda: 0.004641588833612781
OWL-QN did not convergence
lambda is : 0.004641588833612781, cost : 72.078 min
==========
Lambda: 0.010000000000000004
OWL-QN did not convergence
lambda is : 0.010000000000000004, cost : 71.359 min
==========
Lambda: 0.006812920690579619
OWL-QN did not convergence
lambda is : 0.006812920690579619, cost : 72.292 min
==========
Lambda: 0.014677992676220709
OWL-QN did not convergence
lambda is : 0.014677992676220709, cost : 73.807 min
==========
Lambda: 0.0021544346900318864
OWL-QN did not convergence
lambda is : 0.0021544346900318864, cost : 74.971 min
==========
Lambda: 0.003162277660168382
OWL-QN did not convergence
lambda is : 0.003162277660168382, cost : 75.622 min
==========
Lambda: 0.031622776601683826
Hessian initialization fail, gradient diff = 0
lambda is : 0.031622776601683826, cost : 80.559 min
==========
Lambda: 0.0006812920690579617
OWL-QN did not convergence
lambda is : 0.0006812920690579617, cost : 75.639 min
==========
/opt/conda/lib/python3.10/site-packages/anndata/__init__.py:51: FutureWarning: `anndata.read` is deprecated, use `anndata.read_h5ad` instead. `ad.read` will be removed in mid 2024.
  warnings.warn(
*** Start parallel lambda tuning ***
*** Collecting results ***
CD4_TCM Time elapsed: 80.61873633464178 minutes.
Original adata: (32340, 20568)
adata celltype shape: (3434, 20568)
adata shape after removing all zero columns for celltype cells: (32340, 17393)
====================
Starting job for NK
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_loss.py:161: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Lambda: 0.10000000000000006
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000006, cost : 20.69 min
==========
Lambda: 0.6812920690579616
Hessian approximation fail, yTs = 0
lambda is : 0.6812920690579616, cost : 21.98 min
==========
Lambda: 1.0
Hessian initialization fail, gradient diff = 0
lambda is : 1.0, cost : 0.281 min
==========
Lambda: 0.21544346900318853
Hessian initialization fail, gradient diff = 0
lambda is : 0.21544346900318853, cost : 24.217 min
==========
Lambda: 0.031622776601683826
OWL-QN did not convergence
lambda is : 0.031622776601683826, cost : 69.225 min
==========
Lambda: 0.146779926762207
Hessian approximation fail, yTs = 0
lambda is : 0.146779926762207, cost : 34.619 min
==========
Lambda: 0.31622776601683833
Hessian initialization fail, gradient diff = 0
lambda is : 0.31622776601683833, cost : 43.741 min
==========
Lambda: 0.06812920690579614
Hessian approximation fail, yTs = 0
lambda is : 0.06812920690579614, cost : 49.94 min
==========
Lambda: 0.46415888336127825
Hessian approximation fail, yTs = 0
lambda is : 0.46415888336127825, cost : 41.024 min
==========
Lambda: 0.0006812920690579617
OWL-QN did not convergence
lambda is : 0.0006812920690579617, cost : 67.915 min
==========
Lambda: 0.0014677992676220707
OWL-QN did not convergence
lambda is : 0.0014677992676220707, cost : 68.466 min
==========
Lambda: 0.00010000000000000009
OWL-QN did not convergence
lambda is : 0.00010000000000000009, cost : 68.518 min
==========
Lambda: 0.0003162277660168384
OWL-QN did not convergence
lambda is : 0.0003162277660168384, cost : 68.582 min
==========
Lambda: 0.0010000000000000002
OWL-QN did not convergence
lambda is : 0.0010000000000000002, cost : 68.786 min
==========
Lambda: 0.0002154434690031884
OWL-QN did not convergence
lambda is : 0.0002154434690031884, cost : 68.824 min
==========
Lambda: 0.00014677992676220703
OWL-QN did not convergence
lambda is : 0.00014677992676220703, cost : 68.803 min
==========
Lambda: 0.003162277660168382
OWL-QN did not convergence
lambda is : 0.003162277660168382, cost : 68.857 min
==========
Lambda: 0.006812920690579619
OWL-QN did not convergence
lambda is : 0.006812920690579619, cost : 69.091 min
==========
Lambda: 0.014677992676220709
OWL-QN did not convergence
lambda is : 0.014677992676220709, cost : 69.856 min
==========
Lambda: 0.004641588833612781
OWL-QN did not convergence
lambda is : 0.004641588833612781, cost : 72.372 min
==========
Lambda: 0.0021544346900318864
OWL-QN did not convergence
lambda is : 0.0021544346900318864, cost : 72.505 min
==========
Lambda: 0.010000000000000004
OWL-QN did not convergence
lambda is : 0.010000000000000004, cost : 73.425 min
==========
Lambda: 0.02154434690031885
OWL-QN did not convergence
lambda is : 0.02154434690031885, cost : 75.232 min
==========
Lambda: 0.046415888336127815
OWL-QN did not convergence
lambda is : 0.046415888336127815, cost : 77.862 min
==========
Lambda: 0.0004641588833612784
OWL-QN did not convergence
lambda is : 0.0004641588833612784, cost : 77.455 min
==========
*** Start parallel lambda tuning ***
*** Collecting results ***
NK Time elapsed: 77.9120281457901 minutes.
***** Finished lambda tuning
====================

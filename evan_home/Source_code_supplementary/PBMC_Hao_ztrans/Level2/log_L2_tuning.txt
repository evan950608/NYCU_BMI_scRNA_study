nohup: ignoring input
Z-transformed rep_cells adata: (57515, 27504) <class 'numpy.ndarray'>
all cell types: ['ASDC', 'B_intermediate', 'B_memory', 'B_naive', 'CD14_Mono', 'CD16_Mono', 'CD4_CTL', 'CD4_Naive', 'CD4_Proliferating', 'CD4_TCM', 'CD4_TEM', 'CD8_Naive', 'CD8_Proliferating', 'CD8_TCM', 'CD8_TEM', 'Doublet', 'Eryth', 'HSPC', 'ILC', 'MAIT', 'NK', 'NK_CD56bright', 'NK_Proliferating', 'Plasmablast', 'Platelet', 'Treg', 'cDC1', 'cDC2', 'dnT', 'gdT', 'pDC']
====================
Queue ['ASDC', 'B_intermediate', 'B_memory', 'B_naive', 'CD14_Mono', 'CD16_Mono', 'CD4_CTL', 'CD4_Naive', 'CD4_Proliferating', 'CD4_TCM', 'CD4_TEM', 'CD8_Naive', 'CD8_Proliferating', 'CD8_TCM', 'CD8_TEM', 'Doublet', 'Eryth', 'HSPC', 'ILC', 'MAIT', 'NK', 'NK_CD56bright', 'NK_Proliferating', 'Plasmablast', 'Platelet', 'Treg', 'cDC1', 'cDC2', 'dnT', 'gdT', 'pDC']
====================
Subsetted raw count adata: (57515, 27504) <class 'anndata._core.views.SparseCSCView'>
***** Starting tuning
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for ASDC
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 15:35:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 880, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.724 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 15:36:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 967, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.719 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 15:37:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 471, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.516 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 15:37:37 Max_iter: 1000
At iteration 465, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.487 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 15:38:06 Max_iter: 1000
At iteration 434, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.45 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 15:38:33 Max_iter: 1000
At iteration 468, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.456 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 15:39:01 Max_iter: 1000
At iteration 469, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.441 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 15:39:27 Max_iter: 1000
At iteration 449, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.409 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 15:39:51 Max_iter: 1000
At iteration 430, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.383 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 15:40:14 Max_iter: 1000
At iteration 411, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.358 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 15:40:36 Max_iter: 1000
At iteration 386, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.323 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 15:40:55 Max_iter: 1000
At iteration 370, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.299 min
==========
Testing lambda: 0.001 starting at 2024-09-16 15:41:13 Max_iter: 1000
At iteration 347, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.272 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 15:41:30 Max_iter: 1000
At iteration 335, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.25 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 15:41:45 Max_iter: 1000
At iteration 327, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.229 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 15:41:58 Max_iter: 1000
At iteration 312, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.211 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 15:42:11 Max_iter: 1000
At iteration 316, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.209 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 15:42:24 Max_iter: 1000
At iteration 324, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.208 min
==========
Testing lambda: 0.01 starting at 2024-09-16 15:42:36 Max_iter: 1000
At iteration 324, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.208 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 15:42:49 Max_iter: 1000
At iteration 305, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.014677992676220709, cost : 0.202 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 15:43:01 Max_iter: 1000
At iteration 296, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.192 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 15:43:12 Max_iter: 1000
At iteration 284, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.185 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 15:43:23 Max_iter: 1000
At iteration 248, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.166 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 15:43:33 Max_iter: 1000
At iteration 192, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.132 min
==========
Testing lambda: 0.1 starting at 2024-09-16 15:43:41 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.256690    0.368421          0.380952            7060  0.998989  ...  0.554000   0.333333  0.489796      0.126101       0.003648
0.000015    0.239347    0.394737          0.396825            6583  0.999531  ...  0.639997   0.444444  0.600000      0.111191       0.005502
0.000022    0.386489    0.236842          0.238095           10630  0.994289  ...  0.347473   0.131868  0.230769      0.462281       0.000027
0.000032    0.360566    0.263158          0.269841            9917  0.994082  ...  0.361791   0.142857  0.247423      0.472770       0.002719
0.000046    0.332897    0.289474          0.285714            9156  0.999578  ...  0.587725   0.375000  0.533333      0.483572       0.001714

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
ASDC Time elapsed: 8.174466959635417 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for B_intermediate
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 15:44:14 Max_iter: 1000
At iteration 465, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.533 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 15:44:46 Max_iter: 1000
At iteration 495, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.546 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 15:45:19 Max_iter: 1000
At iteration 478, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.497 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 15:45:49 Max_iter: 1000
At iteration 465, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.496 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 15:46:19 Max_iter: 1000
At iteration 471, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.46 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 15:46:46 Max_iter: 1000
At iteration 466, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.446 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 15:47:13 Max_iter: 1000
At iteration 438, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.414 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 15:47:38 Max_iter: 1000
At iteration 419, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.383 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 15:48:01 Max_iter: 1000
At iteration 411, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.366 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 15:48:23 Max_iter: 1000
At iteration 395, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.34 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 15:48:43 Max_iter: 1000
At iteration 380, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.308 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 15:49:02 Max_iter: 1000
At iteration 360, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.283 min
==========
Testing lambda: 0.001 starting at 2024-09-16 15:49:19 Max_iter: 1000
At iteration 342, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.265 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 15:49:35 Max_iter: 1000
At iteration 339, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.264 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 15:49:50 Max_iter: 1000
At iteration 334, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.244 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 15:50:05 Max_iter: 1000
At iteration 327, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.226 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 15:50:19 Max_iter: 1000
At iteration 330, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.214 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 15:50:31 Max_iter: 1000
At iteration 321, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.209 min
==========
Testing lambda: 0.01 starting at 2024-09-16 15:50:44 Max_iter: 1000
At iteration 323, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.21 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 15:50:57 Max_iter: 1000
At iteration 303, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.198 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 15:51:08 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.216 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 15:51:21 Max_iter: 1000
At iteration 297, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.191 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 15:51:33 Max_iter: 1000
At iteration 229, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.151 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 15:51:42 Max_iter: 1000
At iteration 93, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.0681292069057962, cost : 0.072 min
==========
Testing lambda: 0.1 starting at 2024-09-16 15:51:46 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.409722    0.118508          0.119091           11269  0.958600  ...  0.675221   0.565217  0.671733      0.439678       0.000295
0.000015    0.382126    0.131675          0.131818           10510  0.964066  ...  0.678407   0.567775  0.674772      0.450918       0.000754
0.000022    0.352930    0.144111          0.144545            9707  0.965301  ...  0.703167   0.621777  0.704545      0.462560       0.000755
0.000032    0.321371    0.158742          0.160000            8839  0.969839  ...  0.712838   0.638235  0.714992      0.474557       0.000277
0.000046    0.288031    0.176298          0.176364            7922  0.973359  ...  0.746422   0.690852  0.750000      0.486818       0.000658

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
B_intermediate Time elapsed: 7.678316028912862 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for B_memory
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 15:52:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 443, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.544 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 15:52:52 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 452, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.504 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 15:53:22 Max_iter: 1000
At iteration 473, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.489 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 15:53:52 Max_iter: 1000
At iteration 489, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.469 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 15:54:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 545, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.508 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 15:54:50 Max_iter: 1000
At iteration 457, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.422 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 15:55:16 Max_iter: 1000
At iteration 451, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.398 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 15:55:40 Max_iter: 1000
At iteration 426, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.37 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 15:56:02 Max_iter: 1000
At iteration 422, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.361 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 15:56:24 Max_iter: 1000
At iteration 409, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.33 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 15:56:43 Max_iter: 1000
At iteration 394, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.312 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 15:57:02 Max_iter: 1000
At iteration 372, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.281 min
==========
Testing lambda: 0.001 starting at 2024-09-16 15:57:19 Max_iter: 1000
At iteration 357, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.266 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 15:57:35 Max_iter: 1000
At iteration 350, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.247 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 15:57:50 Max_iter: 1000
At iteration 344, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.25 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 15:58:05 Max_iter: 1000
At iteration 334, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.225 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 15:58:18 Max_iter: 1000
At iteration 336, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 0.225 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 15:58:32 Max_iter: 1000
At iteration 343, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.006812920690579613, cost : 0.222 min
==========
Testing lambda: 0.01 starting at 2024-09-16 15:58:45 Max_iter: 1000
At iteration 330, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.213 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 15:58:58 Max_iter: 1000
At iteration 323, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.21 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 15:59:10 Max_iter: 1000
At iteration 368, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.234 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 15:59:24 Max_iter: 1000
At iteration 250, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.166 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 15:59:34 Max_iter: 1000
At iteration 213, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.143 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 15:59:43 Max_iter: 1000
At iteration 131, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.0681292069057962, cost : 0.094 min
==========
Testing lambda: 0.1 starting at 2024-09-16 15:59:49 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.406232    0.112079          0.111908           11173  0.994580  ...  0.818543   0.725768  0.817577      0.414723       0.000013
0.000015    0.372419    0.126016          0.126255           10243  0.994698  ...  0.845155   0.766749  0.845417      0.426342       0.000046
0.000022    0.344895    0.137631          0.137733            9486  0.995277  ...  0.856806   0.789744  0.857939      0.438553       0.004215
0.000032    0.312573    0.152149          0.151363            8597  0.995734  ...  0.855609   0.792746  0.857143      0.451063       0.006375
0.000046    0.282213    0.168409          0.168580            7762  0.996597  ...  0.876172   0.821809  0.877841      0.463983       0.000078

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:945: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, ax1 = plt.subplots(figsize = (fig_width,fig_height))
B_memory Time elapsed: 7.6296159783999125 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for B_naive
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 16:00:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 558, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 1.334 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 16:01:42 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 486, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 1.281 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 16:02:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 569, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 1.426 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 16:04:24 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 517, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 1.363 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 16:05:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 403, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 1.066 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 16:06:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 479, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 1.29 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 16:08:08 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 929, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 2.223 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 16:10:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 469, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 1.337 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 16:11:41 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 348, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.974 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 16:12:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 400, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 1.163 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 16:13:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 979, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 2.093 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 16:15:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 729, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 1.795 min
==========
Testing lambda: 0.001 starting at 2024-09-16 16:17:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 738, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 1.813 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 16:19:32 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 410, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 1.138 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 16:20:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 609, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 1.674 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 16:22:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 388, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.894 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 16:23:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 325, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 0.572 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 16:23:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 330, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.49 min
==========
Testing lambda: 0.01 starting at 2024-09-16 16:24:18 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 356, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.421 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 16:24:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 317, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.268 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 16:24:59 Max_iter: 1000
At iteration 332, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.211 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 16:25:12 Max_iter: 1000
At iteration 378, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.237 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 16:25:26 Max_iter: 1000
At iteration 239, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.157 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 16:25:35 Max_iter: 1000
At iteration 219, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.145 min
==========
Testing lambda: 0.1 starting at 2024-09-16 16:25:44 Max_iter: 1000
At iteration 203, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.136 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.359002    0.114259          0.113077            9874  0.995926  ...  0.892143   0.820163  0.894502      0.256362       0.000120
0.000015    0.343041    0.119863          0.118846            9435  0.996215  ...  0.907460   0.846695  0.910053      0.272247       0.000146
0.000022    0.310318    0.134807          0.133846            8535  0.995459  ...  0.916925   0.864748  0.919663      0.282015       0.000144
0.000032    0.281195    0.149751          0.149231            7734  0.995737  ...  0.922921   0.878299  0.925811      0.294127       0.000113
0.000046    0.240256    0.173101          0.172308            6608  0.996141  ...  0.935843   0.904545  0.938679      0.306880       0.000144

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
B_naive Time elapsed: 25.63181771437327 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD14_Mono
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 16:26:24 Max_iter: 1000
At iteration 762, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.573 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 16:26:58 Max_iter: 1000
At iteration 668, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.513 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 16:27:29 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 630, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.534 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 16:28:01 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 667, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.53 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 16:28:33 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 642, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.528 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 16:29:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 592, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.546 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 16:29:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 493, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.571 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 16:30:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 535, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.616 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 16:30:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 350, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.478 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 16:31:17 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 291, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.351 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 16:31:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 364, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.483 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 16:32:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 433, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.494 min
==========
Testing lambda: 0.001 starting at 2024-09-16 16:32:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 297, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.352 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 16:32:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 386, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.393 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 16:33:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 316, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.253 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 16:33:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 305, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.237 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 16:33:51 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 385, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.265 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 16:34:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 269, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.199 min
==========
Testing lambda: 0.01 starting at 2024-09-16 16:34:19 Max_iter: 1000
At iteration 417, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.265 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 16:34:35 Max_iter: 1000
At iteration 445, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.278 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 16:34:51 Max_iter: 1000
At iteration 430, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.27 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 16:35:08 Max_iter: 1000
At iteration 446, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.28 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 16:35:25 Max_iter: 1000
At iteration 326, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.21 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 16:35:37 Max_iter: 1000
At iteration 519, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.321 min
==========
Testing lambda: 0.1 starting at 2024-09-16 16:35:56 Max_iter: 1000
At iteration 532, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.328 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.164376    0.408409          0.408546            4521  0.993761  ...  0.938437   0.935392  0.947582      0.010982       0.000913
0.000015    0.159177    0.404486          0.404375            4378  0.994052  ...  0.940359   0.934091  0.949192      0.014715       0.010034
0.000022    0.154559    0.413446          0.414545            4251  0.994160  ...  0.941845   0.938250  0.950478      0.019355       0.001638
0.000032    0.135471    0.431424          0.431665            3726  0.994167  ...  0.938321   0.936890  0.947491      0.024608       0.002319
0.000046    0.118128    0.456196          0.456248            3249  0.993422  ...  0.933825   0.933908  0.943670      0.030957       0.003128

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
CD14_Mono Time elapsed: 10.000486838817597 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD16_Mono
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 16:36:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 488, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 1.06 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 16:37:51 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 385, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.903 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 16:38:45 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 503, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 1.065 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 16:39:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 478, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 1.032 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 16:40:51 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 420, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.996 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 16:41:51 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 317, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.748 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 16:42:36 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 323, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.766 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 16:43:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 288, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.62 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 16:43:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 276, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.587 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 16:44:34 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 244, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.418 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 16:44:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 222, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.352 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 16:45:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 216, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.282 min
==========
Testing lambda: 0.001 starting at 2024-09-16 16:45:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 263, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.41 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 16:46:02 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 281, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.396 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 16:46:26 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 265, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.269 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 16:46:42 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 278, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.224 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 16:46:55 Max_iter: 1000
At iteration 320, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 0.221 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 16:47:09 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.006812920690579613, cost : 0.22 min
==========
Testing lambda: 0.01 starting at 2024-09-16 16:47:22 Max_iter: 1000
At iteration 347, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.224 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 16:47:35 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.218 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 16:47:48 Max_iter: 1000
At iteration 328, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.21 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 16:48:01 Max_iter: 1000
At iteration 283, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.183 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 16:48:12 Max_iter: 1000
At iteration 266, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.174 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 16:48:22 Max_iter: 1000
At iteration 217, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.144 min
==========
Testing lambda: 0.1 starting at 2024-09-16 16:48:31 Max_iter: 1000
At iteration 191, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.131 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.420484    0.175986          0.175360           11565  0.992491  ...  0.822029   0.730245  0.824615      0.364873       0.000079
0.000015    0.397288    0.194265          0.194245           10927  0.992598  ...  0.833490   0.747911  0.836449      0.373825       0.000051
0.000022    0.370637    0.217204          0.216277           10194  0.992271  ...  0.838596   0.760684  0.842271      0.382526       0.000063
0.000032    0.343332    0.240502          0.240108            9443  0.994126  ...  0.857115   0.789396  0.861044      0.391694       0.000071
0.000046    0.312136    0.263441          0.262140            8585  0.993779  ...  0.861538   0.795556  0.865431      0.401350       0.000060

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
CD16_Mono Time elapsed: 11.985906744003296 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_CTL
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 16:49:09 Max_iter: 1000
At iteration 495, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.526 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 16:49:41 Max_iter: 1000
At iteration 448, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.459 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 16:50:09 Max_iter: 1000
At iteration 481, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.462 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 16:50:36 Max_iter: 1000
At iteration 474, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.439 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 16:51:03 Max_iter: 1000
At iteration 460, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.425 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 16:51:28 Max_iter: 1000
At iteration 442, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.406 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 16:51:52 Max_iter: 1000
At iteration 433, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.377 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 16:52:15 Max_iter: 1000
At iteration 403, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.347 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 16:52:36 Max_iter: 1000
At iteration 389, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.326 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 16:52:55 Max_iter: 1000
At iteration 372, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.297 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 16:53:13 Max_iter: 1000
At iteration 363, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.285 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 16:53:30 Max_iter: 1000
At iteration 353, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.258 min
==========
Testing lambda: 0.001 starting at 2024-09-16 16:53:46 Max_iter: 1000
At iteration 352, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.246 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 16:54:01 Max_iter: 1000
At iteration 344, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.25 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 16:54:16 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.246 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 16:54:30 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.226 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 16:54:44 Max_iter: 1000
At iteration 338, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.22 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 16:54:57 Max_iter: 1000
At iteration 330, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.211 min
==========
Testing lambda: 0.01 starting at 2024-09-16 16:55:10 Max_iter: 1000
At iteration 361, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.23 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 16:55:24 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.217 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 16:55:37 Max_iter: 1000
At iteration 384, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.241 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 16:55:51 Max_iter: 1000
At iteration 285, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.184 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 16:56:02 Max_iter: 1000
At iteration 211, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.141 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 16:56:11 Max_iter: 1000
At iteration 175, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.121 min
==========
Testing lambda: 0.1 starting at 2024-09-16 16:56:18 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.371873    0.093333          0.093220           10228  0.982010  ...  0.584462   0.500000  0.585185      0.456328       0.000127
0.000015    0.345223    0.102857          0.102906            9495  0.985489  ...  0.625424   0.548495  0.627151      0.467533       0.001084
0.000022    0.314282    0.113810          0.115012            8644  0.988334  ...  0.676803   0.615942  0.680000      0.478922       0.001201
0.000032    0.285631    0.125714          0.125908            7856  0.990380  ...  0.700974   0.655172  0.705155      0.491017       0.000821
0.000046    0.253200    0.140000          0.139225            6964  0.993178  ...  0.740550   0.716049  0.745182      0.503419       0.000643

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
CD4_CTL Time elapsed: 7.287552503744761 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_Naive
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 16:56:51 Max_iter: 1000
At iteration 533, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.52 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 16:57:22 Max_iter: 1000
At iteration 511, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.496 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 16:57:52 Max_iter: 1000
At iteration 517, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.481 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 16:58:21 Max_iter: 1000
At iteration 532, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.478 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 16:58:50 Max_iter: 1000
At iteration 504, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.441 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 16:59:16 Max_iter: 1000
At iteration 478, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.415 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 16:59:41 Max_iter: 1000
At iteration 468, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.4 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 17:00:05 Max_iter: 1000
At iteration 443, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.362 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 17:00:27 Max_iter: 1000
At iteration 423, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.34 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 17:00:47 Max_iter: 1000
At iteration 398, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.318 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 17:01:06 Max_iter: 1000
At iteration 380, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.299 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 17:01:24 Max_iter: 1000
At iteration 373, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.311 min
==========
Testing lambda: 0.001 starting at 2024-09-16 17:01:43 Max_iter: 1000
At iteration 366, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.286 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 17:02:00 Max_iter: 1000
At iteration 360, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.268 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 17:02:16 Max_iter: 1000
At iteration 354, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.25 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 17:02:31 Max_iter: 1000
At iteration 343, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.23 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 17:02:45 Max_iter: 1000
At iteration 349, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.229 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 17:02:59 Max_iter: 1000
At iteration 360, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.23 min
==========
Testing lambda: 0.01 starting at 2024-09-16 17:03:13 Max_iter: 1000
At iteration 327, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.209 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 17:03:25 Max_iter: 1000
At iteration 316, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.203 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 17:03:37 Max_iter: 1000
At iteration 325, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.207 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 17:03:50 Max_iter: 1000
At iteration 304, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.196 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 17:04:01 Max_iter: 1000
At iteration 283, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.182 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 17:04:12 Max_iter: 1000
At iteration 255, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.166 min
==========
Testing lambda: 0.1 starting at 2024-09-16 17:04:22 Max_iter: 1000
At iteration 166, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.116 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.357730    0.088865          0.088741            9839  0.992159  ...  0.842401   0.778768  0.854582      0.297266       0.001261
0.000015    0.332061    0.097276          0.097225            9133  0.992487  ...  0.845589   0.789833  0.858203      0.312247       0.000743
0.000022    0.298720    0.109892          0.109837            8216  0.992741  ...  0.862581   0.817753  0.874423      0.327282       0.000519
0.000032    0.265452    0.122143          0.121990            7301  0.992872  ...  0.865284   0.816836  0.876621      0.342839       0.000855
0.000046    0.232003    0.138051          0.138042            6381  0.993089  ...  0.880315   0.848287  0.891174      0.358771       0.000999

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
CD4_Naive Time elapsed: 7.759628653526306 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_Proliferating
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 17:05:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 513, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.59 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 17:05:35 Max_iter: 1000
At iteration 479, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.545 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 17:06:08 Max_iter: 1000
At iteration 489, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.55 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 17:06:41 Max_iter: 1000
At iteration 435, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.494 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 17:07:11 Max_iter: 1000
At iteration 497, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.508 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 17:07:41 Max_iter: 1000
At iteration 486, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.481 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 17:08:10 Max_iter: 1000
At iteration 466, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.455 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 17:08:37 Max_iter: 1000
At iteration 444, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.438 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 17:09:04 Max_iter: 1000
At iteration 420, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.401 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 17:09:28 Max_iter: 1000
At iteration 414, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.38 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 17:09:50 Max_iter: 1000
At iteration 388, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.341 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 17:10:11 Max_iter: 1000
At iteration 374, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.313 min
==========
Testing lambda: 0.001 starting at 2024-09-16 17:10:30 Max_iter: 1000
At iteration 348, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.286 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 17:10:47 Max_iter: 1000
At iteration 332, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.257 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 17:11:02 Max_iter: 1000
At iteration 333, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.24 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 17:11:17 Max_iter: 1000
At iteration 327, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.223 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 17:11:30 Max_iter: 1000
At iteration 323, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.216 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 17:11:43 Max_iter: 1000
At iteration 325, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.209 min
==========
Testing lambda: 0.01 starting at 2024-09-16 17:11:56 Max_iter: 1000
At iteration 335, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.010000000000000004, cost : 0.216 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 17:12:09 Max_iter: 1000
At iteration 315, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.203 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 17:12:21 Max_iter: 1000
At iteration 307, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.196 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 17:12:33 Max_iter: 1000
At iteration 311, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.199 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 17:12:45 Max_iter: 1000
At iteration 204, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.136 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 17:12:53 Max_iter: 1000
At iteration 195, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.0681292069057962, cost : 0.131 min
==========
Testing lambda: 0.1 starting at 2024-09-16 17:13:01 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.459933    0.269231          0.259740           12650  0.891945  ...  0.252761   0.118110  0.194805      0.437071       0.000101
0.000015    0.437173    0.288462          0.285714           12024  0.889279  ...  0.239491   0.113821  0.186667      0.448025       0.000304
0.000022    0.413358    0.317308          0.311688           11369  0.882746  ...  0.224877   0.108333  0.176871      0.458631       0.000191
0.000032    0.386453    0.346154          0.337662           10629  0.909870  ...  0.288704   0.153061  0.240000      0.469674       0.000264
0.000046    0.355548    0.375000          0.363636            9779  0.889292  ...  0.258539   0.132075  0.210526      0.480721       0.000678

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
CD4_Proliferating Time elapsed: 8.157088764508565 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_TCM
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 17:13:34 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 417, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.525 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 17:14:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 435, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.498 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 17:14:35 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 474, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.523 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 17:15:07 Max_iter: 1000
At iteration 517, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.507 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 17:15:37 Max_iter: 1000
At iteration 491, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.476 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 17:16:05 Max_iter: 1000
At iteration 466, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.436 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 17:16:32 Max_iter: 1000
At iteration 453, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.412 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 17:16:56 Max_iter: 1000
At iteration 428, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.383 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 17:17:19 Max_iter: 1000
At iteration 397, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.362 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 17:17:41 Max_iter: 1000
At iteration 383, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.358 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 17:18:03 Max_iter: 1000
At iteration 363, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00046415888336127795, cost : 0.355 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 17:18:24 Max_iter: 1000
At iteration 359, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.324 min
==========
Testing lambda: 0.001 starting at 2024-09-16 17:18:43 Max_iter: 1000
At iteration 347, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.295 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 17:19:01 Max_iter: 1000
At iteration 337, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.259 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 17:19:17 Max_iter: 1000
At iteration 324, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.232 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 17:19:31 Max_iter: 1000
At iteration 317, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.218 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 17:19:44 Max_iter: 1000
At iteration 312, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.203 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 17:19:56 Max_iter: 1000
At iteration 311, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.202 min
==========
Testing lambda: 0.01 starting at 2024-09-16 17:20:08 Max_iter: 1000
At iteration 307, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.198 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 17:20:20 Max_iter: 1000
At iteration 321, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.205 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 17:20:32 Max_iter: 1000
At iteration 294, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.19 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 17:20:44 Max_iter: 1000
At iteration 300, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.193 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 17:20:55 Max_iter: 1000
At iteration 251, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.164 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 17:21:05 Max_iter: 1000
At iteration 133, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.096 min
==========
Testing lambda: 0.1 starting at 2024-09-16 17:21:11 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.385035    0.101310          0.101301           10590  0.969142  ...  0.705038   0.649755  0.727106      0.382937       0.000028
0.000015    0.355694    0.112298          0.112556            9783  0.968084  ...  0.701107   0.661803  0.724965      0.395514       0.000053
0.000022    0.328607    0.123589          0.123562            9038  0.968749  ...  0.714204   0.678010  0.737192      0.408785       0.000029
0.000032    0.297557    0.136694          0.136568            8184  0.967946  ...  0.715382   0.696051  0.739152      0.422991       0.000808
0.000046    0.264507    0.152621          0.153077            7275  0.967966  ...  0.711190   0.689091  0.735209      0.437426       0.000690

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
CD4_TCM Time elapsed: 7.75988879998525 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_TEM
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 17:21:43 Max_iter: 1000
At iteration 525, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.541 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 17:22:16 Max_iter: 1000
At iteration 522, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.499 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 17:22:45 Max_iter: 1000
At iteration 490, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.483 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 17:23:14 Max_iter: 1000
At iteration 484, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.472 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 17:23:43 Max_iter: 1000
At iteration 460, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.424 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 17:24:08 Max_iter: 1000
At iteration 453, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.417 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 17:24:33 Max_iter: 1000
At iteration 444, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.392 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 17:24:57 Max_iter: 1000
At iteration 433, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.383 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 17:25:20 Max_iter: 1000
At iteration 416, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.344 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 17:25:40 Max_iter: 1000
At iteration 403, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.341 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 17:26:01 Max_iter: 1000
At iteration 386, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.358 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 17:26:22 Max_iter: 1000
At iteration 385, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.33 min
==========
Testing lambda: 0.001 starting at 2024-09-16 17:26:42 Max_iter: 1000
At iteration 373, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.298 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 17:27:00 Max_iter: 1000
At iteration 359, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.261 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 17:27:16 Max_iter: 1000
At iteration 345, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.243 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 17:27:30 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.217 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 17:27:43 Max_iter: 1000
At iteration 338, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.218 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 17:27:56 Max_iter: 1000
At iteration 319, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.205 min
==========
Testing lambda: 0.01 starting at 2024-09-16 17:28:09 Max_iter: 1000
At iteration 349, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.223 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 17:28:22 Max_iter: 1000
At iteration 351, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.222 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 17:28:35 Max_iter: 1000
At iteration 299, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.191 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 17:28:47 Max_iter: 1000
At iteration 268, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.174 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 17:28:57 Max_iter: 1000
At iteration 232, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.154 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 17:29:06 Max_iter: 1000
At iteration 71, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.06 min
==========
Testing lambda: 0.1 starting at 2024-09-16 17:29:10 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.377727    0.094241          0.093657           10389  0.929879  ...  0.475820   0.427046  0.491803      0.460186       0.001120
0.000015    0.351149    0.102808          0.102549            9658  0.929048  ...  0.490418   0.448790  0.506835      0.471863       0.000729
0.000022    0.323662    0.113041          0.112626            8902  0.937604  ...  0.496925   0.455910  0.513200      0.484046       0.000766
0.000032    0.291848    0.127082          0.126260            8027  0.941710  ...  0.525797   0.491159  0.541712      0.496633       0.000910
0.000046    0.259308    0.141361          0.141079            7132  0.940989  ...  0.529222   0.495069  0.545060      0.509573       0.000818

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
CD4_TEM Time elapsed: 7.6011620958646136 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD8_Naive
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 17:29:44 Max_iter: 1000
At iteration 467, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.541 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 17:30:16 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 484, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.522 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 17:30:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 440, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.482 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 17:31:16 Max_iter: 1000
At iteration 412, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.437 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 17:31:43 Max_iter: 1000
At iteration 396, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.413 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 17:32:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 410, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.442 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 17:32:34 Max_iter: 1000
At iteration 365, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.361 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 17:32:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 360, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.342 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 17:33:16 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 387, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.38 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 17:33:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 345, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.303 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 17:33:57 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 379, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.348 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 17:34:18 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 390, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.32 min
==========
Testing lambda: 0.001 starting at 2024-09-16 17:34:37 Max_iter: 1000
At iteration 381, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.298 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 17:34:55 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.256 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 17:35:10 Max_iter: 1000
At iteration 328, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.234 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 17:35:24 Max_iter: 1000
At iteration 326, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.219 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 17:35:38 Max_iter: 1000
At iteration 330, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.214 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 17:35:50 Max_iter: 1000
At iteration 332, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.214 min
==========
Testing lambda: 0.01 starting at 2024-09-16 17:36:03 Max_iter: 1000
At iteration 310, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.199 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 17:36:15 Max_iter: 1000
At iteration 344, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.222 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 17:36:28 Max_iter: 1000
At iteration 281, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.182 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 17:36:39 Max_iter: 1000
At iteration 305, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.195 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 17:36:51 Max_iter: 1000
At iteration 242, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.16 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 17:37:01 Max_iter: 1000
At iteration 184, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.126 min
==========
Testing lambda: 0.1 starting at 2024-09-16 17:37:08 Max_iter: 1000
At iteration 102, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.076 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.378672    0.094836          0.094929           10415  0.989398  ...  0.848393   0.778122  0.855360      0.344853       0.000947
0.000015    0.352312    0.103774          0.103896            9690  0.990518  ...  0.855460   0.790966  0.862543      0.358291       0.002217
0.000022    0.319772    0.116187          0.116574            8795  0.990514  ...  0.860445   0.799363  0.867512      0.372379       0.000012
0.000032    0.288394    0.130089          0.130643            7932  0.991120  ...  0.868299   0.811625  0.875218      0.386770       0.002042
0.000046    0.253672    0.146226          0.146568            6977  0.991214  ...  0.867212   0.817287  0.874707      0.401393       0.003783

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
CD8_Naive Time elapsed: 7.611763191223145 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD8_Proliferating
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 17:37:44 Max_iter: 1000
At iteration 481, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.543 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 17:38:16 Max_iter: 1000
At iteration 458, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.491 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 17:38:46 Max_iter: 1000
At iteration 459, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.494 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 17:39:15 Max_iter: 1000
At iteration 485, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.484 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 17:39:44 Max_iter: 1000
At iteration 475, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.468 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 17:40:13 Max_iter: 1000
At iteration 476, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.458 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 17:40:40 Max_iter: 1000
At iteration 460, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.439 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 17:41:06 Max_iter: 1000
At iteration 446, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.407 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 17:41:31 Max_iter: 1000
At iteration 420, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.366 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 17:41:53 Max_iter: 1000
At iteration 408, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.36 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 17:42:14 Max_iter: 1000
At iteration 386, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.331 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 17:42:34 Max_iter: 1000
At iteration 358, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.299 min
==========
Testing lambda: 0.001 starting at 2024-09-16 17:42:52 Max_iter: 1000
At iteration 345, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.277 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 17:43:09 Max_iter: 1000
At iteration 334, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.243 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 17:43:23 Max_iter: 1000
At iteration 330, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.231 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 17:43:37 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.222 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 17:43:51 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.214 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 17:44:03 Max_iter: 1000
At iteration 339, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.218 min
==========
Testing lambda: 0.01 starting at 2024-09-16 17:44:16 Max_iter: 1000
At iteration 352, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.223 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 17:44:30 Max_iter: 1000
At iteration 383, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.241 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 17:44:44 Max_iter: 1000
At iteration 310, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.199 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 17:44:56 Max_iter: 1000
At iteration 299, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.191 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 17:45:08 Max_iter: 1000
At iteration 257, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.04641588833612786, cost : 0.166 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 17:45:18 Max_iter: 1000
At iteration 202, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.0681292069057962, cost : 0.135 min
==========
Testing lambda: 0.1 starting at 2024-09-16 17:45:26 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.428847    0.213483          0.202899           11795  0.880323  ...  0.110251   0.051546  0.085470      0.448891       0.005935
0.000015    0.412994    0.224719          0.217391           11359  0.891788  ...  0.097596   0.050633  0.080808      0.458150       0.000282
0.000022    0.388234    0.247191          0.231884           10678  0.907250  ...  0.156567   0.084507  0.131868      0.468459       0.000851
0.000032    0.361802    0.269663          0.246377            9951  0.908086  ...  0.106492   0.059701  0.091954      0.479364       0.000730
0.000046    0.330716    0.292135          0.275362            9096  0.918266  ...  0.166434   0.113636  0.156250      0.490584       0.000655

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
CD8_Proliferating Time elapsed: 7.8509481191635135 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD8_TCM
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 17:45:59 Max_iter: 1000
At iteration 494, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.515 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 17:46:30 Max_iter: 1000
At iteration 479, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.482 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 17:46:59 Max_iter: 1000
At iteration 467, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.469 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 17:47:27 Max_iter: 1000
At iteration 461, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.456 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 17:47:54 Max_iter: 1000
At iteration 454, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.428 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 17:48:20 Max_iter: 1000
At iteration 439, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.406 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 17:48:44 Max_iter: 1000
At iteration 424, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.38 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 17:49:07 Max_iter: 1000
At iteration 400, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.355 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 17:49:28 Max_iter: 1000
At iteration 389, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.335 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 17:49:48 Max_iter: 1000
At iteration 368, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.308 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 17:50:07 Max_iter: 1000
At iteration 364, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.29 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 17:50:24 Max_iter: 1000
At iteration 350, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.305 min
==========
Testing lambda: 0.001 starting at 2024-09-16 17:50:43 Max_iter: 1000
At iteration 339, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.278 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 17:50:59 Max_iter: 1000
At iteration 325, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.248 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 17:51:14 Max_iter: 1000
At iteration 325, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.233 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 17:51:28 Max_iter: 1000
At iteration 322, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.218 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 17:51:41 Max_iter: 1000
At iteration 316, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.205 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 17:51:54 Max_iter: 1000
At iteration 321, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.208 min
==========
Testing lambda: 0.01 starting at 2024-09-16 17:52:06 Max_iter: 1000
At iteration 345, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.221 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 17:52:19 Max_iter: 1000
At iteration 362, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.228 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 17:52:33 Max_iter: 1000
At iteration 290, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.187 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 17:52:44 Max_iter: 1000
At iteration 285, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.183 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 17:52:55 Max_iter: 1000
At iteration 193, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.04641588833612786, cost : 0.13 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 17:53:03 Max_iter: 1000
At iteration 100, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.077 min
==========
Testing lambda: 0.1 starting at 2024-09-16 17:53:08 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.382744    0.096857          0.096338           10527  0.955106  ...  0.490177   0.419501  0.497312      0.459540       0.000229
0.000015    0.355366    0.106479          0.105892            9774  0.955455  ...  0.503351   0.435897  0.510929      0.470876       0.000929
0.000022    0.326098    0.118024          0.117834            8969  0.953784  ...  0.518076   0.469231  0.528139      0.482633       0.000375
0.000032    0.295375    0.132777          0.131369            8124  0.961697  ...  0.548076   0.485222  0.555712      0.494857       0.000571
0.000046    0.262107    0.148172          0.147293            7209  0.965545  ...  0.563307   0.513089  0.572263      0.507520       0.000623

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
CD8_TCM Time elapsed: 7.288796897729238 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD8_TEM
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 17:53:40 Max_iter: 1000
At iteration 476, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.509 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 17:54:11 Max_iter: 1000
At iteration 450, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.454 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 17:54:38 Max_iter: 1000
At iteration 518, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.52 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 17:55:09 Max_iter: 1000
At iteration 494, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.487 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 17:55:39 Max_iter: 1000
At iteration 481, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.451 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 17:56:06 Max_iter: 1000
At iteration 464, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.418 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 17:56:31 Max_iter: 1000
At iteration 458, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.403 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 17:56:55 Max_iter: 1000
At iteration 435, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.373 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 17:57:17 Max_iter: 1000
At iteration 415, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.348 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 17:57:38 Max_iter: 1000
At iteration 399, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.343 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 17:57:59 Max_iter: 1000
At iteration 385, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.34 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 17:58:19 Max_iter: 1000
At iteration 374, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.324 min
==========
Testing lambda: 0.001 starting at 2024-09-16 17:58:39 Max_iter: 1000
At iteration 358, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.281 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 17:58:56 Max_iter: 1000
At iteration 349, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.257 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 17:59:11 Max_iter: 1000
At iteration 342, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.24 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 17:59:25 Max_iter: 1000
At iteration 334, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.221 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 17:59:39 Max_iter: 1000
At iteration 341, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.227 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 17:59:52 Max_iter: 1000
At iteration 329, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.212 min
==========
Testing lambda: 0.01 starting at 2024-09-16 18:00:05 Max_iter: 1000
At iteration 358, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.227 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 18:00:19 Max_iter: 1000
At iteration 365, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.232 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 18:00:33 Max_iter: 1000
At iteration 380, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.239 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 18:00:47 Max_iter: 1000
At iteration 284, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.183 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 18:00:58 Max_iter: 1000
At iteration 206, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.137 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 18:01:06 Max_iter: 1000
At iteration 189, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.128 min
==========
Testing lambda: 0.1 starting at 2024-09-16 18:01:14 Max_iter: 1000
At iteration 97, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.074 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.376018    0.096926          0.096840           10342  0.973858  ...  0.754208   0.690570  0.768306      0.379717       0.001674
0.000015    0.351258    0.105844          0.106408            9661  0.974258  ...  0.765361   0.717684  0.780214      0.392827       0.000526
0.000022    0.320462    0.117343          0.117570            8814  0.975067  ...  0.768948   0.723670  0.783738      0.406011       0.000810
0.000032    0.289776    0.129782          0.130473            7970  0.976153  ...  0.777542   0.730970  0.791643      0.419866       0.000799
0.000046    0.257199    0.144332          0.144970            7074  0.976898  ...  0.782806   0.755507  0.797674      0.434076       0.001489

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
CD8_TEM Time elapsed: 7.766492319107056 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Doublet
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 18:01:50 Max_iter: 1000
At iteration 445, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.548 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 18:02:23 Max_iter: 1000
At iteration 479, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.54 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 18:02:56 Max_iter: 1000
At iteration 483, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.523 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 18:03:27 Max_iter: 1000
At iteration 411, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.463 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 18:03:55 Max_iter: 1000
At iteration 511, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.521 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 18:04:26 Max_iter: 1000
At iteration 472, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.464 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 18:04:54 Max_iter: 1000
At iteration 436, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.427 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 18:05:20 Max_iter: 1000
At iteration 458, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.423 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 18:05:45 Max_iter: 1000
At iteration 436, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.388 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 18:06:08 Max_iter: 1000
At iteration 431, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.373 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 18:06:31 Max_iter: 1000
At iteration 404, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.34 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 18:06:51 Max_iter: 1000
At iteration 387, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.321 min
==========
Testing lambda: 0.001 starting at 2024-09-16 18:07:10 Max_iter: 1000
At iteration 365, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.304 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 18:07:29 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.284 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 18:07:46 Max_iter: 1000
At iteration 330, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.248 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 18:08:00 Max_iter: 1000
At iteration 316, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.225 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 18:08:14 Max_iter: 1000
At iteration 311, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 0.209 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 18:08:27 Max_iter: 1000
At iteration 303, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.198 min
==========
Testing lambda: 0.01 starting at 2024-09-16 18:08:38 Max_iter: 1000
At iteration 327, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.21 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 18:08:51 Max_iter: 1000
At iteration 316, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.204 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 18:09:03 Max_iter: 1000
At iteration 277, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.02154434690031885, cost : 0.18 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 18:09:14 Max_iter: 1000
At iteration 264, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.0316227766016838, cost : 0.173 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 18:09:24 Max_iter: 1000
At iteration 274, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.04641588833612786, cost : 0.18 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 18:09:35 Max_iter: 1000
At iteration 250, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.0681292069057962, cost : 0.165 min
==========
Testing lambda: 0.1 starting at 2024-09-16 18:09:45 Max_iter: 1000
At iteration 172, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.10000000000000002, cost : 0.12 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.437973    0.165548          0.165289           12046  0.862010  ...  0.227691   0.151220  0.214533      0.433229       0.000314
0.000015    0.410377    0.185682          0.184573           11287  0.869802  ...  0.231865   0.161290  0.222222      0.443223       0.000128
0.000022    0.383072    0.203579          0.203857           10536  0.870610  ...  0.229346   0.168675  0.224000      0.453786       0.000476
0.000032    0.358275    0.223714          0.225895            9854  0.874271  ...  0.201113   0.152866  0.199170      0.465049       0.000200
0.000046    0.319335    0.248322          0.247934            8783  0.860608  ...  0.257130   0.208955  0.256881      0.475792       0.000603

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
Doublet Time elapsed: 8.156184164683024 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Eryth
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 18:10:23 Max_iter: 1000
At iteration 857, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.673 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 18:11:04 Max_iter: 1000
At iteration 798, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.649 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 18:11:43 Max_iter: 1000
At iteration 477, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.479 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 18:12:11 Max_iter: 1000
At iteration 470, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.448 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 18:12:38 Max_iter: 1000
At iteration 447, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.431 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 18:13:04 Max_iter: 1000
At iteration 440, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.393 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 18:13:28 Max_iter: 1000
At iteration 427, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.37 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 18:13:50 Max_iter: 1000
At iteration 414, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.348 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 18:14:11 Max_iter: 1000
At iteration 399, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.322 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 18:14:30 Max_iter: 1000
At iteration 377, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.305 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 18:14:49 Max_iter: 1000
At iteration 360, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.268 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 18:15:05 Max_iter: 1000
At iteration 344, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.251 min
==========
Testing lambda: 0.001 starting at 2024-09-16 18:15:20 Max_iter: 1000
At iteration 328, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.231 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 18:15:34 Max_iter: 1000
At iteration 330, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.222 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 18:15:47 Max_iter: 1000
At iteration 329, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.213 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 18:16:00 Max_iter: 1000
At iteration 324, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.207 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 18:16:12 Max_iter: 1000
At iteration 353, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.227 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 18:16:26 Max_iter: 1000
At iteration 329, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.212 min
==========
Testing lambda: 0.01 starting at 2024-09-16 18:16:38 Max_iter: 1000
At iteration 315, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.010000000000000004, cost : 0.204 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 18:16:51 Max_iter: 1000
At iteration 292, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.014677992676220709, cost : 0.192 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 18:17:02 Max_iter: 1000
At iteration 334, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.02154434690031885, cost : 0.214 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 18:17:15 Max_iter: 1000
At iteration 262, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.169 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 18:17:25 Max_iter: 1000
At iteration 251, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.04641588833612786, cost : 0.163 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 18:17:35 Max_iter: 1000
At iteration 151, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.105 min
==========
Testing lambda: 0.1 starting at 2024-09-16 18:17:41 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.267125    0.120482          0.115942            7347  0.994921  ...  0.628405   0.461538  0.600000      0.262070       0.012497
0.000015    0.277741    0.120482          0.115942            7639  0.985813  ...  0.640887   0.480000  0.615385      0.334704       0.003266
0.000022    0.308428    0.108434          0.101449            8483  0.996705  ...  0.575333   0.387097  0.533333      0.483326       0.000433
0.000032    0.273815    0.120482          0.101449            7531  0.999223  ...  0.575333   0.387097  0.533333      0.496091       0.000904
0.000046    0.235493    0.132530          0.115942            6477  0.999397  ...  0.708785   0.541667  0.684211      0.508819       0.000852

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
Eryth Time elapsed: 7.439017875989278 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for HSPC
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 18:18:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 682, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 1.14 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 18:19:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 754, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 1.157 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 18:20:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 763, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 1.095 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 18:21:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 732, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 1.117 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 18:22:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 653, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 1.21 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 18:23:57 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 701, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 1.363 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 18:25:19 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
lambda is : 9.999999999999991e-05, cost : 1.316 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 18:26:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 677, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 1.256 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 18:27:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 652, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 1.228 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 18:29:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 523, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 1.181 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 18:30:18 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 521, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 1.124 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 18:31:25 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 569, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 1.107 min
==========
Testing lambda: 0.001 starting at 2024-09-16 18:32:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
lambda is : 0.0010000000000000002, cost : 5.465 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 18:37:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 479, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 1.009 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 18:39:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 519, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 1.075 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 18:40:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 308, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.259 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 18:40:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 399, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.274 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 18:40:36 Max_iter: 1000
At iteration 309, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.202 min
==========
Testing lambda: 0.01 starting at 2024-09-16 18:40:49 Max_iter: 1000
At iteration 322, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.207 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 18:41:01 Max_iter: 1000
At iteration 352, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.223 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 18:41:14 Max_iter: 1000
At iteration 306, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.197 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 18:41:26 Max_iter: 1000
At iteration 302, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.194 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 18:41:38 Max_iter: 1000
At iteration 284, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.184 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 18:41:49 Max_iter: 1000
At iteration 227, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.15 min
==========
Testing lambda: 0.1 starting at 2024-09-16 18:41:58 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.341259    0.252788          0.254717            9386  0.999825  ...  0.611869   0.377483  0.548077      0.076779       0.019572
0.000015    0.280214    0.297398          0.297170            7707  0.999913  ...  0.757393   0.575758  0.730769      0.082911       0.002114
0.000022    0.223349    0.345725          0.353774            6143  0.999956  ...  0.817892   0.670588  0.802817      0.066836       1.058739
0.000032    0.190990    0.379182          0.386792            5253  0.999956  ...  0.843249   0.712500  0.832117      0.083702       0.001983
0.000046    0.227240    0.360595          0.363208            6250  0.999913  ...  0.738801   0.548077  0.708075      0.104481       0.000173

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
HSPC Time elapsed: 23.893214321136476 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for ILC
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 18:42:32 Max_iter: 1000
At iteration 468, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.502 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 18:43:02 Max_iter: 1000
At iteration 496, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.511 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 18:43:32 Max_iter: 1000
At iteration 497, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.495 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 18:44:02 Max_iter: 1000
At iteration 470, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.458 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 18:44:30 Max_iter: 1000
At iteration 469, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.441 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 18:44:56 Max_iter: 1000
At iteration 446, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.405 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 18:45:20 Max_iter: 1000
At iteration 421, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.377 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 18:45:43 Max_iter: 1000
At iteration 415, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.356 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 18:46:04 Max_iter: 1000
At iteration 386, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.326 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 18:46:24 Max_iter: 1000
At iteration 377, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.309 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 18:46:43 Max_iter: 1000
At iteration 363, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.283 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 18:47:00 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.249 min
==========
Testing lambda: 0.001 starting at 2024-09-16 18:47:15 Max_iter: 1000
At iteration 342, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.237 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 18:47:29 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.222 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 18:47:42 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.22 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 18:47:55 Max_iter: 1000
At iteration 323, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.209 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 18:48:08 Max_iter: 1000
At iteration 322, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.206 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 18:48:20 Max_iter: 1000
At iteration 315, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.204 min
==========
Testing lambda: 0.01 starting at 2024-09-16 18:48:32 Max_iter: 1000
At iteration 342, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.219 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 18:48:46 Max_iter: 1000
At iteration 330, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.21 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 18:48:58 Max_iter: 1000
At iteration 344, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.216 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 18:49:11 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.209 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 18:49:24 Max_iter: 1000
At iteration 275, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.04641588833612786, cost : 0.178 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 18:49:34 Max_iter: 1000
At iteration 151, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.106 min
==========
Testing lambda: 0.1 starting at 2024-09-16 18:49:41 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.382563    0.097561          0.098039           10522  0.988350  ...  0.255275   0.100000  0.173913      0.462326       0.000989
0.000015    0.356421    0.105691          0.107843            9803  0.991212  ...  0.398710   0.210526  0.329897      0.473285       0.000219
0.000022    0.324316    0.121951          0.117647            8920  0.994169  ...  0.449245   0.266667  0.395062      0.485120       0.000822
0.000032    0.289921    0.130081          0.132353            7974  0.996939  ...  0.502701   0.333333  0.463768      0.497171       0.000720
0.000046    0.256254    0.146341          0.147059            7048  0.996433  ...  0.688225   0.586207  0.680000      0.509293       0.001060

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
ILC Time elapsed: 7.29218600988388 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for MAIT
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 18:50:13 Max_iter: 1000
At iteration 502, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.519 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 18:50:44 Max_iter: 1000
At iteration 441, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.479 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 18:51:13 Max_iter: 1000
At iteration 459, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.461 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 18:51:41 Max_iter: 1000
At iteration 461, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.444 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 18:52:07 Max_iter: 1000
At iteration 458, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.427 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 18:52:33 Max_iter: 1000
At iteration 432, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.388 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 18:52:56 Max_iter: 1000
At iteration 423, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.383 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 18:53:19 Max_iter: 1000
At iteration 402, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.344 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 18:53:40 Max_iter: 1000
At iteration 384, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.312 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 18:53:58 Max_iter: 1000
At iteration 361, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.29 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 18:54:16 Max_iter: 1000
At iteration 363, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.28 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 18:54:33 Max_iter: 1000
At iteration 342, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.253 min
==========
Testing lambda: 0.001 starting at 2024-09-16 18:54:48 Max_iter: 1000
At iteration 335, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.236 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 18:55:02 Max_iter: 1000
At iteration 335, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.237 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 18:55:16 Max_iter: 1000
At iteration 325, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.228 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 18:55:30 Max_iter: 1000
At iteration 327, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.219 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 18:55:43 Max_iter: 1000
At iteration 334, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.216 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 18:55:56 Max_iter: 1000
At iteration 312, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.202 min
==========
Testing lambda: 0.01 starting at 2024-09-16 18:56:08 Max_iter: 1000
At iteration 318, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.206 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 18:56:21 Max_iter: 1000
At iteration 355, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.226 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 18:56:34 Max_iter: 1000
At iteration 303, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.194 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 18:56:46 Max_iter: 1000
At iteration 246, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.162 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 18:56:55 Max_iter: 1000
At iteration 224, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.15 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 18:57:04 Max_iter: 1000
At iteration 159, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.111 min
==========
Testing lambda: 0.1 starting at 2024-09-16 18:57:11 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.367147    0.088933          0.088650           10098  0.985214  ...  0.769620   0.660465  0.766532      0.451999       0.001148
0.000015    0.343368    0.097497          0.096935            9444  0.986603  ...  0.794633   0.709596  0.794908      0.463525       0.001155
0.000022    0.313845    0.106719          0.107291            8632  0.988166  ...  0.809075   0.729381  0.809728      0.475310       0.000479
0.000032    0.283232    0.118577          0.117647            7790  0.988738  ...  0.829330   0.764865  0.831131      0.487583       0.000628
0.000046    0.247928    0.132411          0.132560            6819  0.992299  ...  0.873636   0.828080  0.875758      0.500202       0.000711

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
MAIT Time elapsed: 7.108987025419871 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for NK
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 18:57:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 648, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.767 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 18:58:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 478, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.696 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 18:59:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 385, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.589 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 18:59:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 404, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.657 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 19:00:26 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 437, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.656 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 19:01:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 557, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.731 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 19:01:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 377, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.56 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 19:02:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 394, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.536 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 19:02:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 326, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.459 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 19:03:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 407, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.492 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 19:03:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 423, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.48 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 19:04:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 260, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.256 min
==========
Testing lambda: 0.001 starting at 2024-09-16 19:04:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 368, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.33 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 19:04:56 Max_iter: 1000
At iteration 308, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.235 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 19:05:11 Max_iter: 1000
At iteration 319, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.236 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 19:05:25 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 356, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.257 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 19:05:40 Max_iter: 1000
At iteration 346, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 0.229 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 19:05:54 Max_iter: 1000
At iteration 367, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.236 min
==========
Testing lambda: 0.01 starting at 2024-09-16 19:06:08 Max_iter: 1000
At iteration 377, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.239 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 19:06:22 Max_iter: 1000
At iteration 381, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.24 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 19:06:37 Max_iter: 1000
At iteration 329, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.21 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 19:06:50 Max_iter: 1000
At iteration 417, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.26 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 19:07:05 Max_iter: 1000
At iteration 402, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.251 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 19:07:20 Max_iter: 1000
At iteration 380, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.239 min
==========
Testing lambda: 0.1 starting at 2024-09-16 19:07:34 Max_iter: 1000
At iteration 251, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.164 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.319481    0.132138          0.132951            8787  0.995269  ...  0.905278   0.853840  0.912219      0.118089       0.001170
0.000015    0.296321    0.142210          0.142365            8150  0.994899  ...  0.900518   0.849134  0.907889      0.142639       0.000137
0.000022    0.279850    0.152098          0.151780            7697  0.995645  ...  0.911670   0.867115  0.918486      0.160243       0.000084
0.000032    0.261998    0.163556          0.163720            7206  0.996329  ...  0.907532   0.859284  0.914488      0.175609       0.000065
0.000046    0.228694    0.183977          0.184156            6290  0.995991  ...  0.914323   0.874150  0.921147      0.191523       0.000066

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
NK Time elapsed: 10.130358791351318 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for NK_CD56bright
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 19:08:16 Max_iter: 1000
At iteration 499, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.523 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 19:08:47 Max_iter: 1000
At iteration 468, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.534 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 19:09:19 Max_iter: 1000
At iteration 489, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.498 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 19:09:49 Max_iter: 1000
At iteration 423, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.425 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 19:10:15 Max_iter: 1000
At iteration 464, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.436 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 19:10:41 Max_iter: 1000
At iteration 449, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.403 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 19:11:05 Max_iter: 1000
At iteration 443, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.409 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 19:11:30 Max_iter: 1000
At iteration 427, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.379 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 19:11:52 Max_iter: 1000
At iteration 395, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.334 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 19:12:12 Max_iter: 1000
At iteration 379, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.316 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 19:12:31 Max_iter: 1000
At iteration 364, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.289 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 19:12:49 Max_iter: 1000
At iteration 353, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.262 min
==========
Testing lambda: 0.001 starting at 2024-09-16 19:13:05 Max_iter: 1000
At iteration 337, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.24 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 19:13:19 Max_iter: 1000
At iteration 336, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.236 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 19:13:33 Max_iter: 1000
At iteration 328, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.223 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 19:13:46 Max_iter: 1000
At iteration 324, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.218 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 19:14:00 Max_iter: 1000
At iteration 336, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 0.22 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 19:14:13 Max_iter: 1000
At iteration 334, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.216 min
==========
Testing lambda: 0.01 starting at 2024-09-16 19:14:26 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.221 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 19:14:39 Max_iter: 1000
At iteration 359, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.229 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 19:14:53 Max_iter: 1000
At iteration 297, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.192 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 19:15:04 Max_iter: 1000
At iteration 272, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.176 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 19:15:15 Max_iter: 1000
At iteration 278, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.179 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 19:15:26 Max_iter: 1000
At iteration 189, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.129 min
==========
Testing lambda: 0.1 starting at 2024-09-16 19:15:33 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.019 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.394197    0.105754          0.106719           10842  0.980559  ...  0.662815   0.517544  0.646575      0.455661       0.000847
0.000015    0.368092    0.116641          0.118577           10124  0.978871  ...  0.690457   0.565217  0.680233      0.466901       0.000225
0.000022    0.340750    0.127527          0.130435            9372  0.980729  ...  0.694768   0.567308  0.684058      0.478439       0.000732
0.000032    0.309591    0.143079          0.144269            8515  0.985939  ...  0.733090   0.640884  0.729560      0.490441       0.000572
0.000046    0.274069    0.157076          0.160079            7538  0.987277  ...  0.748082   0.655556  0.744479      0.502508       0.000730

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
NK_CD56bright Time elapsed: 7.4534450252850855 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for NK_Proliferating
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 19:16:07 Max_iter: 1000
At iteration 516, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.549 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 19:16:40 Max_iter: 1000
At iteration 484, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.517 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 19:17:12 Max_iter: 1000
At iteration 516, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.539 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 19:17:44 Max_iter: 1000
At iteration 509, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.506 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 19:18:14 Max_iter: 1000
At iteration 442, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.463 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 19:18:42 Max_iter: 1000
At iteration 462, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.452 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 19:19:09 Max_iter: 1000
At iteration 459, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.436 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 19:19:35 Max_iter: 1000
At iteration 429, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.393 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 19:19:59 Max_iter: 1000
At iteration 414, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.372 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 19:20:21 Max_iter: 1000
At iteration 403, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.349 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 19:20:42 Max_iter: 1000
At iteration 374, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.318 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 19:21:01 Max_iter: 1000
At iteration 359, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.289 min
==========
Testing lambda: 0.001 starting at 2024-09-16 19:21:19 Max_iter: 1000
At iteration 346, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.268 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 19:21:35 Max_iter: 1000
At iteration 342, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.248 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 19:21:50 Max_iter: 1000
At iteration 335, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.233 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 19:22:04 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.223 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 19:22:17 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 0.225 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 19:22:30 Max_iter: 1000
At iteration 342, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.006812920690579613, cost : 0.221 min
==========
Testing lambda: 0.01 starting at 2024-09-16 19:22:44 Max_iter: 1000
At iteration 351, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.010000000000000004, cost : 0.226 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 19:22:57 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.014677992676220709, cost : 0.213 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 19:23:10 Max_iter: 1000
At iteration 348, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.224 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 19:23:24 Max_iter: 1000
At iteration 223, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.149 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 19:23:32 Max_iter: 1000
At iteration 219, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.145 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 19:23:41 Max_iter: 1000
At iteration 191, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.0681292069057962, cost : 0.13 min
==========
Testing lambda: 0.1 starting at 2024-09-16 19:23:49 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.429683    0.172330          0.169139           11818  0.980708  ...  0.544776   0.347594  0.496183      0.440319       0.000810
0.000015    0.404959    0.186893          0.183976           11138  0.984755  ...  0.553446   0.375758  0.516667      0.450810       0.001061
0.000022    0.376636    0.203883          0.201780           10359  0.986756  ...  0.612888   0.431373  0.578947      0.461431       0.000662
0.000032    0.349186    0.220874          0.219585            9604  0.986556  ...  0.642701   0.504065  0.626263      0.472517       0.001246
0.000046    0.322898    0.242718          0.243323            8881  0.984316  ...  0.629826   0.484375  0.610837      0.484159       0.000978

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
NK_Proliferating Time elapsed: 7.832447894414266 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Plasmablast
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 19:24:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 403, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.556 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 19:24:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 628, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.696 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 19:25:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 405, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.509 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 19:26:08 Max_iter: 1000
At iteration 399, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.465 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 19:26:36 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 411, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.444 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 19:27:02 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 408, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.452 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 19:27:29 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 412, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.432 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 19:27:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 415, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.41 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 19:28:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 768, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.589 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 19:28:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 422, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.377 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 19:29:18 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 732, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.567 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 19:29:52 Max_iter: 1000
At iteration 367, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.297 min
==========
Testing lambda: 0.001 starting at 2024-09-16 19:30:10 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.268 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 19:30:26 Max_iter: 1000
At iteration 327, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.239 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 19:30:40 Max_iter: 1000
At iteration 327, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.225 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 19:30:54 Max_iter: 1000
At iteration 322, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.215 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 19:31:07 Max_iter: 1000
At iteration 319, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.206 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 19:31:19 Max_iter: 1000
At iteration 323, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.207 min
==========
Testing lambda: 0.01 starting at 2024-09-16 19:31:31 Max_iter: 1000
At iteration 320, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.207 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 19:31:44 Max_iter: 1000
At iteration 300, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.014677992676220709, cost : 0.198 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 19:31:56 Max_iter: 1000
At iteration 312, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.02154434690031885, cost : 0.205 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 19:32:08 Max_iter: 1000
At iteration 296, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.191 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 19:32:19 Max_iter: 1000
At iteration 239, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.156 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 19:32:29 Max_iter: 1000
At iteration 235, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.0681292069057962, cost : 0.154 min
==========
Testing lambda: 0.1 starting at 2024-09-16 19:32:38 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.458588    0.187075          0.185841           12613  0.999956  ...  0.609900   0.375691  0.546185      0.433729       0.000010
0.000015    0.402232    0.231293          0.230088           11063  0.999956  ...  0.647244   0.422360  0.593886      0.269221       0.453528
0.000022    0.397906    0.231293          0.230088           10944  0.999955  ...  0.664184   0.444444  0.615385      0.456747       0.000038
0.000032    0.375654    0.251701          0.252212           10332  0.999999  ...  0.738716   0.548387  0.708333      0.468635       0.003079
0.000046    0.342859    0.278912          0.278761            9430  0.999999  ...  0.781223   0.612613  0.759777      0.480604       0.000043

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
Plasmablast Time elapsed: 8.408691549301148 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Platelet
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 19:33:11 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 894, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 2.911 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 19:36:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 880, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 2.807 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 19:38:54 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 258, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 1.044 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 19:39:57 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 915, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 2.878 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 19:42:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 585, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 2.201 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 19:45:01 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 236, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.917 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 19:45:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 559, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 2.06 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 19:48:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 801, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 2.486 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 19:50:29 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 597, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 2.168 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 19:52:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 601, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 2.233 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 19:54:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 579, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 2.228 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 19:57:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 216, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.804 min
==========
Testing lambda: 0.001 starting at 2024-09-16 19:57:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 539, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 2.378 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 20:00:18 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 635, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 2.668 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 20:02:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 610, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 2.58 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 20:05:33 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 613, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 2.534 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 20:08:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 279, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.964 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 20:09:03 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 367, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.006812920690579613, cost : 1.303 min
==========
Testing lambda: 0.01 starting at 2024-09-16 20:10:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 187, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.010000000000000004, cost : 0.151 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 20:10:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 328, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.355 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 20:10:51 Max_iter: 1000
At iteration 378, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.238 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 20:11:05 Max_iter: 1000
At iteration 308, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.199 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 20:11:17 Max_iter: 1000
At iteration 321, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.204 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 20:11:30 Max_iter: 1000
At iteration 258, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.169 min
==========
Testing lambda: 0.1 starting at 2024-09-16 20:11:40 Max_iter: 1000
At iteration 179, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.122 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.223786    0.062787          0.062326            6155  0.990773  ...  0.904131   0.878049  0.905660      0.301938       0.001049
0.000015    0.185682    0.076570          0.076279            5107  0.989913  ...  0.914605   0.889796  0.915966      0.337797       0.000600
0.000022    0.259562    0.054364          0.053023            7139  0.988785  ...  0.906529   0.878543  0.907950      0.469927       0.000060
0.000032    0.115692    0.125574          0.124651            3182  0.984369  ...  0.931978   0.927350  0.933333      0.285805       0.000284
0.000046    0.194772    0.075038          0.074419            5357  0.989567  ...  0.919574   0.907563  0.921109      0.484579       0.000065

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
Platelet Time elapsed: 38.725698777039845 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Treg
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 20:12:18 Max_iter: 1000
At iteration 425, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.502 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 20:12:48 Max_iter: 1000
At iteration 440, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.492 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 20:13:18 Max_iter: 1000
At iteration 489, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.5 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 20:13:48 Max_iter: 1000
At iteration 469, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.469 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 20:14:16 Max_iter: 1000
At iteration 447, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.436 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 20:14:42 Max_iter: 1000
At iteration 444, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.408 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 20:15:06 Max_iter: 1000
At iteration 424, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.385 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 20:15:30 Max_iter: 1000
At iteration 400, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.347 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 20:15:50 Max_iter: 1000
At iteration 377, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.314 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 20:16:09 Max_iter: 1000
At iteration 365, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.293 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 20:16:27 Max_iter: 1000
At iteration 343, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.258 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 20:16:42 Max_iter: 1000
At iteration 338, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.247 min
==========
Testing lambda: 0.001 starting at 2024-09-16 20:16:57 Max_iter: 1000
At iteration 341, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.246 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 20:17:12 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.252 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 20:17:27 Max_iter: 1000
At iteration 334, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.234 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 20:17:41 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.224 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 20:17:54 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.215 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 20:18:07 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.213 min
==========
Testing lambda: 0.01 starting at 2024-09-16 20:18:20 Max_iter: 1000
At iteration 326, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.21 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 20:18:33 Max_iter: 1000
At iteration 310, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.2 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 20:18:45 Max_iter: 1000
At iteration 284, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.184 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 20:18:56 Max_iter: 1000
At iteration 276, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.0316227766016838, cost : 0.178 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 20:19:06 Max_iter: 1000
At iteration 193, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.04641588833612786, cost : 0.131 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 20:19:14 Max_iter: 1000
At iteration 122, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.0681292069057962, cost : 0.09 min
==========
Testing lambda: 0.1 starting at 2024-09-16 20:19:20 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.362420    0.078571          0.078647            9968  0.979046  ...  0.718292   0.613079  0.715421      0.452855       0.000378
0.000015    0.331879    0.087143          0.086995            9128  0.981626  ...  0.722879   0.628895  0.721951      0.464517       0.001452
0.000022    0.302538    0.096429          0.096661            8321  0.982099  ...  0.756010   0.688474  0.758148      0.476632       0.000673
0.000032    0.271015    0.107857          0.108084            7454  0.985759  ...  0.783955   0.755245  0.788321      0.489376       0.000992
0.000046    0.238620    0.123571          0.123023            6563  0.987859  ...  0.792013   0.766784  0.796330      0.502398       0.000693

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
Treg Time elapsed: 7.194585049152375 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for cDC1
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 20:19:54 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 323, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.498 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 20:20:24 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 490, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.588 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 20:20:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 487, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.565 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 20:21:33 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 489, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.552 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 20:22:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 505, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.553 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 20:22:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 316, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.414 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 20:23:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 482, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.488 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 20:23:33 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 318, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.373 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 20:23:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 324, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.354 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 20:24:17 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 328, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.343 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 20:24:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 313, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.312 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 20:24:56 Max_iter: 1000
At iteration 314, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.278 min
==========
Testing lambda: 0.001 starting at 2024-09-16 20:25:13 Max_iter: 1000
At iteration 331, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.278 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 20:25:29 Max_iter: 1000
At iteration 338, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.251 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 20:25:44 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.241 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 20:25:59 Max_iter: 1000
At iteration 327, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.222 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 20:26:12 Max_iter: 1000
At iteration 316, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.206 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 20:26:25 Max_iter: 1000
At iteration 315, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.202 min
==========
Testing lambda: 0.01 starting at 2024-09-16 20:26:37 Max_iter: 1000
At iteration 330, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.211 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 20:26:49 Max_iter: 1000
At iteration 302, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.194 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 20:27:01 Max_iter: 1000
At iteration 347, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.222 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 20:27:14 Max_iter: 1000
At iteration 271, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.178 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 20:27:25 Max_iter: 1000
At iteration 298, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.19 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 20:27:36 Max_iter: 1000
At iteration 236, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.155 min
==========
Testing lambda: 0.1 starting at 2024-09-16 20:27:46 Max_iter: 1000
At iteration 49, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.047 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.450116    0.217391          0.213675           12380  0.994857  ...  0.341994   0.131034  0.228916      0.433726       0.000049
0.000015    0.422848    0.246377          0.239316           11630  0.995430  ...  0.374942   0.149254  0.258065      0.442154       0.000024
0.000022    0.399796    0.268116          0.264957           10996  0.999913  ...  0.429362   0.185841  0.313433      0.453296       0.000151
0.000032    0.369910    0.297101          0.290598           10174  0.998304  ...  0.441477   0.206186  0.338983      0.463954       0.001589
0.000046    0.343150    0.318841          0.316239            9438  0.997520  ...  0.509489   0.273973  0.425532      0.474983       0.000008

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
cDC1 Time elapsed: 8.038386591275533 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for cDC2
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 20:28:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 380, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.601 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 20:28:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 291, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.488 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 20:29:25 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 340, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.494 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 20:29:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 417, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.575 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 20:30:29 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 369, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.485 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 20:30:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 329, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.425 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 20:31:24 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 328, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.412 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 20:31:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 325, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.39 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 20:32:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 314, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.363 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 20:32:34 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 305, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.319 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 20:32:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 401, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.388 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 20:33:16 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 393, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.355 min
==========
Testing lambda: 0.001 starting at 2024-09-16 20:33:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 348, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.301 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 20:33:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 358, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.279 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 20:34:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 324, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.249 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 20:34:27 Max_iter: 1000
At iteration 352, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.24 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 20:34:42 Max_iter: 1000
At iteration 359, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 0.241 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 20:34:56 Max_iter: 1000
At iteration 357, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.006812920690579613, cost : 0.237 min
==========
Testing lambda: 0.01 starting at 2024-09-16 20:35:10 Max_iter: 1000
At iteration 347, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.224 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 20:35:24 Max_iter: 1000
At iteration 332, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.214 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 20:35:37 Max_iter: 1000
At iteration 307, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.199 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 20:35:48 Max_iter: 1000
At iteration 273, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.176 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 20:35:59 Max_iter: 1000
At iteration 281, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.182 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 20:36:10 Max_iter: 1000
At iteration 222, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.147 min
==========
Testing lambda: 0.1 starting at 2024-09-16 20:36:19 Max_iter: 1000
At iteration 184, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.125 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.448989    0.206872          0.207428           12349  0.994103  ...  0.774727   0.647887  0.767733      0.384816       0.000047
0.000015    0.426920    0.228346          0.230072           11742  0.995391  ...  0.759244   0.621076  0.749662      0.399420       0.000045
0.000022    0.397615    0.254116          0.255435           10936  0.996100  ...  0.795488   0.684080  0.791367      0.407095       0.000061
0.000032    0.374709    0.277738          0.278080           10306  0.996013  ...  0.830906   0.746594  0.830303      0.418433       0.000038
0.000046    0.342641    0.304223          0.306159            9424  0.995828  ...  0.841514   0.756831  0.840668      0.429922       0.000041

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
cDC2 Time elapsed: 8.241766726970672 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for dnT
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 20:36:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 907, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.742 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 20:37:43 Max_iter: 1000
At iteration 423, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.475 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 20:38:11 Max_iter: 1000
At iteration 431, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.467 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 20:38:39 Max_iter: 1000
At iteration 489, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.447 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 20:39:06 Max_iter: 1000
At iteration 482, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.435 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 20:39:32 Max_iter: 1000
At iteration 455, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.401 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 20:39:56 Max_iter: 1000
At iteration 431, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.394 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 20:40:20 Max_iter: 1000
At iteration 415, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.374 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 20:40:42 Max_iter: 1000
At iteration 397, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.32 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 20:41:02 Max_iter: 1000
At iteration 375, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.308 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 20:41:20 Max_iter: 1000
At iteration 352, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.276 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 20:41:37 Max_iter: 1000
At iteration 339, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 0.253 min
==========
Testing lambda: 0.001 starting at 2024-09-16 20:41:52 Max_iter: 1000
At iteration 336, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 0.237 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 20:42:06 Max_iter: 1000
At iteration 335, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 0.229 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 20:42:20 Max_iter: 1000
At iteration 335, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 0.225 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 20:42:33 Max_iter: 1000
At iteration 325, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.223 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 20:42:47 Max_iter: 1000
At iteration 318, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.206 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 20:42:59 Max_iter: 1000
At iteration 327, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.21 min
==========
Testing lambda: 0.01 starting at 2024-09-16 20:43:12 Max_iter: 1000
At iteration 334, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.213 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 20:43:24 Max_iter: 1000
At iteration 374, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.235 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 20:43:39 Max_iter: 1000
At iteration 299, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.192 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 20:43:50 Max_iter: 1000
At iteration 246, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.161 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 20:44:00 Max_iter: 1000
At iteration 207, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.04641588833612786, cost : 0.138 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 20:44:08 Max_iter: 1000
At iteration 133, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.0681292069057962, cost : 0.096 min
==========
Testing lambda: 0.1 starting at 2024-09-16 20:44:14 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.257381    0.167247          0.168831            7079  0.921902  ...  0.576738   0.625000  0.576923      0.197711       0.014062
0.000015    0.359366    0.118467          0.116883            9884  0.909096  ...  0.376389   0.270270  0.359281      0.478340       0.003116
0.000022    0.330570    0.128920          0.134199            9092  0.899065  ...  0.475414   0.413333  0.473282      0.489441       0.000751
0.000032    0.298647    0.142857          0.147186            8214  0.890023  ...  0.506818   0.518519  0.509091      0.500803       0.001192
0.000046    0.268506    0.160279          0.160173            7385  0.916871  ...  0.589931   0.632653  0.590476      0.512821       0.000790

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
dnT Time elapsed: 7.4049235582351685 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for gdT
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 20:44:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 827, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999997e-06, cost : 0.899 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 20:45:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 798, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 0.938 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 20:46:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 807, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 0.903 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 20:47:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 923, Convergence with loss difference, Device: cuda
lambda is : 3.16227766016838e-05, cost : 0.932 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 20:48:27 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 886, Convergence with loss difference, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 0.876 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 20:49:19 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 669, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 0.775 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 20:50:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 659, Convergence with loss difference, Device: cuda
lambda is : 9.999999999999991e-05, cost : 0.7 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 20:50:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 642, Convergence with loss difference, Device: cuda
lambda is : 0.00014677992676220703, cost : 0.704 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 20:51:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 645, Convergence with loss difference, Device: cuda
lambda is : 0.0002154434690031884, cost : 0.665 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 20:52:10 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 631, Convergence with loss difference, Device: cuda
lambda is : 0.00031622776601683783, cost : 0.624 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 20:52:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 644, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.684 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 20:53:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 633, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.704 min
==========
Testing lambda: 0.001 starting at 2024-09-16 20:54:11 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 663, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.713 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 20:54:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 717, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.837 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 20:55:44 Max_iter: 1000
At iteration 353, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.241 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 20:55:58 Max_iter: 1000
At iteration 343, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.225 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 20:56:12 Max_iter: 1000
At iteration 350, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.226 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 20:56:25 Max_iter: 1000
At iteration 339, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.219 min
==========
Testing lambda: 0.01 starting at 2024-09-16 20:56:38 Max_iter: 1000
At iteration 326, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.211 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 20:56:51 Max_iter: 1000
At iteration 317, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.203 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 20:57:03 Max_iter: 1000
At iteration 411, Convergence with loss difference, Device: cuda
lambda is : 0.02154434690031885, cost : 0.257 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 20:57:19 Max_iter: 1000
At iteration 294, Convergence with loss difference, Device: cuda
lambda is : 0.0316227766016838, cost : 0.189 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 20:57:30 Max_iter: 1000
At iteration 201, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.134 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 20:57:38 Max_iter: 1000
At iteration 110, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.083 min
==========
Testing lambda: 0.1 starting at 2024-09-16 20:57:43 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.328098    0.117489          0.116779            9024  0.979880  ...  0.737956   0.663158  0.742049      0.209400       0.000418
0.000015    0.298357    0.130901          0.130537            8206  0.980767  ...  0.764246   0.712984  0.769988      0.211407       0.000517
0.000022    0.260835    0.149142          0.148993            7174  0.982204  ...  0.773550   0.720455  0.778870      0.214038       0.000502
0.000032    0.222877    0.168991          0.168456            6130  0.984131  ...  0.791256   0.761557  0.797452      0.217924       0.000157
0.000046    0.187427    0.194206          0.193289            5155  0.984154  ...  0.790880   0.770574  0.797419      0.223667       0.000202

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
gdT Time elapsed: 13.116671272118886 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for pDC
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Testing lambda: 1e-05 starting at 2024-09-16 20:58:18 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
lambda is : 9.999999999999997e-06, cost : 1.859 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-16 21:00:09 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 978, Convergence with loss difference, Device: cuda
lambda is : 1.4677992676220687e-05, cost : 1.838 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-16 21:01:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 792, Convergence with loss difference, Device: cuda
lambda is : 2.1544346900318854e-05, cost : 1.827 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-16 21:03:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
lambda is : 3.16227766016838e-05, cost : 1.966 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-16 21:05:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
lambda is : 4.6415888336127784e-05, cost : 1.953 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-16 21:07:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 939, Convergence with loss difference, Device: cuda
lambda is : 6.81292069057961e-05, cost : 1.954 min
==========
Testing lambda: 0.0001 starting at 2024-09-16 21:09:41 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
lambda is : 9.999999999999991e-05, cost : 1.888 min
==========
Testing lambda: 0.000147 starting at 2024-09-16 21:11:35 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
lambda is : 0.00014677992676220703, cost : 2.063 min
==========
Testing lambda: 0.000215 starting at 2024-09-16 21:13:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
lambda is : 0.0002154434690031884, cost : 5.271 min
==========
Testing lambda: 0.000316 starting at 2024-09-16 21:18:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
lambda is : 0.00031622776601683783, cost : 2.443 min
==========
Testing lambda: 0.000464 starting at 2024-09-16 21:21:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 335, Convergence with loss difference, Device: cuda
lambda is : 0.00046415888336127795, cost : 0.827 min
==========
Testing lambda: 0.000681 starting at 2024-09-16 21:22:11 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 881, Convergence with loss difference, Device: cuda
lambda is : 0.0006812920690579617, cost : 2.566 min
==========
Testing lambda: 0.001 starting at 2024-09-16 21:24:45 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 668, Convergence with loss difference, Device: cuda
lambda is : 0.0010000000000000002, cost : 2.532 min
==========
Testing lambda: 0.001468 starting at 2024-09-16 21:27:17 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 756, Convergence with loss difference, Device: cuda
lambda is : 0.0014677992676220694, cost : 2.326 min
==========
Testing lambda: 0.002154 starting at 2024-09-16 21:29:36 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 663, Convergence with loss difference, Device: cuda
lambda is : 0.0021544346900318843, cost : 2.072 min
==========
Testing lambda: 0.003162 starting at 2024-09-16 21:31:41 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 255, Convergence with loss difference, Device: cuda
lambda is : 0.003162277660168382, cost : 0.411 min
==========
Testing lambda: 0.004642 starting at 2024-09-16 21:32:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 209, Convergence with loss difference, Device: cuda
lambda is : 0.004641588833612781, cost : 0.176 min
==========
Testing lambda: 0.006813 starting at 2024-09-16 21:32:16 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 292, Convergence with loss difference, Device: cuda
lambda is : 0.006812920690579613, cost : 0.209 min
==========
Testing lambda: 0.01 starting at 2024-09-16 21:32:28 Max_iter: 1000
At iteration 363, Convergence with loss difference, Device: cuda
lambda is : 0.010000000000000004, cost : 0.23 min
==========
Testing lambda: 0.014678 starting at 2024-09-16 21:32:42 Max_iter: 1000
At iteration 362, Convergence with loss difference, Device: cuda
lambda is : 0.014677992676220709, cost : 0.232 min
==========
Testing lambda: 0.021544 starting at 2024-09-16 21:32:56 Max_iter: 1000
At iteration 342, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.02154434690031885, cost : 0.222 min
==========
Testing lambda: 0.031623 starting at 2024-09-16 21:33:10 Max_iter: 1000
At iteration 305, Convergence with loss difference, Device: cuda
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0316227766016838, cost : 0.203 min
==========
Testing lambda: 0.046416 starting at 2024-09-16 21:33:22 Max_iter: 1000
At iteration 254, Convergence with loss difference, Device: cuda
lambda is : 0.04641588833612786, cost : 0.168 min
==========
Testing lambda: 0.068129 starting at 2024-09-16 21:33:32 Max_iter: 1000
At iteration 242, Convergence with loss difference, Device: cuda
lambda is : 0.0681292069057962, cost : 0.159 min
==========
Testing lambda: 0.1 starting at 2024-09-16 21:33:41 Max_iter: 1000
At iteration 60, Convergence with loss difference, Device: cuda
lambda is : 0.10000000000000002, cost : 0.053 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC  ...       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.305592    0.274707          0.274059            8405  0.999990  ...  0.860855   0.743750  0.853047      0.114809       1.084067
0.000015    0.292430    0.278057          0.276151            8043  0.997729  ...  0.916588   0.848921  0.914729      0.117969       0.058707
0.000022    0.293885    0.281407          0.282427            8083  0.994135  ...  0.919944   0.855072  0.918288      0.135670       0.000349
0.000032    0.246910    0.329983          0.330544            6791  0.992040  ...  0.944499   0.900763  0.944000      0.100926       0.212423
0.000046    0.196444    0.371859          0.372385            5403  0.993091  ...  0.930235   0.874074  0.929134      0.102736       0.006206

[5 rows x 11 columns]
Exporting resultDF
Exporting result Dict
pDC Time elapsed: 35.57056103944778 minutes.
***** Finished lambda tuning
====================

nohup: ignoring input
Z-transformed rep_cells adata: (57515, 27504) <class 'numpy.ndarray'>
all cell types: ['ASDC', 'B_intermediate', 'B_memory', 'B_naive', 'CD14_Mono', 'CD16_Mono', 'CD4_CTL', 'CD4_Naive', 'CD4_Proliferating', 'CD4_TCM', 'CD4_TEM', 'CD8_Naive', 'CD8_Proliferating', 'CD8_TCM', 'CD8_TEM', 'Doublet', 'Eryth', 'HSPC', 'ILC', 'MAIT', 'NK', 'NK_CD56bright', 'NK_Proliferating', 'Plasmablast', 'Platelet', 'Treg', 'cDC1', 'cDC2', 'dnT', 'gdT', 'pDC']
====================
Queue ['ASDC', 'B_intermediate', 'B_memory', 'B_naive', 'CD14_Mono', 'CD16_Mono', 'CD4_CTL', 'CD4_Naive', 'CD4_Proliferating', 'CD4_TCM', 'CD4_TEM', 'CD8_Naive', 'CD8_Proliferating', 'CD8_TCM', 'CD8_TEM', 'Doublet', 'Eryth', 'HSPC', 'ILC', 'MAIT', 'NK', 'NK_CD56bright', 'NK_Proliferating', 'Plasmablast', 'Platelet', 'Treg', 'cDC1', 'cDC2', 'dnT', 'gdT', 'pDC']
====================
Subsetted raw count adata: (57515, 27504) <class 'anndata._core.views.SparseCSCView'>
***** Starting tuning
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for ASDC
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 09:39:21 Max_iter: 1000
At iteration 210, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  211 ; minimum lost =  0.6587273478507996 ; diff loss =  1.1920928955078125e-07 ; diff weight =  8.503203474674592e-08
lambda is : 9.999999999999997e-06, cost : 0.511 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 09:39:52 Max_iter: 1000
At iteration 208, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  209 ; minimum lost =  0.6616849899291992 ; diff loss =  7.748603820800781e-07 ; diff weight =  1.5044681731524179e-06
lambda is : 1.4677992676220687e-05, cost : 0.444 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 09:40:19 Max_iter: 1000
At iteration 207, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  208 ; minimum lost =  0.6649923324584961 ; diff loss =  3.5762786865234375e-07 ; diff weight =  6.901505571477173e-07
lambda is : 2.1544346900318854e-05, cost : 0.418 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 09:40:44 Max_iter: 1000
At iteration 207, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  208 ; minimum lost =  0.6682456135749817 ; diff loss =  3.5762786865234375e-07 ; diff weight =  2.197927528868604e-07
lambda is : 3.16227766016838e-05, cost : 0.401 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 09:41:08 Max_iter: 1000
At iteration 210, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  211 ; minimum lost =  0.6713415384292603 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.3702241946921276e-08
lambda is : 4.6415888336127784e-05, cost : 0.396 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 09:41:32 Max_iter: 1000
At iteration 203, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  204 ; minimum lost =  0.6744282245635986 ; diff loss =  8.940696716308594e-07 ; diff weight =  4.518048626778182e-06
lambda is : 6.81292069057961e-05, cost : 0.341 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 09:41:52 Max_iter: 1000
At iteration 188, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  189 ; minimum lost =  0.6775689125061035 ; diff loss =  1.7881393432617188e-07 ; diff weight =  6.394262186404376e-07
lambda is : 9.999999999999991e-05, cost : 0.317 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 09:42:11 Max_iter: 1000
At iteration 186, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  186 ; minimum lost =  0.6806704998016357 ; diff loss =  0.0 ; diff weight =  5.0047956392518245e-06
lambda is : 0.00014677992676220703, cost : 0.305 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 09:42:30 Max_iter: 1000
At iteration 180, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  181 ; minimum lost =  0.683656632900238 ; diff loss =  4.76837158203125e-07 ; diff weight =  7.429442234752059e-07
lambda is : 0.0002154434690031884, cost : 0.261 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 09:42:45 Max_iter: 1000
At iteration 175, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  176 ; minimum lost =  0.6863728165626526 ; diff loss =  6.556510925292969e-07 ; diff weight =  1.7102154288295424e-06
lambda is : 0.00031622776601683783, cost : 0.235 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 09:42:59 Max_iter: 1000
At iteration 167, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  168 ; minimum lost =  0.6885786056518555 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.74188857676927e-07
lambda is : 0.00046415888336127795, cost : 0.225 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 09:43:13 Max_iter: 1000
At iteration 164, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  164 ; minimum lost =  0.6901503801345825 ; diff loss =  0.0 ; diff weight =  2.5931053642125335e-06
lambda is : 0.0006812920690579617, cost : 0.209 min
==========
Testing lambda: 0.001 starting at 2024-09-27 09:43:25 Max_iter: 1000
At iteration 178, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  179 ; minimum lost =  0.6912702322006226 ; diff loss =  1.1920928955078125e-07 ; diff weight =  5.364807407204353e-07
lambda is : 0.0010000000000000002, cost : 0.184 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 09:43:36 Max_iter: 1000
At iteration 147, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  148 ; minimum lost =  0.6921470761299133 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003464130568318069
lambda is : 0.0014677992676220694, cost : 0.106 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 09:43:43 Max_iter: 1000
At iteration 132, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  133 ; minimum lost =  0.6924424171447754 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00031980834319256246
lambda is : 0.0021544346900318843, cost : 0.097 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 09:43:49 Max_iter: 1000
At iteration 107, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  108 ; minimum lost =  0.6926047801971436 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003170399577356875
lambda is : 0.003162277660168382, cost : 0.083 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 09:43:54 Max_iter: 1000
At iteration 86, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  87 ; minimum lost =  0.6927492022514343 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00033712713047862053
lambda is : 0.004641588833612781, cost : 0.071 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 09:43:58 Max_iter: 1000
At iteration 60, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  61 ; minimum lost =  0.6929007768630981 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003178309416398406
lambda is : 0.006812920690579613, cost : 0.054 min
==========
Testing lambda: 0.01 starting at 2024-09-27 09:44:01 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931464672088623 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0005912607302889228
lambda is : 0.010000000000000004, cost : 0.018 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 09:44:02 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931469440460205 ; diff loss =  4.172325134277344e-07 ; diff weight =  0.00019551580771803856
lambda is : 0.014677992676220709, cost : 0.017 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 09:44:03 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.02154434690031885, cost : 0.016 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 09:44:04 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.016 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 09:44:05 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.016 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 09:44:06 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-27 09:44:07 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.414849    0.210526          0.209677           11410  0.994622  0.839995  0.692518   0.611111  0.687500      0.658727   8.503203e-08
0.000015    0.395106    0.236842          0.225806           10867  0.996910  0.829811  0.674002   0.578947  0.666667      0.661685   1.504468e-06
0.000022    0.370492    0.250000          0.258065           10190  0.997264  0.831496  0.692518   0.611111  0.687500      0.664992   6.901506e-07
0.000032    0.343332    0.289474          0.274194            9443  0.994970  0.807418  0.758769   0.733333  0.758621      0.668246   2.197928e-07
0.000046    0.310500    0.315789          0.306452            8540  0.999496  0.889628  0.827862   0.800000  0.827586      0.671342   2.370224e-08
Exporting resultDF
Exporting result Dict
ASDC Time elapsed: 4.9069857160250345 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for B_intermediate
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 09:44:39 Max_iter: 1000
At iteration 360, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  361 ; minimum lost =  0.5942186713218689 ; diff loss =  1.1920928955078125e-07 ; diff weight =  5.594333885028391e-08
lambda is : 9.999999999999997e-06, cost : 0.587 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 09:45:14 Max_iter: 1000
At iteration 372, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  373 ; minimum lost =  0.5995104312896729 ; diff loss =  1.7881393432617188e-07 ; diff weight =  9.83780637398013e-07
lambda is : 1.4677992676220687e-05, cost : 0.532 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 09:45:46 Max_iter: 1000
At iteration 368, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  369 ; minimum lost =  0.6049079895019531 ; diff loss =  4.172325134277344e-07 ; diff weight =  0.0047777979634702206
lambda is : 2.1544346900318854e-05, cost : 0.475 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 09:46:15 Max_iter: 1000
At iteration 352, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  353 ; minimum lost =  0.6102731227874756 ; diff loss =  3.5762786865234375e-07 ; diff weight =  0.004361053463071585
lambda is : 3.16227766016838e-05, cost : 0.451 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 09:46:42 Max_iter: 1000
At iteration 345, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  346 ; minimum lost =  0.6155667901039124 ; diff loss =  3.5762786865234375e-07 ; diff weight =  0.0034071996342390776
lambda is : 4.6415888336127784e-05, cost : 0.426 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 09:47:07 Max_iter: 1000
At iteration 341, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  341 ; minimum lost =  0.6210571527481079 ; diff loss =  -2.384185791015625e-07 ; diff weight =  0.003968390636146069
lambda is : 6.81292069057961e-05, cost : 0.392 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 09:47:31 Max_iter: 1000
At iteration 341, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  342 ; minimum lost =  0.6263407468795776 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.9887683322394878e-07
lambda is : 9.999999999999991e-05, cost : 0.395 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 09:47:55 Max_iter: 1000
At iteration 332, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  332 ; minimum lost =  0.6317481994628906 ; diff loss =  0.0 ; diff weight =  6.9354468905657995e-06
lambda is : 0.00014677992676220703, cost : 0.363 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 09:48:16 Max_iter: 1000
At iteration 319, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  320 ; minimum lost =  0.6369590163230896 ; diff loss =  3.5762786865234375e-07 ; diff weight =  7.960866241774056e-07
lambda is : 0.0002154434690031884, cost : 0.328 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 09:48:36 Max_iter: 1000
At iteration 312, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  312 ; minimum lost =  0.6419432759284973 ; diff loss =  0.0 ; diff weight =  1.2174997721103864e-07
lambda is : 0.00031622776601683783, cost : 0.323 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 09:48:55 Max_iter: 1000
At iteration 306, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  307 ; minimum lost =  0.6467549800872803 ; diff loss =  8.940696716308594e-07 ; diff weight =  1.6527370462426916e-05
lambda is : 0.00046415888336127795, cost : 0.267 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 09:49:12 Max_iter: 1000
At iteration 318, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  318 ; minimum lost =  0.6516233086585999 ; diff loss =  0.0 ; diff weight =  6.500391009467421e-06
lambda is : 0.0006812920690579617, cost : 0.287 min
==========
Testing lambda: 0.001 starting at 2024-09-27 09:49:29 Max_iter: 1000
At iteration 375, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  376 ; minimum lost =  0.6570044159889221 ; diff loss =  2.980232238769531e-07 ; diff weight =  0.0036519006825983524
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.273 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 09:49:45 Max_iter: 1000
At iteration 298, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  299 ; minimum lost =  0.6622437238693237 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0007597749354317784
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.208 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 09:49:58 Max_iter: 1000
At iteration 286, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  287 ; minimum lost =  0.6669466495513916 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006423560553230345
lambda is : 0.0021544346900318843, cost : 0.193 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 09:50:09 Max_iter: 1000
At iteration 284, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  285 ; minimum lost =  0.6710031032562256 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006288053118623793
lambda is : 0.003162277660168382, cost : 0.187 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 09:50:20 Max_iter: 1000
At iteration 276, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  277 ; minimum lost =  0.6744071245193481 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005604104371741414
lambda is : 0.004641588833612781, cost : 0.18 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 09:50:31 Max_iter: 1000
At iteration 260, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  261 ; minimum lost =  0.6773885488510132 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004800584865733981
lambda is : 0.006812920690579613, cost : 0.173 min
==========
Testing lambda: 0.01 starting at 2024-09-27 09:50:42 Max_iter: 1000
At iteration 242, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  243 ; minimum lost =  0.6804426312446594 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004277472908142954
lambda is : 0.010000000000000004, cost : 0.16 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 09:50:51 Max_iter: 1000
At iteration 226, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  227 ; minimum lost =  0.6837828159332275 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00022798647114541382
lambda is : 0.014677992676220709, cost : 0.15 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 09:51:00 Max_iter: 1000
At iteration 244, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  245 ; minimum lost =  0.687171995639801 ; diff loss =  6.556510925292969e-07 ; diff weight =  0.00030601402977481484
lambda is : 0.02154434690031885, cost : 0.161 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 09:51:10 Max_iter: 1000
At iteration 163, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  164 ; minimum lost =  0.6900584101676941 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.0006378553225658834
lambda is : 0.0316227766016838, cost : 0.113 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 09:51:17 Max_iter: 1000
At iteration 105, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  106 ; minimum lost =  0.6921066641807556 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0001593071938259527
lambda is : 0.04641588833612786, cost : 0.081 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 09:51:21 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931471824645996 ; diff loss =  1.7881393432617188e-07 ; diff weight =  0.00020675711857620627
lambda is : 0.0681292069057962, cost : 0.018 min
==========
Testing lambda: 0.1 starting at 2024-09-27 09:51:23 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.390380    0.128018          0.126043           10737  0.972459  0.861952  0.783686   0.738602  0.787682      0.594219   5.594334e-08
0.000015    0.360675    0.141917          0.140871            9920  0.975242  0.863310  0.790582   0.763578  0.795341      0.599510   9.837806e-07
0.000022    0.327480    0.156547          0.154773            9007  0.979144  0.867999  0.798455   0.784768  0.803390      0.604908   4.777798e-03
0.000032    0.294539    0.175567          0.173309            8101  0.980626  0.864901  0.800500   0.791946  0.805461      0.610273   4.361053e-03
0.000046    0.261380    0.196781          0.193698            7189  0.976372  0.861812  0.806896   0.807560  0.811744      0.615567   3.407200e-03
Exporting resultDF
Exporting result Dict
B_intermediate Time elapsed: 6.869990233580271 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for B_memory
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 09:51:54 Max_iter: 1000
At iteration 156, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  157 ; minimum lost =  0.5357682704925537 ; diff loss =  1.7881393432617188e-07 ; diff weight =  1.2767243617872737e-07
lambda is : 9.999999999999997e-06, cost : 0.462 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 09:52:22 Max_iter: 1000
At iteration 158, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  159 ; minimum lost =  0.5387449264526367 ; diff loss =  6.556510925292969e-07 ; diff weight =  5.692818376701325e-07
lambda is : 1.4677992676220687e-05, cost : 0.446 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 09:52:49 Max_iter: 1000
At iteration 160, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  161 ; minimum lost =  0.5431247353553772 ; diff loss =  1.1920928955078125e-07 ; diff weight =  7.550672620482146e-08
lambda is : 2.1544346900318854e-05, cost : 0.421 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 09:53:14 Max_iter: 1000
At iteration 160, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  161 ; minimum lost =  0.5472044348716736 ; diff loss =  2.980232238769531e-07 ; diff weight =  1.6411276249073126e-07
lambda is : 3.16227766016838e-05, cost : 0.405 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 09:53:38 Max_iter: 1000
At iteration 160, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  160 ; minimum lost =  0.551868200302124 ; diff loss =  0.0 ; diff weight =  9.957226438928046e-07
lambda is : 4.6415888336127784e-05, cost : 0.379 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 09:54:01 Max_iter: 1000
At iteration 157, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  157 ; minimum lost =  0.555651068687439 ; diff loss =  0.0 ; diff weight =  7.588928383484017e-07
lambda is : 6.81292069057961e-05, cost : 0.341 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 09:54:21 Max_iter: 1000
At iteration 157, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  158 ; minimum lost =  0.5607267618179321 ; diff loss =  2.980232238769531e-07 ; diff weight =  6.748538083911626e-08
lambda is : 9.999999999999991e-05, cost : 0.301 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 09:54:40 Max_iter: 1000
At iteration 153, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  154 ; minimum lost =  0.5654816627502441 ; diff loss =  2.384185791015625e-07 ; diff weight =  8.836268960976668e-08
lambda is : 0.00014677992676220703, cost : 0.276 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 09:54:56 Max_iter: 1000
At iteration 159, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  160 ; minimum lost =  0.570743978023529 ; diff loss =  1.7881393432617188e-07 ; diff weight =  1.842369243831854e-07
lambda is : 0.0002154434690031884, cost : 0.251 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 09:55:11 Max_iter: 1000
At iteration 156, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  157 ; minimum lost =  0.5756207704544067 ; diff loss =  6.556510925292969e-07 ; diff weight =  7.056932531668281e-07
lambda is : 0.00031622776601683783, cost : 0.22 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 09:55:24 Max_iter: 1000
At iteration 156, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  157 ; minimum lost =  0.5820372104644775 ; diff loss =  3.5762786865234375e-07 ; diff weight =  4.076991331203317e-07
lambda is : 0.00046415888336127795, cost : 0.199 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 09:55:36 Max_iter: 1000
At iteration 156, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  157 ; minimum lost =  0.5889863967895508 ; diff loss =  2.384185791015625e-07 ; diff weight =  7.074891783531712e-08
lambda is : 0.0006812920690579617, cost : 0.186 min
==========
Testing lambda: 0.001 starting at 2024-09-27 09:55:48 Max_iter: 1000
At iteration 160, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  161 ; minimum lost =  0.5963663458824158 ; diff loss =  2.384185791015625e-07 ; diff weight =  4.627650440625075e-08
lambda is : 0.0010000000000000002, cost : 0.178 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 09:55:58 Max_iter: 1000
At iteration 165, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  166 ; minimum lost =  0.6044583916664124 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.2978435393051768e-07
lambda is : 0.0014677992676220694, cost : 0.179 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 09:56:09 Max_iter: 1000
At iteration 173, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  173 ; minimum lost =  0.6129326224327087 ; diff loss =  0.0 ; diff weight =  4.113524596505158e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.179 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 09:56:20 Max_iter: 1000
At iteration 186, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  187 ; minimum lost =  0.6219401359558105 ; diff loss =  6.556510925292969e-07 ; diff weight =  1.379715740768006e-06
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.157 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 09:56:29 Max_iter: 1000
At iteration 213, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  214 ; minimum lost =  0.6327695846557617 ; diff loss =  4.76837158203125e-07 ; diff weight =  2.266435359388197e-07
lambda is : 0.004641588833612781, cost : 0.18 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 09:56:40 Max_iter: 1000
At iteration 284, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  284 ; minimum lost =  0.6457383036613464 ; diff loss =  0.0 ; diff weight =  0.0024209877010434866
lambda is : 0.006812920690579613, cost : 0.185 min
==========
Testing lambda: 0.01 starting at 2024-09-27 09:56:51 Max_iter: 1000
At iteration 322, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  323 ; minimum lost =  0.6602866053581238 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0012552144471555948
lambda is : 0.010000000000000004, cost : 0.207 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 09:57:03 Max_iter: 1000
At iteration 261, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  262 ; minimum lost =  0.6715883612632751 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006149056716822088
lambda is : 0.014677992676220709, cost : 0.17 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 09:57:14 Max_iter: 1000
At iteration 210, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  211 ; minimum lost =  0.6799900531768799 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00043525229557417333
lambda is : 0.02154434690031885, cost : 0.141 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 09:57:22 Max_iter: 1000
At iteration 223, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  224 ; minimum lost =  0.6862269043922424 ; diff loss =  4.76837158203125e-07 ; diff weight =  0.0001382199116051197
lambda is : 0.0316227766016838, cost : 0.149 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 09:57:31 Max_iter: 1000
At iteration 213, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  214 ; minimum lost =  0.690605103969574 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.00014403471141122282
lambda is : 0.04641588833612786, cost : 0.143 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 09:57:40 Max_iter: 1000
At iteration 78, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  79 ; minimum lost =  0.6929087042808533 ; diff loss =  6.556510925292969e-07 ; diff weight =  0.00028662383556365967
lambda is : 0.0681292069057962, cost : 0.065 min
==========
Testing lambda: 0.1 starting at 2024-09-27 09:57:44 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.398706    0.116144          0.115413           10966  0.997758  0.958415  0.888970   0.839161  0.891089      0.535768   1.276724e-07
0.000015    0.367437    0.130662          0.129933           10106  0.998494  0.965413  0.901443   0.852459  0.903226      0.538745   5.692818e-07
0.000022    0.335878    0.145180          0.144080            9238  0.997821  0.964348  0.907424   0.868106  0.909548      0.543125   7.550673e-08
0.000032    0.309373    0.160859          0.160089            8509  0.998123  0.965509  0.905611   0.869565  0.907945      0.547204   1.641128e-07
0.000046    0.270761    0.181765          0.180194            7447  0.998435  0.969176  0.912217   0.884236  0.914650      0.551868   9.957226e-07
Exporting resultDF
Exporting result Dict
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_lossdiff.py:949: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, ax1 = plt.subplots(figsize = (fig_width,fig_height))
B_memory Time elapsed: 5.971107590198517 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for B_naive
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 09:58:16 Max_iter: 1000
At iteration 164, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  165 ; minimum lost =  0.3606833219528198 ; diff loss =  5.960464477539063e-08 ; diff weight =  5.126177171632662e-08
lambda is : 9.999999999999997e-06, cost : 0.502 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 09:58:46 Max_iter: 1000
At iteration 156, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  157 ; minimum lost =  0.3682272732257843 ; diff loss =  8.940696716308594e-08 ; diff weight =  4.60285214387568e-08
lambda is : 1.4677992676220687e-05, cost : 0.468 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 09:59:14 Max_iter: 1000
At iteration 156, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  157 ; minimum lost =  0.3703185021877289 ; diff loss =  2.086162567138672e-07 ; diff weight =  5.0869587653323833e-08
lambda is : 2.1544346900318854e-05, cost : 0.426 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 09:59:40 Max_iter: 1000
At iteration 154, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  155 ; minimum lost =  0.375953733921051 ; diff loss =  8.940696716308594e-08 ; diff weight =  3.040530494047289e-09
lambda is : 3.16227766016838e-05, cost : 0.405 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 10:00:04 Max_iter: 1000
At iteration 150, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  151 ; minimum lost =  0.3827115297317505 ; diff loss =  1.4901161193847656e-07 ; diff weight =  6.027397603247664e-08
lambda is : 4.6415888336127784e-05, cost : 0.372 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 10:00:26 Max_iter: 1000
At iteration 154, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  155 ; minimum lost =  0.38593795895576477 ; diff loss =  2.682209014892578e-07 ; diff weight =  1.1084507178793501e-07
lambda is : 6.81292069057961e-05, cost : 0.361 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 10:00:48 Max_iter: 1000
At iteration 150, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  151 ; minimum lost =  0.3903543949127197 ; diff loss =  2.384185791015625e-07 ; diff weight =  9.978828785506266e-08
lambda is : 9.999999999999991e-05, cost : 0.31 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 10:01:06 Max_iter: 1000
At iteration 150, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  151 ; minimum lost =  0.39625436067581177 ; diff loss =  3.8743019104003906e-07 ; diff weight =  8.801261230928503e-08
lambda is : 0.00014677992676220703, cost : 0.283 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 10:01:23 Max_iter: 1000
At iteration 148, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  149 ; minimum lost =  0.40290459990501404 ; diff loss =  8.940696716308594e-08 ; diff weight =  6.6767418260837985e-09
lambda is : 0.0002154434690031884, cost : 0.274 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 10:01:40 Max_iter: 1000
At iteration 140, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  141 ; minimum lost =  0.4160939157009125 ; diff loss =  8.940696716308594e-08 ; diff weight =  1.8108051946796877e-08
lambda is : 0.00031622776601683783, cost : 0.245 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 10:01:55 Max_iter: 1000
At iteration 143, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  141 ; minimum lost =  0.4194585680961609 ; diff loss =  0.0 ; diff weight =  0.021201802417635918
lambda is : 0.00046415888336127795, cost : 0.218 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 10:02:08 Max_iter: 1000
At iteration 142, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  143 ; minimum lost =  0.4280702769756317 ; diff loss =  8.940696716308594e-07 ; diff weight =  1.8095052212174778e-07
lambda is : 0.0006812920690579617, cost : 0.187 min
==========
Testing lambda: 0.001 starting at 2024-09-27 10:02:19 Max_iter: 1000
At iteration 144, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  145 ; minimum lost =  0.43541616201400757 ; diff loss =  8.940696716308594e-08 ; diff weight =  3.0712097753848866e-08
lambda is : 0.0010000000000000002, cost : 0.198 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 10:02:31 Max_iter: 1000
At iteration 144, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  145 ; minimum lost =  0.44626742601394653 ; diff loss =  2.9802322387695312e-08 ; diff weight =  3.768559153627393e-08
lambda is : 0.0014677992676220694, cost : 0.178 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 10:02:42 Max_iter: 1000
At iteration 134, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  135 ; minimum lost =  0.4747982621192932 ; diff loss =  3.5762786865234375e-07 ; diff weight =  1.1287603740584018e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.165 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 10:02:51 Max_iter: 1000
At iteration 143, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  144 ; minimum lost =  0.4841495454311371 ; diff loss =  2.9802322387695312e-08 ; diff weight =  3.2381862524744065e-08
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.178 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 10:03:02 Max_iter: 1000
At iteration 153, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  154 ; minimum lost =  0.4953078031539917 ; diff loss =  2.682209014892578e-07 ; diff weight =  6.054169432445633e-08
lambda is : 0.004641588833612781, cost : 0.164 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 10:03:12 Max_iter: 1000
At iteration 170, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  171 ; minimum lost =  0.5049036741256714 ; diff loss =  1.1920928955078125e-07 ; diff weight =  9.974736769891024e-08
lambda is : 0.006812920690579613, cost : 0.175 min
==========
Testing lambda: 0.01 starting at 2024-09-27 10:03:22 Max_iter: 1000
At iteration 186, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  187 ; minimum lost =  0.511560320854187 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.110639816370167e-08
lambda is : 0.010000000000000004, cost : 0.179 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 10:03:33 Max_iter: 1000
At iteration 208, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  209 ; minimum lost =  0.5246288776397705 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.0576093245617812e-06
lambda is : 0.014677992676220709, cost : 0.176 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 10:03:44 Max_iter: 1000
At iteration 218, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  219 ; minimum lost =  0.5514630675315857 ; diff loss =  7.748603820800781e-07 ; diff weight =  1.968636524907197e-06
lambda is : 0.02154434690031885, cost : 0.176 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 10:03:54 Max_iter: 1000
At iteration 320, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  320 ; minimum lost =  0.5808533430099487 ; diff loss =  0.0 ; diff weight =  0.0020947495941072702
lambda is : 0.0316227766016838, cost : 0.207 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 10:04:07 Max_iter: 1000
At iteration 328, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  329 ; minimum lost =  0.6188194155693054 ; diff loss =  6.556510925292969e-07 ; diff weight =  0.0007245956221595407
lambda is : 0.04641588833612786, cost : 0.211 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 10:04:19 Max_iter: 1000
At iteration 294, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  295 ; minimum lost =  0.6504784226417542 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0007490637945011258
lambda is : 0.0681292069057962, cost : 0.191 min
==========
Testing lambda: 0.1 starting at 2024-09-27 10:04:31 Max_iter: 1000
At iteration 275, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  276 ; minimum lost =  0.6738448143005371 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0007294961251318455
lambda is : 0.10000000000000002, cost : 0.184 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.385580    0.104296          0.104792           10605  0.994169  0.978537  0.924120   0.881285  0.927259      0.360683   5.126177e-08
0.000015    0.358202    0.115504          0.116089            9852  0.994070  0.978962  0.939798   0.908046  0.942580      0.368227   4.602852e-08
0.000022    0.324825    0.129514          0.130113            8934  0.994673  0.978852  0.938933   0.907914  0.941791      0.370319   5.086959e-08
0.000032    0.293048    0.145081          0.146085            8060  0.995380  0.982479  0.943287   0.915820  0.946027      0.375954   3.040530e-09
0.000046    0.255999    0.165629          0.165563            7041  0.996455  0.985996  0.949064   0.927835  0.951662      0.382712   6.027398e-08
Exporting resultDF
Exporting result Dict
B_naive Time elapsed: 6.56931668917338 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD14_Mono
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 10:05:13 Max_iter: 1000
At iteration 122, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  123 ; minimum lost =  0.19823352992534637 ; diff loss =  5.960464477539062e-07 ; diff weight =  1.1144298639464978e-07
lambda is : 9.999999999999997e-06, cost : 0.534 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 10:05:45 Max_iter: 1000
At iteration 122, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  123 ; minimum lost =  0.19900831580162048 ; diff loss =  4.172325134277344e-07 ; diff weight =  2.42057467403356e-08
lambda is : 1.4677992676220687e-05, cost : 0.496 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 10:06:15 Max_iter: 1000
At iteration 123, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  124 ; minimum lost =  0.20006173849105835 ; diff loss =  4.917383193969727e-07 ; diff weight =  8.206858836956599e-08
lambda is : 2.1544346900318854e-05, cost : 0.472 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 10:06:43 Max_iter: 1000
At iteration 124, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  124 ; minimum lost =  0.20055903494358063 ; diff loss =  0.0 ; diff weight =  5.579820694379123e-08
lambda is : 3.16227766016838e-05, cost : 0.429 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 10:07:09 Max_iter: 1000
At iteration 124, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  125 ; minimum lost =  0.20160330832004547 ; diff loss =  3.725290298461914e-07 ; diff weight =  3.784988678035006e-08
lambda is : 4.6415888336127784e-05, cost : 0.436 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 10:07:35 Max_iter: 1000
At iteration 125, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  125 ; minimum lost =  0.20189878344535828 ; diff loss =  0.0 ; diff weight =  3.927779346213356e-08
lambda is : 6.81292069057961e-05, cost : 0.405 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 10:08:00 Max_iter: 1000
At iteration 127, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  128 ; minimum lost =  0.20233669877052307 ; diff loss =  2.086162567138672e-07 ; diff weight =  5.439615335944836e-08
lambda is : 9.999999999999991e-05, cost : 0.391 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 10:08:23 Max_iter: 1000
At iteration 129, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  130 ; minimum lost =  0.20269495248794556 ; diff loss =  7.599592208862305e-07 ; diff weight =  2.0860751348550366e-08
lambda is : 0.00014677992676220703, cost : 0.358 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 10:08:45 Max_iter: 1000
At iteration 129, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  130 ; minimum lost =  0.2067476511001587 ; diff loss =  9.238719940185547e-07 ; diff weight =  6.531184482128083e-08
lambda is : 0.0002154434690031884, cost : 0.337 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 10:09:05 Max_iter: 1000
At iteration 130, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  131 ; minimum lost =  0.21128952503204346 ; diff loss =  5.960464477539062e-07 ; diff weight =  6.095212512491344e-08
lambda is : 0.00031622776601683783, cost : 0.303 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 10:09:23 Max_iter: 1000
At iteration 132, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  133 ; minimum lost =  0.21711525321006775 ; diff loss =  4.470348358154297e-08 ; diff weight =  7.187137107678154e-09
lambda is : 0.00046415888336127795, cost : 0.31 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 10:09:42 Max_iter: 1000
At iteration 133, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  134 ; minimum lost =  0.222966730594635 ; diff loss =  4.76837158203125e-07 ; diff weight =  3.461817854599758e-08
lambda is : 0.0006812920690579617, cost : 0.274 min
==========
Testing lambda: 0.001 starting at 2024-09-27 10:09:58 Max_iter: 1000
At iteration 135, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  136 ; minimum lost =  0.22998622059822083 ; diff loss =  5.662441253662109e-07 ; diff weight =  2.0757934748871776e-07
lambda is : 0.0010000000000000002, cost : 0.25 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 10:10:13 Max_iter: 1000
At iteration 137, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  138 ; minimum lost =  0.2389916181564331 ; diff loss =  4.6193599700927734e-07 ; diff weight =  3.8058036722077304e-08
lambda is : 0.0014677992676220694, cost : 0.243 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 10:10:28 Max_iter: 1000
At iteration 141, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  142 ; minimum lost =  0.2502237558364868 ; diff loss =  3.2782554626464844e-07 ; diff weight =  8.148487751213906e-08
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.231 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 10:10:41 Max_iter: 1000
At iteration 148, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  148 ; minimum lost =  0.26372894644737244 ; diff loss =  0.0 ; diff weight =  1.6157386539816798e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.228 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 10:10:55 Max_iter: 1000
At iteration 158, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  159 ; minimum lost =  0.2775462865829468 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.2074592698782e-08
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 0.197 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 10:11:07 Max_iter: 1000
At iteration 179, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  180 ; minimum lost =  0.2932201027870178 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.665396259260433e-08
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.006812920690579613, cost : 0.188 min
==========
Testing lambda: 0.01 starting at 2024-09-27 10:11:18 Max_iter: 1000
At iteration 201, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  202 ; minimum lost =  0.3138720393180847 ; diff loss =  6.854534149169922e-07 ; diff weight =  7.269636057571915e-07
lambda is : 0.010000000000000004, cost : 0.18 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 10:11:29 Max_iter: 1000
At iteration 338, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  339 ; minimum lost =  0.33034640550613403 ; diff loss =  5.960464477539062e-07 ; diff weight =  0.0007282767328433692
lambda is : 0.014677992676220709, cost : 0.219 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 10:11:42 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  341 ; minimum lost =  0.3687226176261902 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006445815670304
lambda is : 0.02154434690031885, cost : 0.219 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 10:11:55 Max_iter: 1000
At iteration 409, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  410 ; minimum lost =  0.4124515652656555 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.000599040009547025
lambda is : 0.0316227766016838, cost : 0.262 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 10:12:11 Max_iter: 1000
At iteration 344, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  345 ; minimum lost =  0.4639010429382324 ; diff loss =  7.152557373046875e-07 ; diff weight =  0.0009221062646247447
lambda is : 0.04641588833612786, cost : 0.225 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 10:12:24 Max_iter: 1000
At iteration 353, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  354 ; minimum lost =  0.5217257738113403 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.000702533929143101
lambda is : 0.0681292069057962, cost : 0.228 min
==========
Testing lambda: 0.1 starting at 2024-09-27 10:12:38 Max_iter: 1000
At iteration 421, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  422 ; minimum lost =  0.5797750353813171 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005808697314932942
lambda is : 0.10000000000000002, cost : 0.266 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.423138    0.158819          0.158893           11638  0.994107  0.979833  0.927171   0.904636  0.937995      0.198234   1.114430e-07
0.000015    0.402705    0.172757          0.172841           11076  0.994026  0.979584  0.922573   0.898794  0.934060      0.199008   2.420575e-08
0.000022    0.382599    0.185641          0.186716           10523  0.993777  0.978865  0.926403   0.904963  0.937380      0.200062   8.206859e-08
0.000032    0.357766    0.204615          0.204280            9840  0.993388  0.978041  0.921676   0.899947  0.933370      0.200559   5.579821e-08
0.000046    0.331515    0.225814          0.226716            9118  0.994095  0.978653  0.932968   0.918774  0.943125      0.201603   3.784989e-08
Exporting resultDF
Exporting result Dict
CD14_Mono Time elapsed: 7.817072073618571 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD16_Mono
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 10:13:25 Max_iter: 1000
At iteration 129, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  130 ; minimum lost =  0.47304803133010864 ; diff loss =  3.5762786865234375e-07 ; diff weight =  1.0495977420532654e-07
lambda is : 9.999999999999997e-06, cost : 0.498 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 10:13:55 Max_iter: 1000
At iteration 129, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  130 ; minimum lost =  0.47470220923423767 ; diff loss =  2.9802322387695312e-08 ; diff weight =  1.7840720900608176e-08
lambda is : 1.4677992676220687e-05, cost : 0.491 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 10:14:25 Max_iter: 1000
At iteration 129, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  130 ; minimum lost =  0.4765383303165436 ; diff loss =  8.940696716308594e-08 ; diff weight =  2.3923764302935524e-08
lambda is : 2.1544346900318854e-05, cost : 0.479 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 10:14:53 Max_iter: 1000
At iteration 129, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  130 ; minimum lost =  0.47888627648353577 ; diff loss =  8.940696716308594e-08 ; diff weight =  5.354351184649886e-09
lambda is : 3.16227766016838e-05, cost : 0.451 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 10:15:21 Max_iter: 1000
At iteration 129, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  130 ; minimum lost =  0.4810023307800293 ; diff loss =  2.9802322387695312e-08 ; diff weight =  6.692658427454035e-09
lambda is : 4.6415888336127784e-05, cost : 0.424 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 10:15:46 Max_iter: 1000
At iteration 129, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  130 ; minimum lost =  0.4838973581790924 ; diff loss =  5.662441253662109e-07 ; diff weight =  2.0457495963910333e-07
lambda is : 6.81292069057961e-05, cost : 0.377 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 10:16:09 Max_iter: 1000
At iteration 129, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  130 ; minimum lost =  0.4873408079147339 ; diff loss =  8.940696716308594e-08 ; diff weight =  1.3803824749913929e-08
lambda is : 9.999999999999991e-05, cost : 0.375 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 10:16:31 Max_iter: 1000
At iteration 128, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  129 ; minimum lost =  0.4911889135837555 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.002344589551285e-07
lambda is : 0.00014677992676220703, cost : 0.332 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 10:16:51 Max_iter: 1000
At iteration 128, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  129 ; minimum lost =  0.49573901295661926 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.697676970697671e-09
lambda is : 0.0002154434690031884, cost : 0.318 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 10:17:10 Max_iter: 1000
At iteration 128, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  129 ; minimum lost =  0.5005437731742859 ; diff loss =  3.5762786865234375e-07 ; diff weight =  5.5192376891000094e-08
lambda is : 0.00031622776601683783, cost : 0.292 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 10:17:28 Max_iter: 1000
At iteration 129, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  129 ; minimum lost =  0.505867063999176 ; diff loss =  0.0 ; diff weight =  2.304002180153475e-07
lambda is : 0.00046415888336127795, cost : 0.275 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 10:17:44 Max_iter: 1000
At iteration 128, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  129 ; minimum lost =  0.5116947293281555 ; diff loss =  9.5367431640625e-07 ; diff weight =  3.680073064060707e-07
lambda is : 0.0006812920690579617, cost : 0.22 min
==========
Testing lambda: 0.001 starting at 2024-09-27 10:17:57 Max_iter: 1000
At iteration 131, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  132 ; minimum lost =  0.5178263187408447 ; diff loss =  4.76837158203125e-07 ; diff weight =  2.2253578535469387e-08
lambda is : 0.0010000000000000002, cost : 0.212 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 10:18:10 Max_iter: 1000
At iteration 134, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  135 ; minimum lost =  0.5261951684951782 ; diff loss =  4.172325134277344e-07 ; diff weight =  7.54705382632892e-08
lambda is : 0.0014677992676220694, cost : 0.204 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 10:18:22 Max_iter: 1000
At iteration 137, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  137 ; minimum lost =  0.535763680934906 ; diff loss =  0.0 ; diff weight =  2.900190736454533e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.212 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 10:18:35 Max_iter: 1000
At iteration 143, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  144 ; minimum lost =  0.5461157560348511 ; diff loss =  8.940696716308594e-07 ; diff weight =  1.988890062420978e-06
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.171 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 10:18:45 Max_iter: 1000
At iteration 155, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  156 ; minimum lost =  0.5572961568832397 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.015617622281752e-08
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 0.18 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 10:18:56 Max_iter: 1000
At iteration 176, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  177 ; minimum lost =  0.568585991859436 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.7464114421272825e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.006812920690579613, cost : 0.169 min
==========
Testing lambda: 0.01 starting at 2024-09-27 10:19:06 Max_iter: 1000
At iteration 224, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  225 ; minimum lost =  0.5796061754226685 ; diff loss =  5.364418029785156e-07 ; diff weight =  4.283486305212136e-06
lambda is : 0.010000000000000004, cost : 0.176 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 10:19:17 Max_iter: 1000
At iteration 333, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  333 ; minimum lost =  0.5951920747756958 ; diff loss =  -1.7881393432617188e-07 ; diff weight =  0.0019255230436101556
lambda is : 0.014677992676220709, cost : 0.215 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 10:19:30 Max_iter: 1000
At iteration 344, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  345 ; minimum lost =  0.6158595085144043 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0011664407793432474
lambda is : 0.02154434690031885, cost : 0.218 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 10:19:43 Max_iter: 1000
At iteration 334, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  335 ; minimum lost =  0.6370447874069214 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0008282846538349986
lambda is : 0.0316227766016838, cost : 0.213 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 10:19:56 Max_iter: 1000
At iteration 299, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  300 ; minimum lost =  0.6569744944572449 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006515325512737036
lambda is : 0.04641588833612786, cost : 0.192 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 10:20:07 Max_iter: 1000
At iteration 283, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  284 ; minimum lost =  0.6741377711296082 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004981004749424756
lambda is : 0.0681292069057962, cost : 0.183 min
==========
Testing lambda: 0.1 starting at 2024-09-27 10:20:18 Max_iter: 1000
At iteration 222, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  223 ; minimum lost =  0.6874472498893738 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.0004383716150186956
lambda is : 0.10000000000000002, cost : 0.148 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.413213    0.182079          0.181899           11365  0.992425  0.929314  0.862959   0.837370  0.868941      0.473048   1.049598e-07
0.000015    0.391289    0.200896          0.199645           10762  0.991254  0.930892  0.869923   0.851852  0.875793      0.474702   1.784072e-08
0.000022    0.366019    0.222222          0.222272           10067  0.993141  0.937005  0.869424   0.844021  0.875112      0.476538   2.392376e-08
0.000032    0.339769    0.243728          0.243123            9345  0.993045  0.931778  0.869711   0.842832  0.875336      0.478886   5.354351e-09
0.000046    0.312682    0.268459          0.268412            8600  0.991957  0.932923  0.881683   0.866548  0.887067      0.481002   6.692658e-09
Exporting resultDF
Exporting result Dict
CD16_Mono Time elapsed: 7.160609479745229 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_CTL
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 10:20:58 Max_iter: 1000
At iteration 377, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  378 ; minimum lost =  0.645165741443634 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005827407585456967
lambda is : 9.999999999999997e-06, cost : 0.478 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 10:21:27 Max_iter: 1000
At iteration 370, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  371 ; minimum lost =  0.6488717198371887 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0007696969551034272
lambda is : 1.4677992676220687e-05, cost : 0.46 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 10:21:54 Max_iter: 1000
At iteration 351, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  352 ; minimum lost =  0.6526672840118408 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0007544264080934227
lambda is : 2.1544346900318854e-05, cost : 0.425 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 10:22:20 Max_iter: 1000
At iteration 348, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  349 ; minimum lost =  0.6565074920654297 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006067833746783435
lambda is : 3.16227766016838e-05, cost : 0.396 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 10:22:44 Max_iter: 1000
At iteration 339, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  340 ; minimum lost =  0.6603710055351257 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.0007836821023374796
lambda is : 4.6415888336127784e-05, cost : 0.376 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 10:23:06 Max_iter: 1000
At iteration 313, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  314 ; minimum lost =  0.6641661524772644 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0006282345275394619
lambda is : 6.81292069057961e-05, cost : 0.336 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 10:23:26 Max_iter: 1000
At iteration 305, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  306 ; minimum lost =  0.6677229404449463 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005033613997511566
lambda is : 9.999999999999991e-05, cost : 0.304 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 10:23:44 Max_iter: 1000
At iteration 293, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  294 ; minimum lost =  0.6710003614425659 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0008100722334347665
lambda is : 0.00014677992676220703, cost : 0.278 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 10:24:01 Max_iter: 1000
At iteration 285, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  286 ; minimum lost =  0.6739820241928101 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005930412444286048
lambda is : 0.0002154434690031884, cost : 0.255 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 10:24:16 Max_iter: 1000
At iteration 270, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  271 ; minimum lost =  0.6766658425331116 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00048457729280926287
lambda is : 0.00031622776601683783, cost : 0.219 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 10:24:30 Max_iter: 1000
At iteration 261, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  262 ; minimum lost =  0.6791305541992188 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006822899449616671
lambda is : 0.00046415888336127795, cost : 0.201 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 10:24:42 Max_iter: 1000
At iteration 263, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  264 ; minimum lost =  0.6813607811927795 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006018442218191922
lambda is : 0.0006812920690579617, cost : 0.188 min
==========
Testing lambda: 0.001 starting at 2024-09-27 10:24:53 Max_iter: 1000
At iteration 264, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  265 ; minimum lost =  0.6833293437957764 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006891418597660959
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.191 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 10:25:04 Max_iter: 1000
At iteration 268, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  269 ; minimum lost =  0.6851031184196472 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006553428247570992
lambda is : 0.0014677992676220694, cost : 0.191 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 10:25:16 Max_iter: 1000
At iteration 265, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  266 ; minimum lost =  0.6868982315063477 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.000663064478430897
lambda is : 0.0021544346900318843, cost : 0.178 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 10:25:27 Max_iter: 1000
At iteration 250, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  251 ; minimum lost =  0.6886492371559143 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00045031492481939495
lambda is : 0.003162277660168382, cost : 0.168 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 10:25:37 Max_iter: 1000
At iteration 227, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  228 ; minimum lost =  0.6900867819786072 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00048660419997759163
lambda is : 0.004641588833612781, cost : 0.155 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 10:25:46 Max_iter: 1000
At iteration 212, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  213 ; minimum lost =  0.6909289360046387 ; diff loss =  7.152557373046875e-07 ; diff weight =  0.0005062330164946616
lambda is : 0.006812920690579613, cost : 0.144 min
==========
Testing lambda: 0.01 starting at 2024-09-27 10:25:55 Max_iter: 1000
At iteration 205, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  206 ; minimum lost =  0.6915873885154724 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.000344061350915581
lambda is : 0.010000000000000004, cost : 0.139 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 10:26:03 Max_iter: 1000
At iteration 189, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  190 ; minimum lost =  0.6922217607498169 ; diff loss =  7.152557373046875e-07 ; diff weight =  0.0005347207188606262
lambda is : 0.014677992676220709, cost : 0.132 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 10:26:11 Max_iter: 1000
At iteration 121, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  122 ; minimum lost =  0.6927939057350159 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.00030334750772453845
lambda is : 0.02154434690031885, cost : 0.092 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 10:26:16 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931469440460205 ; diff loss =  4.172325134277344e-07 ; diff weight =  0.00031531674903817475
lambda is : 0.0316227766016838, cost : 0.019 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 10:26:18 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.017 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 10:26:19 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.017 min
==========
Testing lambda: 0.1 starting at 2024-09-27 10:26:20 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.346459    0.101905          0.101734            9529  0.991765  0.881255  0.800868   0.716738  0.799043      0.645166       0.000583
0.000015    0.319226    0.112381          0.112139            8780  0.991878  0.885589  0.796913   0.740741  0.798005      0.648872       0.000770
0.000022    0.286358    0.126667          0.125434            7876  0.992064  0.880212  0.800132   0.755981  0.802030      0.652667       0.000754
0.000032    0.250836    0.142857          0.142197            6899  0.993375  0.909622  0.832112   0.800995  0.834197      0.656507       0.000607
0.000046    0.216768    0.163810          0.163006            5962  0.993145  0.916265  0.856691   0.832487  0.858639      0.660371       0.000784
Exporting resultDF
Exporting result Dict
CD4_CTL Time elapsed: 5.513273143768311 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_Naive
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 10:26:53 Max_iter: 1000
At iteration 410, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  411 ; minimum lost =  0.4450836181640625 ; diff loss =  2.980232238769531e-07 ; diff weight =  1.04879040918604e-06
lambda is : 9.999999999999997e-06, cost : 0.566 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 10:27:27 Max_iter: 1000
At iteration 434, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  435 ; minimum lost =  0.45390585064888 ; diff loss =  7.450580596923828e-07 ; diff weight =  3.021009661097196e-06
lambda is : 1.4677992676220687e-05, cost : 0.541 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 10:28:00 Max_iter: 1000
At iteration 452, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  453 ; minimum lost =  0.4632464647293091 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0008683574269525707
lambda is : 2.1544346900318854e-05, cost : 0.506 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 10:28:30 Max_iter: 1000
At iteration 479, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  480 ; minimum lost =  0.473077654838562 ; diff loss =  9.834766387939453e-07 ; diff weight =  0.0008473482448607683
lambda is : 3.16227766016838e-05, cost : 0.497 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 10:29:00 Max_iter: 1000
At iteration 451, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  452 ; minimum lost =  0.4831254184246063 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0010026163654401898
lambda is : 4.6415888336127784e-05, cost : 0.456 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 10:29:27 Max_iter: 1000
At iteration 445, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  446 ; minimum lost =  0.49318671226501465 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.000783130235504359
lambda is : 6.81292069057961e-05, cost : 0.435 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 10:29:53 Max_iter: 1000
At iteration 417, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  418 ; minimum lost =  0.5033818483352661 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006663675303570926
lambda is : 9.999999999999991e-05, cost : 0.394 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 10:30:17 Max_iter: 1000
At iteration 405, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  406 ; minimum lost =  0.5133807063102722 ; diff loss =  5.960464477539062e-07 ; diff weight =  0.0007771049276925623
lambda is : 0.00014677992676220703, cost : 0.361 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 10:30:39 Max_iter: 1000
At iteration 381, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  382 ; minimum lost =  0.5232667922973633 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0006068127113394439
lambda is : 0.0002154434690031884, cost : 0.33 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 10:30:58 Max_iter: 1000
At iteration 367, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  368 ; minimum lost =  0.5331222414970398 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006068206275813282
lambda is : 0.00031622776601683783, cost : 0.299 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 10:31:16 Max_iter: 1000
At iteration 351, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  352 ; minimum lost =  0.5430927872657776 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.000673980510327965
lambda is : 0.00046415888336127795, cost : 0.284 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 10:31:33 Max_iter: 1000
At iteration 344, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  345 ; minimum lost =  0.5534411072731018 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0006435929099097848
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.295 min
==========
Testing lambda: 0.001 starting at 2024-09-27 10:31:51 Max_iter: 1000
At iteration 333, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  334 ; minimum lost =  0.5641570687294006 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0005963367293588817
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.264 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 10:32:07 Max_iter: 1000
At iteration 325, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  326 ; minimum lost =  0.5750681757926941 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005508625763468444
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.248 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 10:32:22 Max_iter: 1000
At iteration 320, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  321 ; minimum lost =  0.5853992104530334 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0004777724971063435
lambda is : 0.0021544346900318843, cost : 0.223 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 10:32:35 Max_iter: 1000
At iteration 317, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  318 ; minimum lost =  0.5954177379608154 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0004628331807907671
lambda is : 0.003162277660168382, cost : 0.211 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 10:32:48 Max_iter: 1000
At iteration 313, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  314 ; minimum lost =  0.6054156422615051 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004599599924404174
lambda is : 0.004641588833612781, cost : 0.205 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 10:33:00 Max_iter: 1000
At iteration 307, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  308 ; minimum lost =  0.6158532500267029 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00042915315134450793
lambda is : 0.006812920690579613, cost : 0.199 min
==========
Testing lambda: 0.01 starting at 2024-09-27 10:33:12 Max_iter: 1000
At iteration 310, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  311 ; minimum lost =  0.6272267699241638 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.000413990841479972
lambda is : 0.010000000000000004, cost : 0.201 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 10:33:24 Max_iter: 1000
At iteration 302, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  303 ; minimum lost =  0.6391333937644958 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0003982272755820304
lambda is : 0.014677992676220709, cost : 0.196 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 10:33:36 Max_iter: 1000
At iteration 297, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  298 ; minimum lost =  0.6521495580673218 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003654881729744375
lambda is : 0.02154434690031885, cost : 0.194 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 10:33:48 Max_iter: 1000
At iteration 283, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  284 ; minimum lost =  0.6659330725669861 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00034815914114005864
lambda is : 0.0316227766016838, cost : 0.184 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 10:33:59 Max_iter: 1000
At iteration 248, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  249 ; minimum lost =  0.6792192459106445 ; diff loss =  5.960464477539062e-07 ; diff weight =  0.000249081029323861
lambda is : 0.04641588833612786, cost : 0.164 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 10:34:09 Max_iter: 1000
At iteration 207, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  208 ; minimum lost =  0.6892093420028687 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.0003224665706511587
lambda is : 0.0681292069057962, cost : 0.139 min
==========
Testing lambda: 0.1 starting at 2024-09-27 10:34:17 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931471228599548 ; diff loss =  2.384185791015625e-07 ; diff weight =  2.988851338159293e-05
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.358202    0.089596          0.089343            9852  0.991957  0.955445  0.867279   0.819240  0.878536      0.445084       0.000001
0.000015    0.324389    0.099835          0.099678            8922  0.992452  0.955433  0.868886   0.823438  0.880167      0.453906       0.000003
0.000022    0.291158    0.111903          0.111851            8008  0.992679  0.954796  0.864826   0.821317  0.876621      0.463246       0.000868
0.000032    0.257090    0.125983          0.125402            7071  0.993015  0.955312  0.868532   0.834538  0.880508      0.473078       0.000847
0.000046    0.222113    0.143719          0.143087            6109  0.993855  0.959480  0.877677   0.850820  0.889079      0.483125       0.001003
Exporting resultDF
Exporting result Dict
CD4_Naive Time elapsed: 7.539520915349325 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_Proliferating
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 10:34:48 Max_iter: 1000
At iteration 308, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  308 ; minimum lost =  0.6495761871337891 ; diff loss =  0.0 ; diff weight =  1.2902274875159492e-06
lambda is : 9.999999999999997e-06, cost : 0.608 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 10:35:25 Max_iter: 1000
At iteration 507, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  507 ; minimum lost =  0.4486532509326935 ; diff loss =  -9.834766387939453e-07 ; diff weight =  0.022202560678124428
lambda is : 1.4677992676220687e-05, cost : 0.598 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 10:36:01 Max_iter: 1000
At iteration 301, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  302 ; minimum lost =  0.6642822027206421 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.0003024908364750445
lambda is : 2.1544346900318854e-05, cost : 0.466 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 10:36:29 Max_iter: 1000
At iteration 317, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  318 ; minimum lost =  0.6674724221229553 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0007858412573114038
lambda is : 3.16227766016838e-05, cost : 0.443 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 10:36:55 Max_iter: 1000
At iteration 289, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  290 ; minimum lost =  0.670545756816864 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00039881549309939146
lambda is : 4.6415888336127784e-05, cost : 0.408 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 10:37:20 Max_iter: 1000
At iteration 281, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  282 ; minimum lost =  0.6736583113670349 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00035638705594465137
lambda is : 6.81292069057961e-05, cost : 0.399 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 10:37:44 Max_iter: 1000
At iteration 271, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  272 ; minimum lost =  0.6768229603767395 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00030940945725888014
lambda is : 9.999999999999991e-05, cost : 0.369 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 10:38:06 Max_iter: 1000
At iteration 251, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  252 ; minimum lost =  0.6800393462181091 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0003465629415586591
lambda is : 0.00014677992676220703, cost : 0.327 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 10:38:26 Max_iter: 1000
At iteration 236, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  237 ; minimum lost =  0.6831704378128052 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003238669887650758
lambda is : 0.0002154434690031884, cost : 0.295 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 10:38:43 Max_iter: 1000
At iteration 214, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  215 ; minimum lost =  0.686074435710907 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.000361052603693679
lambda is : 0.00031622776601683783, cost : 0.25 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 10:38:58 Max_iter: 1000
At iteration 199, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  200 ; minimum lost =  0.6885620951652527 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003145075752399862
lambda is : 0.00046415888336127795, cost : 0.216 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 10:39:11 Max_iter: 1000
At iteration 181, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  182 ; minimum lost =  0.6904650926589966 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0002936332020908594
lambda is : 0.0006812920690579617, cost : 0.177 min
==========
Testing lambda: 0.001 starting at 2024-09-27 10:39:22 Max_iter: 1000
At iteration 166, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  167 ; minimum lost =  0.6917064785957336 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00030415839864872396
lambda is : 0.0010000000000000002, cost : 0.142 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 10:39:30 Max_iter: 1000
At iteration 157, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  158 ; minimum lost =  0.6923362016677856 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0002935351221822202
lambda is : 0.0014677992676220694, cost : 0.119 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 10:39:38 Max_iter: 1000
At iteration 155, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  156 ; minimum lost =  0.6925983428955078 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003467729256954044
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.114 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 10:39:44 Max_iter: 1000
At iteration 98, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  99 ; minimum lost =  0.6928049325942993 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0001385585783282295
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.084 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 10:39:49 Max_iter: 1000
At iteration 82, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  83 ; minimum lost =  0.6929307579994202 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0001375120918964967
lambda is : 0.004641588833612781, cost : 0.071 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 10:39:54 Max_iter: 1000
At iteration 46, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  47 ; minimum lost =  0.6930590867996216 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00011246061330894008
lambda is : 0.006812920690579613, cost : 0.047 min
==========
Testing lambda: 0.01 starting at 2024-09-27 10:39:57 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931464672088623 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00013069123087916523
lambda is : 0.010000000000000004, cost : 0.023 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 10:39:58 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.014677992676220709, cost : 0.017 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 10:39:59 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.02154434690031885, cost : 0.016 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 10:40:00 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.016 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 10:40:01 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.016 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 10:40:02 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-27 10:40:03 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.446590    0.278846          0.271605           12283  0.938252  0.562525  0.601069   0.555556  0.600000      0.649576       0.000001
0.000015    0.380708    0.355769          0.345679           10471  0.966229  0.596011  0.541182   0.520000  0.541667      0.448653       0.022203
0.000022    0.388525    0.346154          0.345679           10686  0.974564  0.598355  0.523211   0.451613  0.518519      0.664282       0.000302
0.000032    0.353730    0.375000          0.370370            9729  0.965429  0.736169  0.723003   0.708333  0.723404      0.667472       0.000786
0.000046    0.326789    0.403846          0.407407            8988  0.993599  0.791875  0.695042   0.695652  0.695652      0.670546       0.000399
Exporting resultDF
Exporting result Dict
CD4_Proliferating Time elapsed: 5.390269410610199 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_TCM
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 10:40:35 Max_iter: 1000
At iteration 296, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  297 ; minimum lost =  0.5071811079978943 ; diff loss =  6.556510925292969e-07 ; diff weight =  1.6079194438134436e-06
lambda is : 9.999999999999997e-06, cost : 0.52 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 10:41:06 Max_iter: 1000
At iteration 300, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  300 ; minimum lost =  0.5135464668273926 ; diff loss =  0.0 ; diff weight =  1.1097436072304845e-06
lambda is : 1.4677992676220687e-05, cost : 0.514 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 10:41:37 Max_iter: 1000
At iteration 324, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  324 ; minimum lost =  0.5203590989112854 ; diff loss =  0.0 ; diff weight =  3.881777104197681e-07
lambda is : 2.1544346900318854e-05, cost : 0.511 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 10:42:08 Max_iter: 1000
At iteration 333, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  334 ; minimum lost =  0.5285683870315552 ; diff loss =  2.980232238769531e-07 ; diff weight =  9.691553941593156e-07
lambda is : 3.16227766016838e-05, cost : 0.469 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 10:42:36 Max_iter: 1000
At iteration 350, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  351 ; minimum lost =  0.5369452238082886 ; diff loss =  1.7881393432617188e-07 ; diff weight =  2.542807635563804e-07
lambda is : 4.6415888336127784e-05, cost : 0.455 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 10:43:03 Max_iter: 1000
At iteration 367, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  368 ; minimum lost =  0.5453062653541565 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.1223613149979883e-09
lambda is : 6.81292069057961e-05, cost : 0.463 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 10:43:31 Max_iter: 1000
At iteration 402, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  403 ; minimum lost =  0.5539291501045227 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.1804917593737372e-10
lambda is : 9.999999999999991e-05, cost : 0.464 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 10:43:59 Max_iter: 1000
At iteration 410, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  411 ; minimum lost =  0.5629664063453674 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.001230165478773415
lambda is : 0.00014677992676220703, cost : 0.387 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 10:44:22 Max_iter: 1000
At iteration 373, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  374 ; minimum lost =  0.5708321332931519 ; diff loss =  7.152557373046875e-07 ; diff weight =  0.0005668143858201802
lambda is : 0.0002154434690031884, cost : 0.351 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 10:44:43 Max_iter: 1000
At iteration 369, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  370 ; minimum lost =  0.5782175064086914 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.0007909422856755555
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00031622776601683783, cost : 0.38 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 10:45:06 Max_iter: 1000
At iteration 340, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  341 ; minimum lost =  0.5857957601547241 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006592519930563867
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00046415888336127795, cost : 0.317 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 10:45:25 Max_iter: 1000
At iteration 322, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  323 ; minimum lost =  0.5935888290405273 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006145369843579829
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.283 min
==========
Testing lambda: 0.001 starting at 2024-09-27 10:45:42 Max_iter: 1000
At iteration 313, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  314 ; minimum lost =  0.6014606356620789 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0005206630448810756
lambda is : 0.0010000000000000002, cost : 0.245 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 10:45:57 Max_iter: 1000
At iteration 304, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  305 ; minimum lost =  0.609326183795929 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004952424205839634
lambda is : 0.0014677992676220694, cost : 0.225 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 10:46:10 Max_iter: 1000
At iteration 300, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  301 ; minimum lost =  0.6170413494110107 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005035990616306663
lambda is : 0.0021544346900318843, cost : 0.206 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 10:46:23 Max_iter: 1000
At iteration 297, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  298 ; minimum lost =  0.6248880624771118 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005228416412137449
lambda is : 0.003162277660168382, cost : 0.199 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 10:46:35 Max_iter: 1000
At iteration 295, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  296 ; minimum lost =  0.633466362953186 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004950492293573916
lambda is : 0.004641588833612781, cost : 0.195 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 10:46:46 Max_iter: 1000
At iteration 299, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  300 ; minimum lost =  0.642967164516449 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00045556502300314605
lambda is : 0.006812920690579613, cost : 0.196 min
==========
Testing lambda: 0.01 starting at 2024-09-27 10:46:58 Max_iter: 1000
At iteration 308, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  309 ; minimum lost =  0.6531525254249573 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004469204868655652
lambda is : 0.010000000000000004, cost : 0.2 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 10:47:10 Max_iter: 1000
At iteration 306, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  307 ; minimum lost =  0.6633376479148865 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00039428670424968004
lambda is : 0.014677992676220709, cost : 0.199 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 10:47:22 Max_iter: 1000
At iteration 282, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  283 ; minimum lost =  0.6723297238349915 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00033227898529730737
lambda is : 0.02154434690031885, cost : 0.184 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 10:47:33 Max_iter: 1000
At iteration 299, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  300 ; minimum lost =  0.680428683757782 ; diff loss =  5.364418029785156e-07 ; diff weight =  0.00022450005053542554
lambda is : 0.0316227766016838, cost : 0.195 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 10:47:45 Max_iter: 1000
At iteration 245, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  246 ; minimum lost =  0.6867638230323792 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003601346106734127
lambda is : 0.04641588833612786, cost : 0.163 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 10:47:55 Max_iter: 1000
At iteration 145, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  146 ; minimum lost =  0.6912376880645752 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.000255387945799157
lambda is : 0.0681292069057962, cost : 0.105 min
==========
Testing lambda: 0.1 starting at 2024-09-27 10:48:01 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.376273    0.105444          0.105143           10349  0.966377  0.807906  0.715300   0.689799  0.740575      0.507181   1.607919e-06
0.000015    0.345477    0.117137          0.117363            9502  0.967146  0.807868  0.715357   0.694656  0.740841      0.513546   1.109744e-06
0.000022    0.317517    0.130242          0.129837            8733  0.968186  0.813203  0.715816   0.688279  0.740940      0.520359   3.881777e-07
0.000032    0.283341    0.144355          0.143585            7793  0.969019  0.814040  0.730874   0.712199  0.755009      0.528568   9.691554e-07
0.000046    0.247419    0.162903          0.162933            6805  0.970039  0.815423  0.725935   0.717949  0.750809      0.536945   2.542808e-07
Exporting resultDF
Exporting result Dict
CD4_TCM Time elapsed: 7.578364241123199 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_TEM
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 10:48:33 Max_iter: 1000
At iteration 378, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  379 ; minimum lost =  0.6328637003898621 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003559941833373159
lambda is : 9.999999999999997e-06, cost : 0.499 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 10:49:03 Max_iter: 1000
At iteration 382, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  383 ; minimum lost =  0.6370349526405334 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006673876196146011
lambda is : 1.4677992676220687e-05, cost : 0.492 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 10:49:33 Max_iter: 1000
At iteration 372, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  373 ; minimum lost =  0.6413661241531372 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.000638920406345278
lambda is : 2.1544346900318854e-05, cost : 0.448 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 10:50:00 Max_iter: 1000
At iteration 367, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  368 ; minimum lost =  0.6458615660667419 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0008418379002250731
lambda is : 3.16227766016838e-05, cost : 0.43 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 10:50:25 Max_iter: 1000
At iteration 367, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  368 ; minimum lost =  0.6504707932472229 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0007601320976391435
lambda is : 4.6415888336127784e-05, cost : 0.4 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 10:50:49 Max_iter: 1000
At iteration 348, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  349 ; minimum lost =  0.655055582523346 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0006935521960258484
lambda is : 6.81292069057961e-05, cost : 0.373 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 10:51:12 Max_iter: 1000
At iteration 333, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  334 ; minimum lost =  0.6594468951225281 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0008569681667722762
lambda is : 9.999999999999991e-05, cost : 0.342 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 10:51:32 Max_iter: 1000
At iteration 326, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  327 ; minimum lost =  0.6635046005249023 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0005742086214013398
lambda is : 0.00014677992676220703, cost : 0.312 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 10:51:51 Max_iter: 1000
At iteration 308, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  309 ; minimum lost =  0.6671700477600098 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0006834582309238613
lambda is : 0.0002154434690031884, cost : 0.287 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 10:52:08 Max_iter: 1000
At iteration 299, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  300 ; minimum lost =  0.6703599691390991 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0007966225384734571
lambda is : 0.00031622776601683783, cost : 0.293 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 10:52:26 Max_iter: 1000
At iteration 296, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  297 ; minimum lost =  0.6731077432632446 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0007467168034054339
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00046415888336127795, cost : 0.265 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 10:52:42 Max_iter: 1000
At iteration 293, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  294 ; minimum lost =  0.6755485534667969 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0008673019474372268
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.244 min
==========
Testing lambda: 0.001 starting at 2024-09-27 10:52:56 Max_iter: 1000
At iteration 291, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  292 ; minimum lost =  0.6776642203330994 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0008553648949600756
lambda is : 0.0010000000000000002, cost : 0.211 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 10:53:09 Max_iter: 1000
At iteration 291, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  292 ; minimum lost =  0.6796205639839172 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0008098832913674414
lambda is : 0.0014677992676220694, cost : 0.195 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 10:53:21 Max_iter: 1000
At iteration 297, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  298 ; minimum lost =  0.6815470457077026 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0007777061546221375
lambda is : 0.0021544346900318843, cost : 0.194 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 10:53:32 Max_iter: 1000
At iteration 292, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  293 ; minimum lost =  0.6834220886230469 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006334336358122528
lambda is : 0.003162277660168382, cost : 0.19 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 10:53:44 Max_iter: 1000
At iteration 281, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  282 ; minimum lost =  0.685254693031311 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00046332241618074477
lambda is : 0.004641588833612781, cost : 0.183 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 10:53:55 Max_iter: 1000
At iteration 264, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  265 ; minimum lost =  0.6870000958442688 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0003110450052190572
lambda is : 0.006812920690579613, cost : 0.173 min
==========
Testing lambda: 0.01 starting at 2024-09-27 10:54:05 Max_iter: 1000
At iteration 247, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  248 ; minimum lost =  0.6885228753089905 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00038851244607940316
lambda is : 0.010000000000000004, cost : 0.162 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 10:54:15 Max_iter: 1000
At iteration 221, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  222 ; minimum lost =  0.6900185346603394 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004056202305946499
lambda is : 0.014677992676220709, cost : 0.146 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 10:54:24 Max_iter: 1000
At iteration 159, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  160 ; minimum lost =  0.6916179656982422 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00033757832716219127
lambda is : 0.02154434690031885, cost : 0.11 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 10:54:30 Max_iter: 1000
At iteration 87, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  88 ; minimum lost =  0.6925780177116394 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00028933791327290237
lambda is : 0.0316227766016838, cost : 0.07 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 10:54:34 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931470632553101 ; diff loss =  2.980232238769531e-07 ; diff weight =  0.00023457057250197977
lambda is : 0.04641588833612786, cost : 0.018 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 10:54:36 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-27 10:54:37 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.360275    0.099952          0.100120            9909  0.965571  0.638443  0.622952   0.611465  0.637168      0.632864       0.000356
0.000015    0.326934    0.112803          0.112110            8992  0.966646  0.645095  0.617338   0.593496  0.631351      0.637035       0.000667
0.000022    0.295412    0.126130          0.125899            8125  0.966013  0.651357  0.614399   0.590264  0.628510      0.641366       0.000639
0.000032    0.262289    0.140885          0.141487            7214  0.968160  0.656495  0.604259   0.565134  0.617801      0.645862       0.000842
0.000046    0.228076    0.159448          0.159472            6273  0.970871  0.652908  0.606169   0.568401  0.619748      0.650471       0.000760
Exporting resultDF
Exporting result Dict
CD4_TEM Time elapsed: 6.209148291746775 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD8_Naive
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 10:55:10 Max_iter: 1000
At iteration 243, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  244 ; minimum lost =  0.46910560131073 ; diff loss =  5.960464477539062e-07 ; diff weight =  1.3058752301731147e-06
lambda is : 9.999999999999997e-06, cost : 0.471 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 10:55:38 Max_iter: 1000
At iteration 242, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  242 ; minimum lost =  0.47622150182724 ; diff loss =  0.0 ; diff weight =  1.6909713167478913e-06
lambda is : 1.4677992676220687e-05, cost : 0.454 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 10:56:05 Max_iter: 1000
At iteration 240, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  241 ; minimum lost =  0.48393091559410095 ; diff loss =  2.9802322387695312e-08 ; diff weight =  4.091551275564598e-08
lambda is : 2.1544346900318854e-05, cost : 0.435 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 10:56:31 Max_iter: 1000
At iteration 234, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  235 ; minimum lost =  0.49204638600349426 ; diff loss =  1.4901161193847656e-07 ; diff weight =  1.3386456032549177e-07
lambda is : 3.16227766016838e-05, cost : 0.409 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 10:56:56 Max_iter: 1000
At iteration 229, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  230 ; minimum lost =  0.5005719661712646 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.317540068157541e-07
lambda is : 4.6415888336127784e-05, cost : 0.375 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 10:57:18 Max_iter: 1000
At iteration 223, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  223 ; minimum lost =  0.5092193484306335 ; diff loss =  0.0 ; diff weight =  4.818018055630091e-07
lambda is : 6.81292069057961e-05, cost : 0.352 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 10:57:39 Max_iter: 1000
At iteration 220, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  221 ; minimum lost =  0.5177463889122009 ; diff loss =  1.1920928955078125e-07 ; diff weight =  8.438314580416773e-08
lambda is : 9.999999999999991e-05, cost : 0.324 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 10:57:59 Max_iter: 1000
At iteration 218, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  219 ; minimum lost =  0.5263579487800598 ; diff loss =  2.980232238769531e-07 ; diff weight =  4.965652919963759e-07
lambda is : 0.00014677992676220703, cost : 0.296 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 10:58:17 Max_iter: 1000
At iteration 210, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  211 ; minimum lost =  0.5351734757423401 ; diff loss =  2.384185791015625e-07 ; diff weight =  4.805947924069187e-07
lambda is : 0.0002154434690031884, cost : 0.265 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 10:58:33 Max_iter: 1000
At iteration 217, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  218 ; minimum lost =  0.5436363220214844 ; diff loss =  1.1920928955078125e-07 ; diff weight =  9.26345720131394e-08
lambda is : 0.00031622776601683783, cost : 0.257 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 10:58:48 Max_iter: 1000
At iteration 218, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  219 ; minimum lost =  0.5520435571670532 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.857813872329643e-09
lambda is : 0.00046415888336127795, cost : 0.237 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 10:59:02 Max_iter: 1000
At iteration 229, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  229 ; minimum lost =  0.5608468651771545 ; diff loss =  0.0 ; diff weight =  2.6402387902635382e-06
lambda is : 0.0006812920690579617, cost : 0.236 min
==========
Testing lambda: 0.001 starting at 2024-09-27 10:59:16 Max_iter: 1000
At iteration 252, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  253 ; minimum lost =  0.5704935789108276 ; diff loss =  5.960464477539063e-08 ; diff weight =  5.997870289320417e-08
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.253 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 10:59:32 Max_iter: 1000
At iteration 299, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  299 ; minimum lost =  0.5813518166542053 ; diff loss =  0.0 ; diff weight =  3.5839848351315595e-06
lambda is : 0.0014677992676220694, cost : 0.262 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 10:59:47 Max_iter: 1000
At iteration 321, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  322 ; minimum lost =  0.5932982563972473 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006100315949879587
lambda is : 0.0021544346900318843, cost : 0.217 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 11:00:00 Max_iter: 1000
At iteration 317, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  318 ; minimum lost =  0.602899968624115 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005109052872285247
lambda is : 0.003162277660168382, cost : 0.209 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 11:00:13 Max_iter: 1000
At iteration 306, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  307 ; minimum lost =  0.6121417284011841 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003784146683756262
lambda is : 0.004641588833612781, cost : 0.2 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 11:00:25 Max_iter: 1000
At iteration 297, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  298 ; minimum lost =  0.6221163272857666 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00041387343662790954
lambda is : 0.006812920690579613, cost : 0.193 min
==========
Testing lambda: 0.01 starting at 2024-09-27 11:00:36 Max_iter: 1000
At iteration 292, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  293 ; minimum lost =  0.6325687766075134 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00038846483221277595
lambda is : 0.010000000000000004, cost : 0.191 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 11:00:48 Max_iter: 1000
At iteration 285, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  286 ; minimum lost =  0.6431955099105835 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003926797362510115
lambda is : 0.014677992676220709, cost : 0.189 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 11:00:59 Max_iter: 1000
At iteration 280, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  281 ; minimum lost =  0.6535990834236145 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0003691118326969445
lambda is : 0.02154434690031885, cost : 0.186 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 11:01:10 Max_iter: 1000
At iteration 275, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  276 ; minimum lost =  0.6641756892204285 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00040041960892267525
lambda is : 0.0316227766016838, cost : 0.183 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 11:01:21 Max_iter: 1000
At iteration 222, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  223 ; minimum lost =  0.6737025380134583 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003289154847152531
lambda is : 0.04641588833612786, cost : 0.15 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 11:01:30 Max_iter: 1000
At iteration 153, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  154 ; minimum lost =  0.6824302077293396 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00030881166458129883
lambda is : 0.0681292069057962, cost : 0.107 min
==========
Testing lambda: 0.1 starting at 2024-09-27 11:01:37 Max_iter: 1000
At iteration 120, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  121 ; minimum lost =  0.690236508846283 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.00028680264949798584
lambda is : 0.10000000000000002, cost : 0.087 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.369728    0.098312          0.097644           10169  0.994692  0.970528  0.875282   0.814815  0.881511      0.469106   1.305875e-06
0.000015    0.343041    0.110228          0.110353            9435  0.993981  0.968765  0.876878   0.819637  0.883266      0.476222   1.690971e-06
0.000022    0.312682    0.122393          0.122443            8600  0.994738  0.972496  0.885189   0.828510  0.891066      0.483931   4.091551e-08
0.000032    0.279341    0.139027          0.138872            7683  0.994864  0.970991  0.896622   0.855866  0.902770      0.492046   1.338646e-07
0.000046    0.244074    0.157895          0.157471            6713  0.994557  0.969739  0.901478   0.868871  0.907683      0.500572   1.317540e-07
Exporting resultDF
Exporting result Dict
CD8_Naive Time elapsed: 6.6703546722730005 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD8_Proliferating
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 11:02:12 Max_iter: 1000
At iteration 266, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  267 ; minimum lost =  0.6571313738822937 ; diff loss =  5.960464477539063e-08 ; diff weight =  8.592434141974081e-08
lambda is : 9.999999999999997e-06, cost : 0.536 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 11:02:45 Max_iter: 1000
At iteration 280, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  281 ; minimum lost =  0.6609393358230591 ; diff loss =  4.172325134277344e-07 ; diff weight =  5.140551024851447e-07
lambda is : 1.4677992676220687e-05, cost : 0.516 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 11:03:16 Max_iter: 1000
At iteration 308, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  309 ; minimum lost =  0.6654636859893799 ; diff loss =  6.556510925292969e-07 ; diff weight =  3.7389211229310604e-06
lambda is : 2.1544346900318854e-05, cost : 0.515 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 11:03:46 Max_iter: 1000
At iteration 306, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  307 ; minimum lost =  0.6709742546081543 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00024907407350838184
lambda is : 3.16227766016838e-05, cost : 0.424 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 11:04:12 Max_iter: 1000
At iteration 278, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  279 ; minimum lost =  0.67418372631073 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.000452633568784222
lambda is : 4.6415888336127784e-05, cost : 0.388 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 11:04:35 Max_iter: 1000
At iteration 264, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  265 ; minimum lost =  0.6772401332855225 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0004354841075837612
lambda is : 6.81292069057961e-05, cost : 0.356 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 11:04:57 Max_iter: 1000
At iteration 249, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  250 ; minimum lost =  0.6802996397018433 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00033367465948686004
lambda is : 9.999999999999991e-05, cost : 0.322 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 11:05:16 Max_iter: 1000
At iteration 229, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  230 ; minimum lost =  0.683258593082428 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00034050759859383106
lambda is : 0.00014677992676220703, cost : 0.297 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 11:05:34 Max_iter: 1000
At iteration 209, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  210 ; minimum lost =  0.6859996914863586 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00042400427628308535
lambda is : 0.0002154434690031884, cost : 0.259 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 11:05:49 Max_iter: 1000
At iteration 184, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  185 ; minimum lost =  0.6884023547172546 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00031818781280890107
lambda is : 0.00031622776601683783, cost : 0.217 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 11:06:02 Max_iter: 1000
At iteration 170, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  171 ; minimum lost =  0.6903265714645386 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0003431627992540598
lambda is : 0.00046415888336127795, cost : 0.183 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 11:06:13 Max_iter: 1000
At iteration 153, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  154 ; minimum lost =  0.6916852593421936 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00029903757967986166
lambda is : 0.0006812920690579617, cost : 0.143 min
==========
Testing lambda: 0.001 starting at 2024-09-27 11:06:22 Max_iter: 1000
At iteration 136, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  137 ; minimum lost =  0.6924992799758911 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00028829611255787313
lambda is : 0.0010000000000000002, cost : 0.116 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 11:06:29 Max_iter: 1000
At iteration 125, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  126 ; minimum lost =  0.6928774118423462 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00028338059200905263
lambda is : 0.0014677992676220694, cost : 0.101 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 11:06:35 Max_iter: 1000
At iteration 50, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  51 ; minimum lost =  0.6930571794509888 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00011114840162917972
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.056 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 11:06:38 Max_iter: 1000
At iteration 24, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  25 ; minimum lost =  0.6931141018867493 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00010946310067083687
lambda is : 0.003162277660168382, cost : 0.041 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 11:06:41 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931467652320862 ; diff loss =  5.960464477539062e-07 ; diff weight =  0.00011385910329408944
lambda is : 0.004641588833612781, cost : 0.022 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 11:06:42 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931470632553101 ; diff loss =  2.980232238769531e-07 ; diff weight =  2.0750643670908175e-05
lambda is : 0.006812920690579613, cost : 0.017 min
==========
Testing lambda: 0.01 starting at 2024-09-27 11:06:43 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.010000000000000004, cost : 0.016 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 11:06:44 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.014677992676220709, cost : 0.015 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 11:06:45 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.02154434690031885, cost : 0.015 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 11:06:46 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.016 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 11:06:47 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.016 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 11:06:48 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-27 11:06:49 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.429428    0.213483          0.228571           11811  0.940856  0.061261  0.044073   0.040000  0.045455      0.657131   8.592434e-08
0.000015    0.405323    0.235955          0.242857           11148  0.930164  0.057867  0.049688   0.050000  0.051282      0.660939   5.140551e-07
0.000022    0.380090    0.258427          0.271429           10454  0.929577  0.053560  0.048410   0.047619  0.050000      0.665464   3.738921e-06
0.000032    0.338751    0.292135          0.300000            9317  0.955980  0.065990  0.094027   0.086957  0.095238      0.670974   2.490741e-04
0.000046    0.304719    0.314607          0.328571            8381  0.957465  0.081258  0.165621   0.176471  0.166667      0.674184   4.526336e-04
Exporting resultDF
Exporting result Dict
CD8_Proliferating Time elapsed: 4.757193227608998 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD8_TCM
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 11:07:21 Max_iter: 1000
At iteration 327, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  328 ; minimum lost =  0.6401155591011047 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.6455838881011005e-07
lambda is : 9.999999999999997e-06, cost : 0.504 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 11:07:51 Max_iter: 1000
At iteration 328, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  329 ; minimum lost =  0.6442413926124573 ; diff loss =  4.76837158203125e-07 ; diff weight =  0.0013967251870781183
lambda is : 1.4677992676220687e-05, cost : 0.461 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 11:08:19 Max_iter: 1000
At iteration 336, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  336 ; minimum lost =  0.648494303226471 ; diff loss =  -1.7881393432617188e-07 ; diff weight =  0.0008014640770852566
lambda is : 2.1544346900318854e-05, cost : 0.438 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 11:08:45 Max_iter: 1000
At iteration 350, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  351 ; minimum lost =  0.6528195738792419 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0010518331546336412
lambda is : 3.16227766016838e-05, cost : 0.41 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 11:09:10 Max_iter: 1000
At iteration 342, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  343 ; minimum lost =  0.6572422385215759 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.0006298186490312219
lambda is : 4.6415888336127784e-05, cost : 0.392 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 11:09:33 Max_iter: 1000
At iteration 309, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  310 ; minimum lost =  0.6615270972251892 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004440084449015558
lambda is : 6.81292069057961e-05, cost : 0.341 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 11:09:54 Max_iter: 1000
At iteration 297, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  298 ; minimum lost =  0.6655290126800537 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0005286234081722796
lambda is : 9.999999999999991e-05, cost : 0.315 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 11:10:13 Max_iter: 1000
At iteration 283, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  284 ; minimum lost =  0.6691893339157104 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0005118392291478813
lambda is : 0.00014677992676220703, cost : 0.283 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 11:10:30 Max_iter: 1000
At iteration 270, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  271 ; minimum lost =  0.6724143028259277 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0005198466824367642
lambda is : 0.0002154434690031884, cost : 0.252 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 11:10:45 Max_iter: 1000
At iteration 261, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  262 ; minimum lost =  0.6752750873565674 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005470747128129005
lambda is : 0.00031622776601683783, cost : 0.23 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 11:10:59 Max_iter: 1000
At iteration 257, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  258 ; minimum lost =  0.6778650879859924 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005545835010707378
lambda is : 0.00046415888336127795, cost : 0.219 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 11:11:12 Max_iter: 1000
At iteration 256, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  257 ; minimum lost =  0.6802673935890198 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0005165631882846355
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.225 min
==========
Testing lambda: 0.001 starting at 2024-09-27 11:11:25 Max_iter: 1000
At iteration 254, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  255 ; minimum lost =  0.6825278997421265 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005518262041732669
lambda is : 0.0010000000000000002, cost : 0.206 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 11:11:38 Max_iter: 1000
At iteration 257, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  258 ; minimum lost =  0.6846582889556885 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0005589520442299545
lambda is : 0.0014677992676220694, cost : 0.183 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 11:11:49 Max_iter: 1000
At iteration 266, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  267 ; minimum lost =  0.686596691608429 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005544514860957861
lambda is : 0.0021544346900318843, cost : 0.181 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 11:12:00 Max_iter: 1000
At iteration 260, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  261 ; minimum lost =  0.6881809830665588 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005281753255985677
lambda is : 0.003162277660168382, cost : 0.173 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 11:12:10 Max_iter: 1000
At iteration 226, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  227 ; minimum lost =  0.6894188523292542 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003897950809914619
lambda is : 0.004641588833612781, cost : 0.154 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 11:12:19 Max_iter: 1000
At iteration 190, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  191 ; minimum lost =  0.6903828978538513 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003270778397563845
lambda is : 0.006812920690579613, cost : 0.131 min
==========
Testing lambda: 0.01 starting at 2024-09-27 11:12:27 Max_iter: 1000
At iteration 191, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  192 ; minimum lost =  0.6911922693252563 ; diff loss =  5.960464477539062e-07 ; diff weight =  0.0003073955012951046
lambda is : 0.010000000000000004, cost : 0.132 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 11:12:35 Max_iter: 1000
At iteration 192, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  193 ; minimum lost =  0.6919299960136414 ; diff loss =  8.344650268554688e-07 ; diff weight =  1.4534442925651092e-05
lambda is : 0.014677992676220709, cost : 0.132 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 11:12:43 Max_iter: 1000
At iteration 76, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  77 ; minimum lost =  0.6927516460418701 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0002563787857070565
lambda is : 0.02154434690031885, cost : 0.064 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 11:12:47 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931470632553101 ; diff loss =  2.980232238769531e-07 ; diff weight =  1.5790870747878216e-05
lambda is : 0.0316227766016838, cost : 0.02 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 11:12:48 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.016 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 11:12:49 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-27 11:12:50 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.367983    0.103271          0.103560           10121  0.973362  0.715399  0.649218   0.613941  0.658046      0.640116   3.645584e-07
0.000015    0.336460    0.114176          0.115696            9254  0.975600  0.711408  0.659242   0.642857  0.668648      0.644241   1.396725e-03
0.000022    0.302938    0.129570          0.130259            8332  0.976053  0.719768  0.665018   0.629032  0.673381      0.648494   8.014641e-04
0.000032    0.266543    0.146248          0.147249            7331  0.975819  0.731508  0.695931   0.674221  0.704142      0.652820   1.051833e-03
0.000046    0.228585    0.168056          0.169094            6287  0.976543  0.744505  0.683753   0.665714  0.692422      0.657242   6.298186e-04
Exporting resultDF
Exporting result Dict
CD8_TCM Time elapsed: 5.626613565286001 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD8_TEM
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 11:13:22 Max_iter: 1000
At iteration 458, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  458 ; minimum lost =  0.5022909641265869 ; diff loss =  -5.960464477539063e-08 ; diff weight =  0.002066852292045951
lambda is : 9.999999999999997e-06, cost : 0.551 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 11:13:55 Max_iter: 1000
At iteration 450, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  451 ; minimum lost =  0.5094162225723267 ; diff loss =  7.152557373046875e-07 ; diff weight =  0.0011175147956237197
lambda is : 1.4677992676220687e-05, cost : 0.539 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 11:14:27 Max_iter: 1000
At iteration 490, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  491 ; minimum lost =  0.5168581604957581 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0007544314139522612
lambda is : 2.1544346900318854e-05, cost : 0.552 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 11:15:01 Max_iter: 1000
At iteration 476, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  477 ; minimum lost =  0.5246372222900391 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0007368281949311495
lambda is : 3.16227766016838e-05, cost : 0.501 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 11:15:31 Max_iter: 1000
At iteration 454, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  455 ; minimum lost =  0.5326011776924133 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0006692812312394381
lambda is : 4.6415888336127784e-05, cost : 0.477 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 11:15:59 Max_iter: 1000
At iteration 440, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  441 ; minimum lost =  0.5404970645904541 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0009785464499145746
lambda is : 6.81292069057961e-05, cost : 0.433 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 11:16:25 Max_iter: 1000
At iteration 425, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  426 ; minimum lost =  0.5481910705566406 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0005887702573090792
lambda is : 9.999999999999991e-05, cost : 0.41 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 11:16:50 Max_iter: 1000
At iteration 400, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  401 ; minimum lost =  0.5555810928344727 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0007879888289608061
lambda is : 0.00014677992676220703, cost : 0.377 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 11:17:12 Max_iter: 1000
At iteration 396, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  397 ; minimum lost =  0.5626848936080933 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005353274173103273
lambda is : 0.0002154434690031884, cost : 0.347 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 11:17:33 Max_iter: 1000
At iteration 375, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  376 ; minimum lost =  0.5695696473121643 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0007519854698330164
lambda is : 0.00031622776601683783, cost : 0.33 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 11:17:53 Max_iter: 1000
At iteration 349, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  350 ; minimum lost =  0.5762321352958679 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0008629204821772873
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00046415888336127795, cost : 0.314 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 11:18:12 Max_iter: 1000
At iteration 342, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  343 ; minimum lost =  0.5828201174736023 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006958347512409091
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.28 min
==========
Testing lambda: 0.001 starting at 2024-09-27 11:18:29 Max_iter: 1000
At iteration 334, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  335 ; minimum lost =  0.58966463804245 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0007883868529461324
lambda is : 0.0010000000000000002, cost : 0.255 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 11:18:44 Max_iter: 1000
At iteration 323, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  324 ; minimum lost =  0.5968765616416931 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.000728970393538475
lambda is : 0.0014677992676220694, cost : 0.232 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 11:18:58 Max_iter: 1000
At iteration 318, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  319 ; minimum lost =  0.6039903163909912 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0006556889275088906
lambda is : 0.0021544346900318843, cost : 0.214 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 11:19:11 Max_iter: 1000
At iteration 311, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  312 ; minimum lost =  0.6110323071479797 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006180761847645044
lambda is : 0.003162277660168382, cost : 0.204 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 11:19:23 Max_iter: 1000
At iteration 308, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  309 ; minimum lost =  0.6186452507972717 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.000603042368311435
lambda is : 0.004641588833612781, cost : 0.203 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 11:19:35 Max_iter: 1000
At iteration 319, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  320 ; minimum lost =  0.6266424059867859 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005680331378243864
lambda is : 0.006812920690579613, cost : 0.208 min
==========
Testing lambda: 0.01 starting at 2024-09-27 11:19:48 Max_iter: 1000
At iteration 320, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  321 ; minimum lost =  0.6345946192741394 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005327883991412818
lambda is : 0.010000000000000004, cost : 0.207 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 11:20:00 Max_iter: 1000
At iteration 323, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  324 ; minimum lost =  0.642864465713501 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004758397117257118
lambda is : 0.014677992676220709, cost : 0.207 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 11:20:12 Max_iter: 1000
At iteration 322, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  323 ; minimum lost =  0.6515530943870544 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004647260648198426
lambda is : 0.02154434690031885, cost : 0.206 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 11:20:25 Max_iter: 1000
At iteration 256, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  257 ; minimum lost =  0.6605751514434814 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0001874373119790107
lambda is : 0.0316227766016838, cost : 0.168 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 11:20:35 Max_iter: 1000
At iteration 215, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  216 ; minimum lost =  0.6708820462226868 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0002139364805771038
lambda is : 0.04641588833612786, cost : 0.144 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 11:20:44 Max_iter: 1000
At iteration 193, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  194 ; minimum lost =  0.6816884279251099 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00033994406112469733
lambda is : 0.0681292069057962, cost : 0.131 min
==========
Testing lambda: 0.1 starting at 2024-09-27 11:20:51 Max_iter: 1000
At iteration 121, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  122 ; minimum lost =  0.6905286908149719 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.00023598968982696533
lambda is : 0.10000000000000002, cost : 0.088 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.361002    0.101150          0.101203            9929  0.984633  0.909061  0.823559   0.781986  0.835429      0.502291       0.002067
0.000015    0.331624    0.112884          0.112643            9121  0.984917  0.908597  0.819202   0.782609  0.831683      0.509416       0.001118
0.000022    0.304247    0.124032          0.123790            8368  0.985216  0.909738  0.816557   0.781120  0.829295      0.516858       0.000754
0.000032    0.268506    0.139873          0.139630            7385  0.985672  0.913012  0.826626   0.794334  0.838781      0.524637       0.000737
0.000046    0.234984    0.157475          0.156644            6463  0.985752  0.912306  0.828081   0.796842  0.840178      0.532601       0.000669
Exporting resultDF
Exporting result Dict
CD8_TEM Time elapsed: 7.702338850498199 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Doublet
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 11:21:27 Max_iter: 1000
At iteration 316, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  317 ; minimum lost =  0.6598951816558838 ; diff loss =  6.556510925292969e-07 ; diff weight =  0.0003151320852339268
lambda is : 9.999999999999997e-06, cost : 0.501 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 11:21:57 Max_iter: 1000
At iteration 315, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  316 ; minimum lost =  0.6629557013511658 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.00012975148274563253
lambda is : 1.4677992676220687e-05, cost : 0.502 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 11:22:27 Max_iter: 1000
At iteration 302, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  303 ; minimum lost =  0.666181743144989 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00017329608090221882
lambda is : 2.1544346900318854e-05, cost : 0.462 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 11:22:55 Max_iter: 1000
At iteration 303, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  304 ; minimum lost =  0.6693056225776672 ; diff loss =  5.364418029785156e-07 ; diff weight =  0.00040376451215706766
lambda is : 3.16227766016838e-05, cost : 0.44 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 11:23:21 Max_iter: 1000
At iteration 316, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  317 ; minimum lost =  0.6724365949630737 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004763659380842
lambda is : 4.6415888336127784e-05, cost : 0.422 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 11:23:47 Max_iter: 1000
At iteration 308, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  309 ; minimum lost =  0.6756181120872498 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005149558419361711
lambda is : 6.81292069057961e-05, cost : 0.379 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 11:24:10 Max_iter: 1000
At iteration 300, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  301 ; minimum lost =  0.6787568926811218 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00045415826025418937
lambda is : 9.999999999999991e-05, cost : 0.365 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 11:24:31 Max_iter: 1000
At iteration 277, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  278 ; minimum lost =  0.6817702054977417 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0008850586018525064
lambda is : 0.00014677992676220703, cost : 0.309 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 11:24:50 Max_iter: 1000
At iteration 268, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  269 ; minimum lost =  0.684495747089386 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006266417913138866
lambda is : 0.0002154434690031884, cost : 0.293 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 11:25:08 Max_iter: 1000
At iteration 232, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  233 ; minimum lost =  0.6868839263916016 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0006500646704807878
lambda is : 0.00031622776601683783, cost : 0.235 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 11:25:22 Max_iter: 1000
At iteration 231, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  232 ; minimum lost =  0.6887655258178711 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006512224790640175
lambda is : 0.00046415888336127795, cost : 0.226 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 11:25:35 Max_iter: 1000
At iteration 217, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  218 ; minimum lost =  0.6901382803916931 ; diff loss =  7.152557373046875e-07 ; diff weight =  0.00042556479456834495
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.216 min
==========
Testing lambda: 0.001 starting at 2024-09-27 11:25:48 Max_iter: 1000
At iteration 213, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  214 ; minimum lost =  0.6910564303398132 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0005343487719073892
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.179 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 11:25:59 Max_iter: 1000
At iteration 221, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  222 ; minimum lost =  0.6916710138320923 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005257449811324477
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.16 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 11:26:08 Max_iter: 1000
At iteration 225, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  226 ; minimum lost =  0.6920948028564453 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00048403575783595443
lambda is : 0.0021544346900318843, cost : 0.154 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 11:26:18 Max_iter: 1000
At iteration 176, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  177 ; minimum lost =  0.6924061179161072 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.00035409280098974705
lambda is : 0.003162277660168382, cost : 0.124 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 11:26:25 Max_iter: 1000
At iteration 178, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  179 ; minimum lost =  0.6926155090332031 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003617086331360042
lambda is : 0.004641588833612781, cost : 0.124 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 11:26:33 Max_iter: 1000
At iteration 148, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  149 ; minimum lost =  0.6928576231002808 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0002823149843607098
lambda is : 0.006812920690579613, cost : 0.109 min
==========
Testing lambda: 0.01 starting at 2024-09-27 11:26:39 Max_iter: 1000
At iteration 19, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  20 ; minimum lost =  0.6931228041648865 ; diff loss =  9.5367431640625e-07 ; diff weight =  8.090410847216845e-05
lambda is : 0.010000000000000004, cost : 0.034 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 11:26:41 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931471824645996 ; diff loss =  1.7881393432617188e-07 ; diff weight =  8.409372094320133e-05
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.014677992676220709, cost : 0.019 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 11:26:42 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.02154434690031885, cost : 0.017 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 11:26:43 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.017 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 11:26:44 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.017 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 11:26:45 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.017 min
==========
Testing lambda: 0.1 starting at 2024-09-27 11:26:46 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.416012    0.183445          0.182336           11442  0.871827  0.246905  0.293024   0.295918  0.298969      0.659895       0.000315
0.000015    0.387762    0.203579          0.202279           10665  0.884615  0.258061  0.312732   0.304762  0.318408      0.662956       0.000130
0.000022    0.360893    0.223714          0.222222            9926  0.881775  0.278916  0.347769   0.362637  0.352941      0.666182       0.000173
0.000032    0.327771    0.248322          0.245014            9015  0.882974  0.267166  0.351806   0.370787  0.356757      0.669306       0.000404
0.000046    0.291194    0.275168          0.273504            8009  0.887728  0.280118  0.346547   0.382716  0.350282      0.672437       0.000476
Exporting resultDF
Exporting result Dict
Doublet Time elapsed: 5.481869026025136 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Eryth
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 11:27:19 Max_iter: 1000
At iteration 128, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  129 ; minimum lost =  0.6654396057128906 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.071120858675556e-09
lambda is : 9.999999999999997e-06, cost : 0.375 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 11:27:42 Max_iter: 1000
At iteration 127, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  128 ; minimum lost =  0.6681743860244751 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.0502481018193066e-07
lambda is : 1.4677992676220687e-05, cost : 0.357 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 11:28:03 Max_iter: 1000
At iteration 111, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  112 ; minimum lost =  0.6713287830352783 ; diff loss =  1.7881393432617188e-07 ; diff weight =  3.423246042189021e-08
lambda is : 2.1544346900318854e-05, cost : 0.319 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 11:28:23 Max_iter: 1000
At iteration 119, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  120 ; minimum lost =  0.6738374829292297 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.512204571620714e-08
lambda is : 3.16227766016838e-05, cost : 0.314 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 11:28:41 Max_iter: 1000
At iteration 112, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  113 ; minimum lost =  0.6763162016868591 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.5896139515803043e-08
lambda is : 4.6415888336127784e-05, cost : 0.282 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 11:28:58 Max_iter: 1000
At iteration 102, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  103 ; minimum lost =  0.6786993741989136 ; diff loss =  3.5762786865234375e-07 ; diff weight =  2.4704706902412e-07
lambda is : 6.81292069057961e-05, cost : 0.23 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 11:29:12 Max_iter: 1000
At iteration 102, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  102 ; minimum lost =  0.6806523203849792 ; diff loss =  0.0 ; diff weight =  1.2969936733497889e-06
lambda is : 9.999999999999991e-05, cost : 0.223 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 11:29:25 Max_iter: 1000
At iteration 91, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  91 ; minimum lost =  0.6822497248649597 ; diff loss =  0.0 ; diff weight =  8.78212702559722e-08
lambda is : 0.00014677992676220703, cost : 0.199 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 11:29:37 Max_iter: 1000
At iteration 89, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  90 ; minimum lost =  0.683429479598999 ; diff loss =  2.980232238769531e-07 ; diff weight =  3.0170198783707747e-07
lambda is : 0.0002154434690031884, cost : 0.157 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 11:29:47 Max_iter: 1000
At iteration 87, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  88 ; minimum lost =  0.6842656135559082 ; diff loss =  2.384185791015625e-07 ; diff weight =  2.1521974247207254e-07
lambda is : 0.00031622776601683783, cost : 0.145 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 11:29:56 Max_iter: 1000
At iteration 86, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  87 ; minimum lost =  0.6848881244659424 ; diff loss =  7.748603820800781e-07 ; diff weight =  9.125649853558571e-07
lambda is : 0.00046415888336127795, cost : 0.122 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 11:30:03 Max_iter: 1000
At iteration 88, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  89 ; minimum lost =  0.6854082345962524 ; diff loss =  9.5367431640625e-07 ; diff weight =  3.773581056520925e-07
lambda is : 0.0006812920690579617, cost : 0.108 min
==========
Testing lambda: 0.001 starting at 2024-09-27 11:30:09 Max_iter: 1000
At iteration 92, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  92 ; minimum lost =  0.6860348582267761 ; diff loss =  0.0 ; diff weight =  1.7336805058221216e-06
lambda is : 0.0010000000000000002, cost : 0.128 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 11:30:17 Max_iter: 1000
At iteration 97, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  98 ; minimum lost =  0.6870690584182739 ; diff loss =  1.1920928955078125e-07 ; diff weight =  4.683137788674685e-08
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.134 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 11:30:25 Max_iter: 1000
At iteration 103, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  104 ; minimum lost =  0.6882256269454956 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.148115640920878e-08
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.124 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 11:30:33 Max_iter: 1000
At iteration 114, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  115 ; minimum lost =  0.689259946346283 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.108122257344803e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.126 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 11:30:40 Max_iter: 1000
At iteration 139, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  140 ; minimum lost =  0.6902141571044922 ; diff loss =  1.7881393432617188e-07 ; diff weight =  1.034829892887501e-06
lambda is : 0.004641588833612781, cost : 0.132 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 11:30:48 Max_iter: 1000
At iteration 214, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  215 ; minimum lost =  0.6915854811668396 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0012077349238097668
lambda is : 0.006812920690579613, cost : 0.144 min
==========
Testing lambda: 0.01 starting at 2024-09-27 11:30:57 Max_iter: 1000
At iteration 148, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  149 ; minimum lost =  0.6924771666526794 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0005070426850579679
lambda is : 0.010000000000000004, cost : 0.107 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 11:31:03 Max_iter: 1000
At iteration 68, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  69 ; minimum lost =  0.6929656267166138 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00020901253446936607
lambda is : 0.014677992676220709, cost : 0.061 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 11:31:07 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931470036506653 ; diff loss =  3.5762786865234375e-07 ; diff weight =  0.00014512751658912748
lambda is : 0.02154434690031885, cost : 0.018 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 11:31:08 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.016 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 11:31:09 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.016 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 11:31:10 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-27 11:31:11 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.344641    0.096386          0.090909            9479  0.975469  0.709800  0.723468   0.636364  0.717949      0.665440   1.071121e-09
0.000015    0.319590    0.108434          0.090909            8790  0.965805  0.702906  0.611451   0.578947  0.611111      0.668174   1.050248e-07
0.000022    0.279123    0.120482          0.106061            7677  0.978419  0.726229  0.704554   0.650000  0.702703      0.671329   3.423246e-08
0.000032    0.238947    0.132530          0.121212            6572  0.995135  0.751656  0.667179   0.631579  0.666667      0.673837   3.512205e-08
0.000046    0.192299    0.156627          0.151515            5289  0.980693  0.760211  0.685517   0.666667  0.685714      0.676316   1.589614e-08
Exporting resultDF
Exporting result Dict
Eryth Time elapsed: 3.9989018559455873 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for HSPC
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 11:31:43 Max_iter: 1000
At iteration 179, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  180 ; minimum lost =  0.49329057335853577 ; diff loss =  5.662441253662109e-07 ; diff weight =  1.955470878556298e-07
lambda is : 9.999999999999997e-06, cost : 0.528 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 11:32:14 Max_iter: 1000
At iteration 169, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  170 ; minimum lost =  0.49899446964263916 ; diff loss =  5.960464477539063e-08 ; diff weight =  0.044596459716558456
lambda is : 1.4677992676220687e-05, cost : 0.464 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 11:32:42 Max_iter: 1000
At iteration 174, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  174 ; minimum lost =  0.5029239654541016 ; diff loss =  0.0 ; diff weight =  1.135823481490661e-06
lambda is : 2.1544346900318854e-05, cost : 0.479 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 11:33:11 Max_iter: 1000
At iteration 170, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  171 ; minimum lost =  0.5092449188232422 ; diff loss =  4.76837158203125e-07 ; diff weight =  5.009778760722838e-07
lambda is : 3.16227766016838e-05, cost : 0.421 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 11:33:36 Max_iter: 1000
At iteration 153, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  154 ; minimum lost =  0.5292061567306519 ; diff loss =  1.7881393432617188e-07 ; diff weight =  0.03729572519659996
lambda is : 4.6415888336127784e-05, cost : 0.388 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 11:33:59 Max_iter: 1000
At iteration 157, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  158 ; minimum lost =  0.5247781276702881 ; diff loss =  1.7881393432617188e-07 ; diff weight =  1.239047406897953e-07
lambda is : 6.81292069057961e-05, cost : 0.364 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 11:34:21 Max_iter: 1000
At iteration 154, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  155 ; minimum lost =  0.5334330797195435 ; diff loss =  2.980232238769531e-07 ; diff weight =  2.279164634799713e-09
lambda is : 9.999999999999991e-05, cost : 0.344 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 11:34:42 Max_iter: 1000
At iteration 146, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  144 ; minimum lost =  0.5415235757827759 ; diff loss =  5.364418029785156e-07 ; diff weight =  0.03996783122420311
lambda is : 0.00014677992676220703, cost : 0.292 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 11:34:59 Max_iter: 1000
At iteration 137, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  138 ; minimum lost =  0.5508516430854797 ; diff loss =  3.5762786865234375e-07 ; diff weight =  3.725355668393604e-07
lambda is : 0.0002154434690031884, cost : 0.267 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 11:35:15 Max_iter: 1000
At iteration 134, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  135 ; minimum lost =  0.5582137703895569 ; diff loss =  2.384185791015625e-07 ; diff weight =  1.9474803991670342e-07
lambda is : 0.00031622776601683783, cost : 0.244 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 11:35:30 Max_iter: 1000
At iteration 122, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  123 ; minimum lost =  0.5696008205413818 ; diff loss =  7.152557373046875e-07 ; diff weight =  6.817021471761109e-07
lambda is : 0.00046415888336127795, cost : 0.196 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 11:35:42 Max_iter: 1000
At iteration 118, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  119 ; minimum lost =  0.5776714086532593 ; diff loss =  5.960464477539063e-08 ; diff weight =  5.375213163461012e-08
lambda is : 0.0006812920690579617, cost : 0.186 min
==========
Testing lambda: 0.001 starting at 2024-09-27 11:35:53 Max_iter: 1000
At iteration 113, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  114 ; minimum lost =  0.5862125754356384 ; diff loss =  4.76837158203125e-07 ; diff weight =  1.341223168083161e-07
lambda is : 0.0010000000000000002, cost : 0.159 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 11:36:02 Max_iter: 1000
At iteration 112, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  113 ; minimum lost =  0.6003925204277039 ; diff loss =  1.7881393432617188e-07 ; diff weight =  2.98120106378974e-08
lambda is : 0.0014677992676220694, cost : 0.147 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 11:36:11 Max_iter: 1000
At iteration 113, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  114 ; minimum lost =  0.6133769750595093 ; diff loss =  2.384185791015625e-07 ; diff weight =  5.373291145360781e-08
lambda is : 0.0021544346900318843, cost : 0.139 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 11:36:20 Max_iter: 1000
At iteration 117, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  118 ; minimum lost =  0.6322915554046631 ; diff loss =  2.384185791015625e-07 ; diff weight =  2.9996294870215934e-07
lambda is : 0.003162277660168382, cost : 0.137 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 11:36:28 Max_iter: 1000
At iteration 115, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  116 ; minimum lost =  0.656745970249176 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.991006849446421e-07
lambda is : 0.004641588833612781, cost : 0.135 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 11:36:36 Max_iter: 1000
At iteration 125, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  126 ; minimum lost =  0.670193076133728 ; diff loss =  1.1920928955078125e-07 ; diff weight =  8.536046607332537e-07
lambda is : 0.006812920690579613, cost : 0.136 min
==========
Testing lambda: 0.01 starting at 2024-09-27 11:36:44 Max_iter: 1000
At iteration 150, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  151 ; minimum lost =  0.6807683110237122 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.61903754917148e-07
lambda is : 0.010000000000000004, cost : 0.147 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 11:36:53 Max_iter: 1000
At iteration 218, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  219 ; minimum lost =  0.6895310878753662 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.001074857427738607
lambda is : 0.014677992676220709, cost : 0.145 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 11:37:02 Max_iter: 1000
At iteration 113, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  114 ; minimum lost =  0.6919881105422974 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0002873852790798992
lambda is : 0.02154434690031885, cost : 0.085 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 11:37:07 Max_iter: 1000
At iteration 34, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  35 ; minimum lost =  0.6930797100067139 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00019841929315589368
lambda is : 0.0316227766016838, cost : 0.041 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 11:37:09 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.017 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 11:37:10 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.017 min
==========
Testing lambda: 0.1 starting at 2024-09-27 11:37:11 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.466223    0.171004          0.170404           12823  0.999782  0.950980  0.518910   0.272189  0.427907      0.493291   1.955471e-07
0.000015    0.435573    0.189591          0.188341           11980  0.999825  0.960000  0.604535   0.368000  0.538012      0.498994   4.459646e-02
0.000022    0.408486    0.204461          0.206278           11235  0.999825  0.960000  0.625081   0.393162  0.564417      0.502924   1.135823e-06
0.000032    0.372237    0.230483          0.228700           10238  0.999869  0.969388  0.687107   0.474227  0.643357      0.509245   5.009779e-07
0.000046    0.342677    0.252788          0.255605            9425  0.999869  0.969388  0.701851   0.494624  0.661871      0.529206   3.729573e-02
Exporting resultDF
Exporting result Dict
HSPC Time elapsed: 5.618845415115357 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for ILC
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 11:37:43 Max_iter: 1000
At iteration 278, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  279 ; minimum lost =  0.6651358008384705 ; diff loss =  5.960464477539063e-08 ; diff weight =  8.267775086778784e-08
lambda is : 9.999999999999997e-06, cost : 0.463 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 11:38:10 Max_iter: 1000
At iteration 281, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  281 ; minimum lost =  0.6686677932739258 ; diff loss =  0.0 ; diff weight =  1.216387863678392e-05
lambda is : 1.4677992676220687e-05, cost : 0.441 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 11:38:37 Max_iter: 1000
At iteration 293, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  294 ; minimum lost =  0.6719617247581482 ; diff loss =  4.76837158203125e-07 ; diff weight =  8.025599527172744e-06
lambda is : 2.1544346900318854e-05, cost : 0.408 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 11:39:01 Max_iter: 1000
At iteration 296, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  297 ; minimum lost =  0.6751499176025391 ; diff loss =  4.76837158203125e-07 ; diff weight =  7.547698146481707e-07
lambda is : 3.16227766016838e-05, cost : 0.396 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 11:39:25 Max_iter: 1000
At iteration 303, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  304 ; minimum lost =  0.6783497929573059 ; diff loss =  5.364418029785156e-07 ; diff weight =  9.285671694669873e-06
lambda is : 4.6415888336127784e-05, cost : 0.368 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 11:39:47 Max_iter: 1000
At iteration 244, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  245 ; minimum lost =  0.6816544532775879 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00046646446571685374
lambda is : 6.81292069057961e-05, cost : 0.288 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 11:40:04 Max_iter: 1000
At iteration 220, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  221 ; minimum lost =  0.684422492980957 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00035280472366139293
lambda is : 9.999999999999991e-05, cost : 0.255 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 11:40:20 Max_iter: 1000
At iteration 201, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  202 ; minimum lost =  0.6867525577545166 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00039941220893524587
lambda is : 0.00014677992676220703, cost : 0.216 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 11:40:33 Max_iter: 1000
At iteration 176, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  177 ; minimum lost =  0.6886292695999146 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00035386451054364443
lambda is : 0.0002154434690031884, cost : 0.172 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 11:40:43 Max_iter: 1000
At iteration 160, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  161 ; minimum lost =  0.6900424361228943 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00032311279210262
lambda is : 0.00031622776601683783, cost : 0.152 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 11:40:52 Max_iter: 1000
At iteration 147, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  148 ; minimum lost =  0.6910456418991089 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003165068628732115
lambda is : 0.00046415888336127795, cost : 0.126 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 11:41:00 Max_iter: 1000
At iteration 131, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  132 ; minimum lost =  0.6917125582695007 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003068908699788153
lambda is : 0.0006812920690579617, cost : 0.103 min
==========
Testing lambda: 0.001 starting at 2024-09-27 11:41:06 Max_iter: 1000
At iteration 119, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  120 ; minimum lost =  0.6921566724777222 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00025800641742534935
lambda is : 0.0010000000000000002, cost : 0.096 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 11:41:12 Max_iter: 1000
At iteration 106, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  107 ; minimum lost =  0.6924512386322021 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00024486376787535846
lambda is : 0.0014677992676220694, cost : 0.086 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 11:41:17 Max_iter: 1000
At iteration 90, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  91 ; minimum lost =  0.6926659941673279 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00024654087610542774
lambda is : 0.0021544346900318843, cost : 0.074 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 11:41:21 Max_iter: 1000
At iteration 71, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  72 ; minimum lost =  0.6928715705871582 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00022886887018103153
lambda is : 0.003162277660168382, cost : 0.061 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 11:41:25 Max_iter: 1000
At iteration 39, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  40 ; minimum lost =  0.6930667161941528 ; diff loss =  7.152557373046875e-07 ; diff weight =  0.00023222198069561273
lambda is : 0.004641588833612781, cost : 0.06 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 11:41:29 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931472420692444 ; diff loss =  1.1920928955078125e-07 ; diff weight =  0.00010297141125192866
lambda is : 0.006812920690579613, cost : 0.058 min
==========
Testing lambda: 0.01 starting at 2024-09-27 11:41:32 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.010000000000000004, cost : 0.014 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 11:41:33 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.014677992676220709, cost : 0.014 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 11:41:34 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.02154434690031885, cost : 0.013 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 11:41:34 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.013 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 11:41:35 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.013 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 11:41:36 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.013 min
==========
Testing lambda: 0.1 starting at 2024-09-27 11:41:37 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.014 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.364274    0.105691          0.108911           10019  0.999390  0.883416  0.739011   0.633333  0.730769      0.665136   8.267775e-08
0.000015    0.332970    0.121951          0.118812            9158  0.999216  0.891643  0.779120   0.703704  0.775510      0.668668   1.216388e-05
0.000022    0.293812    0.138211          0.138614            8081  0.999157  0.873255  0.752108   0.692308  0.750000      0.671962   8.025600e-06
0.000032    0.259780    0.154472          0.148515            7145  0.999592  0.897556  0.799807   0.782609  0.800000      0.675150   7.547698e-07
0.000046    0.217641    0.178862          0.178218            5986  0.999466  0.889822  0.772292   0.772727  0.772727      0.678350   9.285672e-06
Exporting resultDF
Exporting result Dict
ILC Time elapsed: 4.066115303834279 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for MAIT
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 11:42:10 Max_iter: 1000
At iteration 180, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  180 ; minimum lost =  0.5967815518379211 ; diff loss =  0.0 ; diff weight =  3.406020141483168e-07
lambda is : 9.999999999999997e-06, cost : 0.411 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 11:42:35 Max_iter: 1000
At iteration 178, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  179 ; minimum lost =  0.601194441318512 ; diff loss =  1.1920928955078125e-07 ; diff weight =  9.302200965066731e-08
lambda is : 1.4677992676220687e-05, cost : 0.405 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 11:42:59 Max_iter: 1000
At iteration 177, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  178 ; minimum lost =  0.6053979992866516 ; diff loss =  2.384185791015625e-07 ; diff weight =  1.4897572064853648e-09
lambda is : 2.1544346900318854e-05, cost : 0.374 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 11:43:21 Max_iter: 1000
At iteration 173, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  174 ; minimum lost =  0.6102941036224365 ; diff loss =  1.7881393432617188e-07 ; diff weight =  1.752929890130872e-08
lambda is : 3.16227766016838e-05, cost : 0.349 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 11:43:42 Max_iter: 1000
At iteration 168, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  168 ; minimum lost =  0.6153196692466736 ; diff loss =  0.0 ; diff weight =  7.064820124469406e-07
lambda is : 4.6415888336127784e-05, cost : 0.319 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 11:44:01 Max_iter: 1000
At iteration 164, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  165 ; minimum lost =  0.6199250817298889 ; diff loss =  2.980232238769531e-07 ; diff weight =  2.2016932632595854e-07
lambda is : 6.81292069057961e-05, cost : 0.285 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 11:44:18 Max_iter: 1000
At iteration 160, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  161 ; minimum lost =  0.6247395873069763 ; diff loss =  1.7881393432617188e-07 ; diff weight =  2.1267858585360955e-07
lambda is : 9.999999999999991e-05, cost : 0.268 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 11:44:35 Max_iter: 1000
At iteration 157, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  158 ; minimum lost =  0.6292645335197449 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.0567085812217556e-07
lambda is : 0.00014677992676220703, cost : 0.24 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 11:44:49 Max_iter: 1000
At iteration 152, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  152 ; minimum lost =  0.6335318684577942 ; diff loss =  0.0 ; diff weight =  9.538084810856162e-08
lambda is : 0.0002154434690031884, cost : 0.229 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 11:45:03 Max_iter: 1000
At iteration 151, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  152 ; minimum lost =  0.6377378106117249 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.481038509609789e-07
lambda is : 0.00031622776601683783, cost : 0.202 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 11:45:15 Max_iter: 1000
At iteration 150, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  150 ; minimum lost =  0.6414221525192261 ; diff loss =  0.0 ; diff weight =  2.941158072644612e-07
lambda is : 0.00046415888336127795, cost : 0.19 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 11:45:26 Max_iter: 1000
At iteration 152, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  153 ; minimum lost =  0.6449975371360779 ; diff loss =  4.76837158203125e-07 ; diff weight =  1.0937798151644529e-06
lambda is : 0.0006812920690579617, cost : 0.164 min
==========
Testing lambda: 0.001 starting at 2024-09-27 11:45:36 Max_iter: 1000
At iteration 157, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  158 ; minimum lost =  0.6482003331184387 ; diff loss =  4.172325134277344e-07 ; diff weight =  3.205942391559802e-07
lambda is : 0.0010000000000000002, cost : 0.171 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 11:45:46 Max_iter: 1000
At iteration 166, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  167 ; minimum lost =  0.6507209539413452 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.3483430755533163e-09
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.181 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 11:45:57 Max_iter: 1000
At iteration 180, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  181 ; minimum lost =  0.6519315838813782 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.1933295240851294e-07
lambda is : 0.0021544346900318843, cost : 0.173 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 11:46:08 Max_iter: 1000
At iteration 197, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  198 ; minimum lost =  0.6546663045883179 ; diff loss =  3.5762786865234375e-07 ; diff weight =  3.099122347638428e-10
lambda is : 0.003162277660168382, cost : 0.18 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 11:46:18 Max_iter: 1000
At iteration 224, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  224 ; minimum lost =  0.6596443057060242 ; diff loss =  0.0 ; diff weight =  7.86914006312145e-06
lambda is : 0.004641588833612781, cost : 0.193 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 11:46:30 Max_iter: 1000
At iteration 276, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  277 ; minimum lost =  0.6664385199546814 ; diff loss =  6.556510925292969e-07 ; diff weight =  0.0035131352487951517
lambda is : 0.006812920690579613, cost : 0.182 min
==========
Testing lambda: 0.01 starting at 2024-09-27 11:46:41 Max_iter: 1000
At iteration 286, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  287 ; minimum lost =  0.6732654571533203 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0009915843838825822
lambda is : 0.010000000000000004, cost : 0.186 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 11:46:52 Max_iter: 1000
At iteration 243, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  244 ; minimum lost =  0.6790387630462646 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005877821822650731
lambda is : 0.014677992676220709, cost : 0.16 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 11:47:02 Max_iter: 1000
At iteration 210, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  211 ; minimum lost =  0.6843676567077637 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0004094421456102282
lambda is : 0.02154434690031885, cost : 0.141 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 11:47:10 Max_iter: 1000
At iteration 177, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  178 ; minimum lost =  0.6890814900398254 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003331747429911047
lambda is : 0.0316227766016838, cost : 0.121 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 11:47:17 Max_iter: 1000
At iteration 96, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  97 ; minimum lost =  0.6923662424087524 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.00024127893266268075
lambda is : 0.04641588833612786, cost : 0.076 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 11:47:22 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.018 min
==========
Testing lambda: 0.1 starting at 2024-09-27 11:47:23 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.015 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.351949    0.095520          0.096747            9680  0.996200  0.963519  0.898788   0.847645  0.900000      0.596782   3.406020e-07
0.000015    0.328061    0.105402          0.105922            9023  0.996392  0.962721  0.907128   0.868571  0.908819      0.601194   9.302201e-08
0.000022    0.292103    0.120224          0.120934            8034  0.995933  0.964029  0.913542   0.883382  0.915408      0.605398   1.489757e-09
0.000032    0.259599    0.135046          0.136781            7140  0.996816  0.965747  0.916308   0.888563  0.918182      0.610294   1.752930e-08
0.000046    0.225204    0.154809          0.156797            6194  0.997168  0.962841  0.914574   0.888235  0.916540      0.615320   7.064820e-07
Exporting resultDF
Exporting result Dict
MAIT Time elapsed: 5.359356768925985 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for NK
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 11:47:53 Max_iter: 1000
At iteration 205, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  206 ; minimum lost =  0.2899399399757385 ; diff loss =  5.364418029785156e-07 ; diff weight =  3.301425977042527e-08
lambda is : 9.999999999999997e-06, cost : 0.449 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 11:48:20 Max_iter: 1000
At iteration 196, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  197 ; minimum lost =  0.2983434200286865 ; diff loss =  8.642673492431641e-07 ; diff weight =  9.658104005438872e-08
lambda is : 1.4677992676220687e-05, cost : 0.431 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 11:48:46 Max_iter: 1000
At iteration 195, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  196 ; minimum lost =  0.3088923692703247 ; diff loss =  5.960464477539063e-08 ; diff weight =  5.3054794335594124e-08
lambda is : 2.1544346900318854e-05, cost : 0.419 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 11:49:12 Max_iter: 1000
At iteration 192, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  193 ; minimum lost =  0.3172314167022705 ; diff loss =  2.9802322387695312e-08 ; diff weight =  5.503961020281167e-08
lambda is : 3.16227766016838e-05, cost : 0.395 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 11:49:35 Max_iter: 1000
At iteration 192, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  193 ; minimum lost =  0.32666516304016113 ; diff loss =  5.960464477539062e-07 ; diff weight =  9.150161162096992e-08
lambda is : 4.6415888336127784e-05, cost : 0.363 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 11:49:57 Max_iter: 1000
At iteration 189, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  190 ; minimum lost =  0.3359358012676239 ; diff loss =  5.066394805908203e-07 ; diff weight =  3.567949988791952e-07
lambda is : 6.81292069057961e-05, cost : 0.33 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 11:50:17 Max_iter: 1000
At iteration 189, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  190 ; minimum lost =  0.34437501430511475 ; diff loss =  6.258487701416016e-07 ; diff weight =  3.7133710861780855e-07
lambda is : 9.999999999999991e-05, cost : 0.31 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 11:50:35 Max_iter: 1000
At iteration 191, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  192 ; minimum lost =  0.3543388247489929 ; diff loss =  3.5762786865234375e-07 ; diff weight =  1.4380258051005512e-07
lambda is : 0.00014677992676220703, cost : 0.3 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 11:50:53 Max_iter: 1000
At iteration 190, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  191 ; minimum lost =  0.3659953773021698 ; diff loss =  2.9802322387695312e-08 ; diff weight =  2.0664360889099953e-08
lambda is : 0.0002154434690031884, cost : 0.287 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 11:51:11 Max_iter: 1000
At iteration 190, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  191 ; minimum lost =  0.3769795894622803 ; diff loss =  5.662441253662109e-07 ; diff weight =  6.312301081834448e-08
lambda is : 0.00031622776601683783, cost : 0.25 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 11:51:26 Max_iter: 1000
At iteration 196, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  197 ; minimum lost =  0.3862370550632477 ; diff loss =  2.682209014892578e-07 ; diff weight =  2.518117696581612e-07
lambda is : 0.00046415888336127795, cost : 0.238 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 11:51:40 Max_iter: 1000
At iteration 200, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  201 ; minimum lost =  0.39848220348358154 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.804758831269737e-08
lambda is : 0.0006812920690579617, cost : 0.225 min
==========
Testing lambda: 0.001 starting at 2024-09-27 11:51:54 Max_iter: 1000
At iteration 205, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  206 ; minimum lost =  0.412176251411438 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.7065522207058166e-08
lambda is : 0.0010000000000000002, cost : 0.222 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 11:52:07 Max_iter: 1000
At iteration 219, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  220 ; minimum lost =  0.4259694218635559 ; diff loss =  2.086162567138672e-07 ; diff weight =  5.265460458758753e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.21 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 11:52:19 Max_iter: 1000
At iteration 253, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  254 ; minimum lost =  0.4424334168434143 ; diff loss =  2.9802322387695312e-08 ; diff weight =  1.2822927430988784e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.231 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 11:52:33 Max_iter: 1000
At iteration 326, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  327 ; minimum lost =  0.46276330947875977 ; diff loss =  1.1920928955078125e-07 ; diff weight =  5.405711362982402e-07
lambda is : 0.003162277660168382, cost : 0.243 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 11:52:48 Max_iter: 1000
At iteration 335, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  336 ; minimum lost =  0.48469996452331543 ; diff loss =  5.960464477539063e-08 ; diff weight =  0.001345858327113092
lambda is : 0.004641588833612781, cost : 0.221 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 11:53:01 Max_iter: 1000
At iteration 352, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  353 ; minimum lost =  0.505876362323761 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0008497707895003259
lambda is : 0.006812920690579613, cost : 0.227 min
==========
Testing lambda: 0.01 starting at 2024-09-27 11:53:15 Max_iter: 1000
At iteration 347, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  348 ; minimum lost =  0.5256011486053467 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0006420940044336021
lambda is : 0.010000000000000004, cost : 0.222 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 11:53:28 Max_iter: 1000
At iteration 381, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  382 ; minimum lost =  0.5442119240760803 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0007110476144589484
lambda is : 0.014677992676220709, cost : 0.242 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 11:53:43 Max_iter: 1000
At iteration 325, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  326 ; minimum lost =  0.5638973116874695 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005545017193071544
lambda is : 0.02154434690031885, cost : 0.208 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 11:53:55 Max_iter: 1000
At iteration 342, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  343 ; minimum lost =  0.5869462490081787 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005370030412450433
lambda is : 0.0316227766016838, cost : 0.218 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 11:54:08 Max_iter: 1000
At iteration 265, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  266 ; minimum lost =  0.6129529476165771 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0005554850795306265
lambda is : 0.04641588833612786, cost : 0.174 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 11:54:19 Max_iter: 1000
At iteration 290, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  291 ; minimum lost =  0.6399782299995422 ; diff loss =  4.172325134277344e-07 ; diff weight =  0.0004551179299596697
lambda is : 0.0681292069057962, cost : 0.188 min
==========
Testing lambda: 0.1 starting at 2024-09-27 11:54:30 Max_iter: 1000
At iteration 250, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  251 ; minimum lost =  0.6655635833740234 ; diff loss =  7.152557373046875e-07 ; diff weight =  0.0003871128137689084
lambda is : 0.10000000000000002, cost : 0.165 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.378818    0.108298          0.108002           10419  0.991597  0.970761  0.894383   0.842777  0.902564      0.289940   3.301426e-08
0.000015    0.350058    0.119848          0.119565            9628  0.992815  0.972665  0.907116   0.864157  0.914682      0.298343   9.658104e-08
0.000022    0.324026    0.131861          0.131822            8912  0.990887  0.972383  0.910777   0.871181  0.918190      0.308892   5.305479e-08
0.000032    0.292067    0.148032          0.148011            8033  0.992696  0.974966  0.920214   0.887300  0.927065      0.317231   5.503961e-08
0.000046    0.261089    0.166328          0.166281            7181  0.993444  0.976959  0.924191   0.897523  0.930912      0.326665   9.150161e-08
Exporting resultDF
Exporting result Dict
NK Time elapsed: 6.896983071168264 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for NK_CD56bright
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 11:55:10 Max_iter: 1000
At iteration 284, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  285 ; minimum lost =  0.6421271562576294 ; diff loss =  4.172325134277344e-07 ; diff weight =  3.0553571832570015e-06
lambda is : 9.999999999999997e-06, cost : 0.469 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 11:55:39 Max_iter: 1000
At iteration 284, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  285 ; minimum lost =  0.6457490921020508 ; diff loss =  2.980232238769531e-07 ; diff weight =  2.804586756610661e-06
lambda is : 1.4677992676220687e-05, cost : 0.427 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 11:56:04 Max_iter: 1000
At iteration 286, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  287 ; minimum lost =  0.6495499014854431 ; diff loss =  5.364418029785156e-07 ; diff weight =  3.4883844364230754e-06
lambda is : 2.1544346900318854e-05, cost : 0.42 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 11:56:29 Max_iter: 1000
At iteration 287, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  287 ; minimum lost =  0.6534544229507446 ; diff loss =  0.0 ; diff weight =  2.435406349832192e-05
lambda is : 3.16227766016838e-05, cost : 0.404 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 11:56:54 Max_iter: 1000
At iteration 314, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  314 ; minimum lost =  0.6572897434234619 ; diff loss =  0.0 ; diff weight =  7.198991625045892e-06
lambda is : 4.6415888336127784e-05, cost : 0.404 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 11:57:18 Max_iter: 1000
At iteration 343, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  344 ; minimum lost =  0.6611484289169312 ; diff loss =  2.980232238769531e-07 ; diff weight =  2.3201116619020468e-06
lambda is : 6.81292069057961e-05, cost : 0.388 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 11:57:41 Max_iter: 1000
At iteration 326, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  326 ; minimum lost =  0.6647156476974487 ; diff loss =  0.0 ; diff weight =  0.008557580411434174
lambda is : 9.999999999999991e-05, cost : 0.323 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 11:58:01 Max_iter: 1000
At iteration 302, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  303 ; minimum lost =  0.6676737070083618 ; diff loss =  3.5762786865234375e-07 ; diff weight =  2.325473587916349e-06
lambda is : 0.00014677992676220703, cost : 0.312 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 11:58:19 Max_iter: 1000
At iteration 280, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  281 ; minimum lost =  0.6702544689178467 ; diff loss =  5.960464477539062e-07 ; diff weight =  1.1923726788154454e-06
lambda is : 0.0002154434690031884, cost : 0.275 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 11:58:36 Max_iter: 1000
At iteration 267, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  268 ; minimum lost =  0.6724742650985718 ; diff loss =  4.172325134277344e-07 ; diff weight =  5.365408242141712e-07
lambda is : 0.00031622776601683783, cost : 0.249 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 11:58:51 Max_iter: 1000
At iteration 258, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  259 ; minimum lost =  0.6744092702865601 ; diff loss =  4.172325134277344e-07 ; diff weight =  1.0730473150033504e-06
lambda is : 0.00046415888336127795, cost : 0.226 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 11:59:04 Max_iter: 1000
At iteration 248, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  249 ; minimum lost =  0.676264226436615 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.009817717596888542
lambda is : 0.0006812920690579617, cost : 0.18 min
==========
Testing lambda: 0.001 starting at 2024-09-27 11:59:15 Max_iter: 1000
At iteration 264, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  265 ; minimum lost =  0.6779254078865051 ; diff loss =  2.384185791015625e-07 ; diff weight =  5.961122496955795e-06
lambda is : 0.0010000000000000002, cost : 0.199 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 11:59:27 Max_iter: 1000
At iteration 288, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  289 ; minimum lost =  0.6798005700111389 ; diff loss =  7.152557373046875e-07 ; diff weight =  0.0028757683467119932
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.194 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 11:59:39 Max_iter: 1000
At iteration 283, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  284 ; minimum lost =  0.681726336479187 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0012791737681254745
lambda is : 0.0021544346900318843, cost : 0.188 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 11:59:50 Max_iter: 1000
At iteration 257, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  258 ; minimum lost =  0.6835651397705078 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0008034724160097539
lambda is : 0.003162277660168382, cost : 0.172 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 12:00:00 Max_iter: 1000
At iteration 237, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  238 ; minimum lost =  0.6853445172309875 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005784849636256695
lambda is : 0.004641588833612781, cost : 0.158 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 12:00:10 Max_iter: 1000
At iteration 211, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  212 ; minimum lost =  0.6871625781059265 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0004338672151789069
lambda is : 0.006812920690579613, cost : 0.143 min
==========
Testing lambda: 0.01 starting at 2024-09-27 12:00:19 Max_iter: 1000
At iteration 180, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  181 ; minimum lost =  0.6890023946762085 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003339232935104519
lambda is : 0.010000000000000004, cost : 0.124 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 12:00:26 Max_iter: 1000
At iteration 153, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  154 ; minimum lost =  0.6907722353935242 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00030788968433625996
lambda is : 0.014677992676220709, cost : 0.108 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 12:00:32 Max_iter: 1000
At iteration 138, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  139 ; minimum lost =  0.6921473145484924 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0003248668508604169
lambda is : 0.02154434690031885, cost : 0.099 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 12:00:38 Max_iter: 1000
At iteration 43, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  44 ; minimum lost =  0.6930402517318726 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.00023220060393214226
lambda is : 0.0316227766016838, cost : 0.046 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 12:00:41 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.019 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 12:00:42 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-27 12:00:43 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.378272    0.113530          0.114851           10404  0.999341  0.959971  0.850387   0.777108  0.848684      0.642127       0.000003
0.000015    0.342496    0.129082          0.128713            9420  0.999575  0.968406  0.878505   0.797619  0.875817      0.645749       0.000003
0.000022    0.311482    0.143079          0.142574            8567  0.999552  0.969090  0.880083   0.818750  0.879195      0.649550       0.000003
0.000032    0.280141    0.158631          0.158416            7705  0.999382  0.965387  0.883431   0.837662  0.883562      0.653454       0.000024
0.000046    0.239602    0.180404          0.180198            6590  0.999506  0.966728  0.906329   0.867550  0.906574      0.657290       0.000007
Exporting resultDF
Exporting result Dict
NK_CD56bright Time elapsed: 5.690403298536936 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for NK_Proliferating
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 12:01:15 Max_iter: 1000
At iteration 148, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  149 ; minimum lost =  0.6377694010734558 ; diff loss =  5.960464477539063e-08 ; diff weight =  7.520065459232228e-09
lambda is : 9.999999999999997e-06, cost : 0.456 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 12:01:42 Max_iter: 1000
At iteration 146, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  147 ; minimum lost =  0.6405522227287292 ; diff loss =  3.5762786865234375e-07 ; diff weight =  2.1682144790702296e-07
lambda is : 1.4677992676220687e-05, cost : 0.44 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 12:02:09 Max_iter: 1000
At iteration 145, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  146 ; minimum lost =  0.6432443857192993 ; diff loss =  3.5762786865234375e-07 ; diff weight =  1.302011156667504e-07
lambda is : 2.1544346900318854e-05, cost : 0.423 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 12:02:34 Max_iter: 1000
At iteration 146, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  147 ; minimum lost =  0.6461436152458191 ; diff loss =  1.7881393432617188e-07 ; diff weight =  2.0980539972015322e-08
lambda is : 3.16227766016838e-05, cost : 0.42 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 12:02:59 Max_iter: 1000
At iteration 142, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  143 ; minimum lost =  0.6494143009185791 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.2872307308953168e-07
lambda is : 4.6415888336127784e-05, cost : 0.361 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 12:03:21 Max_iter: 1000
At iteration 139, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  140 ; minimum lost =  0.6526511907577515 ; diff loss =  2.980232238769531e-07 ; diff weight =  1.1387680842744885e-07
lambda is : 6.81292069057961e-05, cost : 0.344 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 12:03:41 Max_iter: 1000
At iteration 138, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  139 ; minimum lost =  0.656082808971405 ; diff loss =  4.76837158203125e-07 ; diff weight =  1.6470075934194028e-06
lambda is : 9.999999999999991e-05, cost : 0.296 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 12:03:59 Max_iter: 1000
At iteration 137, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  138 ; minimum lost =  0.6595278382301331 ; diff loss =  2.980232238769531e-07 ; diff weight =  3.4212637167740922e-09
lambda is : 0.00014677992676220703, cost : 0.299 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 12:04:17 Max_iter: 1000
At iteration 137, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  138 ; minimum lost =  0.6627696752548218 ; diff loss =  3.5762786865234375e-07 ; diff weight =  7.081011688114813e-08
lambda is : 0.0002154434690031884, cost : 0.263 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 12:04:33 Max_iter: 1000
At iteration 137, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  138 ; minimum lost =  0.6658332943916321 ; diff loss =  2.980232238769531e-07 ; diff weight =  3.1679846301813086e-08
lambda is : 0.00031622776601683783, cost : 0.236 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 12:04:47 Max_iter: 1000
At iteration 137, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  138 ; minimum lost =  0.6686141490936279 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.0749184653491284e-08
lambda is : 0.00046415888336127795, cost : 0.204 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 12:04:59 Max_iter: 1000
At iteration 139, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  140 ; minimum lost =  0.6709628105163574 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.9692342685148105e-08
lambda is : 0.0006812920690579617, cost : 0.189 min
==========
Testing lambda: 0.001 starting at 2024-09-27 12:05:11 Max_iter: 1000
At iteration 144, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  145 ; minimum lost =  0.672976553440094 ; diff loss =  2.980232238769531e-07 ; diff weight =  7.00544333653852e-08
lambda is : 0.0010000000000000002, cost : 0.166 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 12:05:21 Max_iter: 1000
At iteration 155, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  156 ; minimum lost =  0.6750388741493225 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.477674764302719e-08
lambda is : 0.0014677992676220694, cost : 0.168 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 12:05:31 Max_iter: 1000
At iteration 176, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  177 ; minimum lost =  0.6773570775985718 ; diff loss =  1.1920928955078125e-07 ; diff weight =  7.647916078212802e-08
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.164 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 12:05:41 Max_iter: 1000
At iteration 228, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  229 ; minimum lost =  0.6801337599754333 ; diff loss =  5.364418029785156e-07 ; diff weight =  8.108307270049409e-07
lambda is : 0.003162277660168382, cost : 0.18 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 12:05:51 Max_iter: 1000
At iteration 273, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  274 ; minimum lost =  0.6832442879676819 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0007604967686347663
lambda is : 0.004641588833612781, cost : 0.183 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 12:06:02 Max_iter: 1000
At iteration 260, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  261 ; minimum lost =  0.685384213924408 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0006970995455048978
lambda is : 0.006812920690579613, cost : 0.172 min
==========
Testing lambda: 0.01 starting at 2024-09-27 12:06:13 Max_iter: 1000
At iteration 233, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  234 ; minimum lost =  0.6871566772460938 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006772370543330908
lambda is : 0.010000000000000004, cost : 0.156 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 12:06:22 Max_iter: 1000
At iteration 223, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  224 ; minimum lost =  0.6889485716819763 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0006151432171463966
lambda is : 0.014677992676220709, cost : 0.151 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 12:06:31 Max_iter: 1000
At iteration 201, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  202 ; minimum lost =  0.6907171607017517 ; diff loss =  7.152557373046875e-07 ; diff weight =  0.0002925492881331593
lambda is : 0.02154434690031885, cost : 0.138 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 12:06:39 Max_iter: 1000
At iteration 182, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  183 ; minimum lost =  0.6922192573547363 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0004513454914558679
lambda is : 0.0316227766016838, cost : 0.126 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 12:06:47 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931469440460205 ; diff loss =  4.172325134277344e-07 ; diff weight =  0.0003195624449290335
lambda is : 0.04641588833612786, cost : 0.019 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 12:06:48 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-27 12:06:49 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.413722    0.182039          0.186186           11379  0.991393  0.848729  0.766797   0.666667  0.760870      0.637769   7.520065e-09
0.000015    0.388162    0.201456          0.201201           10676  0.993245  0.846439  0.779192   0.708333  0.777143      0.640552   2.168214e-07
0.000022    0.363583    0.218447          0.222222           10000  0.998871  0.879400  0.805470   0.724490  0.802260      0.643244   1.302011e-07
0.000032    0.333951    0.242718          0.243243            9185  0.997781  0.868307  0.778558   0.696970  0.775281      0.646144   2.098054e-08
0.000046    0.302320    0.264563          0.267267            8315  0.997928  0.876468  0.775837   0.712766  0.774566      0.649414   1.287231e-07
Exporting resultDF
Exporting result Dict
NK_Proliferating Time elapsed: 5.735062936941783 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Plasmablast
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 12:07:22 Max_iter: 1000
At iteration 119, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  119 ; minimum lost =  0.6339702606201172 ; diff loss =  0.0 ; diff weight =  4.919104412692832e-07
lambda is : 9.999999999999997e-06, cost : 0.463 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 12:07:50 Max_iter: 1000
At iteration 123, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  124 ; minimum lost =  0.6365237236022949 ; diff loss =  2.980232238769531e-07 ; diff weight =  1.8030500825716445e-07
lambda is : 1.4677992676220687e-05, cost : 0.413 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 12:08:15 Max_iter: 1000
At iteration 117, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  118 ; minimum lost =  0.6405836939811707 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.0926856691971807e-08
lambda is : 2.1544346900318854e-05, cost : 0.412 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 12:08:40 Max_iter: 1000
At iteration 122, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  122 ; minimum lost =  0.6436409950256348 ; diff loss =  0.0 ; diff weight =  4.7147003101599694e-07
lambda is : 3.16227766016838e-05, cost : 0.388 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 12:09:03 Max_iter: 1000
At iteration 118, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  119 ; minimum lost =  0.6473300457000732 ; diff loss =  5.960464477539063e-08 ; diff weight =  9.563587255456696e-09
lambda is : 4.6415888336127784e-05, cost : 0.373 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 12:09:25 Max_iter: 1000
At iteration 120, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  121 ; minimum lost =  0.6508132219314575 ; diff loss =  2.980232238769531e-07 ; diff weight =  2.3017220485144207e-07
lambda is : 6.81292069057961e-05, cost : 0.321 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 12:09:45 Max_iter: 1000
At iteration 121, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  121 ; minimum lost =  0.6543369293212891 ; diff loss =  0.0 ; diff weight =  2.0600541574822273e-06
lambda is : 9.999999999999991e-05, cost : 0.306 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 12:10:03 Max_iter: 1000
At iteration 119, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  120 ; minimum lost =  0.6582269668579102 ; diff loss =  1.1920928955078125e-07 ; diff weight =  8.110745852718537e-08
lambda is : 0.00014677992676220703, cost : 0.272 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 12:10:19 Max_iter: 1000
At iteration 121, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  122 ; minimum lost =  0.6612978577613831 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.822026073407869e-08
lambda is : 0.0002154434690031884, cost : 0.252 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 12:10:34 Max_iter: 1000
At iteration 128, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  128 ; minimum lost =  0.6641573905944824 ; diff loss =  0.0 ; diff weight =  3.271387924996816e-07
lambda is : 0.00031622776601683783, cost : 0.242 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 12:10:49 Max_iter: 1000
At iteration 136, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  137 ; minimum lost =  0.6668776273727417 ; diff loss =  5.960464477539063e-08 ; diff weight =  5.572400851860948e-08
lambda is : 0.00046415888336127795, cost : 0.21 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 12:11:01 Max_iter: 1000
At iteration 148, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  149 ; minimum lost =  0.6695083379745483 ; diff loss =  5.960464477539062e-07 ; diff weight =  1.9279116258985596e-06
lambda is : 0.0006812920690579617, cost : 0.176 min
==========
Testing lambda: 0.001 starting at 2024-09-27 12:11:12 Max_iter: 1000
At iteration 188, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  189 ; minimum lost =  0.672021746635437 ; diff loss =  2.980232238769531e-07 ; diff weight =  8.426518434134778e-07
lambda is : 0.0010000000000000002, cost : 0.18 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 12:11:23 Max_iter: 1000
At iteration 221, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  221 ; minimum lost =  0.6756882667541504 ; diff loss =  -4.172325134277344e-07 ; diff weight =  0.0025610397569835186
lambda is : 0.0014677992676220694, cost : 0.162 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 12:11:33 Max_iter: 1000
At iteration 259, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  260 ; minimum lost =  0.678895115852356 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.000938248704187572
lambda is : 0.0021544346900318843, cost : 0.175 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 12:11:43 Max_iter: 1000
At iteration 252, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  253 ; minimum lost =  0.6815975904464722 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0007351965759880841
lambda is : 0.003162277660168382, cost : 0.167 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 12:11:53 Max_iter: 1000
At iteration 249, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  250 ; minimum lost =  0.6838263273239136 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006975975120440125
lambda is : 0.004641588833612781, cost : 0.166 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 12:12:03 Max_iter: 1000
At iteration 237, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  238 ; minimum lost =  0.6857593655586243 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0006393147050403059
lambda is : 0.006812920690579613, cost : 0.159 min
==========
Testing lambda: 0.01 starting at 2024-09-27 12:12:13 Max_iter: 1000
At iteration 219, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  220 ; minimum lost =  0.6874353885650635 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005689958925358951
lambda is : 0.010000000000000004, cost : 0.15 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 12:12:22 Max_iter: 1000
At iteration 197, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  198 ; minimum lost =  0.6891214847564697 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0005379564827308059
lambda is : 0.014677992676220709, cost : 0.136 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 12:12:30 Max_iter: 1000
At iteration 178, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  179 ; minimum lost =  0.6907580494880676 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004487856349442154
lambda is : 0.02154434690031885, cost : 0.122 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 12:12:37 Max_iter: 1000
At iteration 139, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  140 ; minimum lost =  0.6921389698982239 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00042176825809292495
lambda is : 0.0316227766016838, cost : 0.1 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 12:12:43 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931464672088623 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0005535153322853148
lambda is : 0.04641588833612786, cost : 0.019 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 12:12:44 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-27 12:12:45 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.439136    0.200680          0.200000           12078  0.999956  0.991667  0.822497   0.678161  0.808219      0.633970   4.919104e-07
0.000015    0.411467    0.224490          0.225532           11317  0.999956  0.991667  0.786828   0.621053  0.766234      0.636524   1.803050e-07
0.000022    0.390998    0.241497          0.242553           10754  0.999956  0.991667  0.804076   0.648352  0.786667      0.640584   2.092686e-08
0.000032    0.360748    0.268707          0.268085            9922  1.000000  1.000000  0.874659   0.766234  0.867647      0.643641   4.714700e-07
0.000046    0.333551    0.295918          0.293617            9174  1.000000  1.000000  0.892330   0.797297  0.887218      0.647330   9.563587e-09
Exporting resultDF
Exporting result Dict
Plasmablast Time elapsed: 5.524079875151316 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Platelet
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 12:13:17 Max_iter: 1000
At iteration 100, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  101 ; minimum lost =  0.43419399857521057 ; diff loss =  2.682209014892578e-07 ; diff weight =  1.8770206722251714e-08
lambda is : 9.999999999999997e-06, cost : 0.362 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 12:13:39 Max_iter: 1000
At iteration 99, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  100 ; minimum lost =  0.4384883940219879 ; diff loss =  3.5762786865234375e-07 ; diff weight =  4.3611471767235344e-08
lambda is : 1.4677992676220687e-05, cost : 0.339 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 12:13:59 Max_iter: 1000
At iteration 99, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  100 ; minimum lost =  0.4409686028957367 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.619866907276446e-08
lambda is : 2.1544346900318854e-05, cost : 0.342 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 12:14:20 Max_iter: 1000
At iteration 97, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  98 ; minimum lost =  0.44392573833465576 ; diff loss =  7.152557373046875e-07 ; diff weight =  8.331909384651226e-08
lambda is : 3.16227766016838e-05, cost : 0.295 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 12:14:38 Max_iter: 1000
At iteration 97, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  98 ; minimum lost =  0.44713911414146423 ; diff loss =  8.940696716308594e-08 ; diff weight =  2.7247795131302155e-08
lambda is : 4.6415888336127784e-05, cost : 0.29 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 12:14:55 Max_iter: 1000
At iteration 94, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  95 ; minimum lost =  0.4493752717971802 ; diff loss =  2.086162567138672e-07 ; diff weight =  3.5946573717637875e-08
lambda is : 6.81292069057961e-05, cost : 0.259 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 12:15:11 Max_iter: 1000
At iteration 93, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  94 ; minimum lost =  0.4551614820957184 ; diff loss =  2.9802322387695312e-08 ; diff weight =  2.252125774759861e-08
lambda is : 9.999999999999991e-05, cost : 0.243 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 12:15:25 Max_iter: 1000
At iteration 93, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  91 ; minimum lost =  0.4589475095272064 ; diff loss =  2.384185791015625e-07 ; diff weight =  0.00610567070543766
lambda is : 0.00014677992676220703, cost : 0.215 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 12:15:38 Max_iter: 1000
At iteration 75, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  75 ; minimum lost =  0.49999284744262695 ; diff loss =  0.0 ; diff weight =  9.15833808790012e-08
lambda is : 0.0002154434690031884, cost : 0.221 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 12:15:51 Max_iter: 1000
At iteration 86, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  86 ; minimum lost =  0.4741978645324707 ; diff loss =  0.0 ; diff weight =  1.943938201520723e-07
lambda is : 0.00031622776601683783, cost : 0.204 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 12:16:04 Max_iter: 1000
At iteration 92, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  93 ; minimum lost =  0.4732367992401123 ; diff loss =  2.9802322387695312e-08 ; diff weight =  0.013959922827780247
lambda is : 0.00046415888336127795, cost : 0.165 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 12:16:13 Max_iter: 1000
At iteration 94, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  95 ; minimum lost =  0.4797329604625702 ; diff loss =  2.9802322387695312e-08 ; diff weight =  1.3653206565322762e-08
lambda is : 0.0006812920690579617, cost : 0.207 min
==========
Testing lambda: 0.001 starting at 2024-09-27 12:16:26 Max_iter: 1000
At iteration 88, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  89 ; minimum lost =  0.4896450340747833 ; diff loss =  8.940696716308594e-08 ; diff weight =  0.014583789743483067
lambda is : 0.0010000000000000002, cost : 0.134 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 12:16:34 Max_iter: 1000
At iteration 93, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  93 ; minimum lost =  0.4956839084625244 ; diff loss =  0.0 ; diff weight =  1.0039423870011888e-07
lambda is : 0.0014677992676220694, cost : 0.175 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 12:16:44 Max_iter: 1000
At iteration 86, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  87 ; minimum lost =  0.5158912539482117 ; diff loss =  5.960464477539062e-07 ; diff weight =  8.646792792887936e-08
lambda is : 0.0021544346900318843, cost : 0.146 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 12:16:53 Max_iter: 1000
At iteration 88, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  89 ; minimum lost =  0.5263184905052185 ; diff loss =  7.152557373046875e-07 ; diff weight =  1.0679001150037948e-07
lambda is : 0.003162277660168382, cost : 0.142 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 12:17:02 Max_iter: 1000
At iteration 94, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  95 ; minimum lost =  0.5371443033218384 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.359969464293954e-08
lambda is : 0.004641588833612781, cost : 0.152 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 12:17:11 Max_iter: 1000
At iteration 107, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  108 ; minimum lost =  0.5460495352745056 ; diff loss =  1.7881393432617188e-07 ; diff weight =  1.8688670166966403e-08
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.006812920690579613, cost : 0.154 min
==========
Testing lambda: 0.01 starting at 2024-09-27 12:17:20 Max_iter: 1000
At iteration 102, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  103 ; minimum lost =  0.5686375498771667 ; diff loss =  1.7881393432617188e-07 ; diff weight =  5.201442476732154e-08
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.010000000000000004, cost : 0.133 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 12:17:28 Max_iter: 1000
At iteration 117, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  118 ; minimum lost =  0.5890055894851685 ; diff loss =  1.7881393432617188e-07 ; diff weight =  1.4090583144721336e-09
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.014677992676220709, cost : 0.142 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 12:17:37 Max_iter: 1000
At iteration 152, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  153 ; minimum lost =  0.6141244769096375 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.486809063701912e-08
lambda is : 0.02154434690031885, cost : 0.156 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 12:17:46 Max_iter: 1000
At iteration 302, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  303 ; minimum lost =  0.6387197375297546 ; diff loss =  2.384185791015625e-07 ; diff weight =  0.009409205988049507
lambda is : 0.0316227766016838, cost : 0.196 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 12:17:58 Max_iter: 1000
At iteration 288, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  289 ; minimum lost =  0.6707324981689453 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0012904454488307238
lambda is : 0.04641588833612786, cost : 0.186 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 12:18:09 Max_iter: 1000
At iteration 194, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  195 ; minimum lost =  0.6836045980453491 ; diff loss =  2.980232238769531e-07 ; diff weight =  0.00015190962585620582
lambda is : 0.0681292069057962, cost : 0.131 min
==========
Testing lambda: 0.1 starting at 2024-09-27 12:18:17 Max_iter: 1000
At iteration 159, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  159 ; minimum lost =  0.6912876963615417 ; diff loss =  0.0 ; diff weight =  0.0002530603960622102
lambda is : 0.10000000000000002, cost : 0.113 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.304247    0.045176          0.046351            8368  0.990269  0.960130  0.908724   0.894389  0.910924      0.434194   1.877021e-08
0.000015    0.277087    0.050536          0.052268            7621  0.991780  0.960193  0.915626   0.900990  0.917647      0.438488   4.361147e-08
0.000022    0.246182    0.058959          0.061144            6771  0.989602  0.957352  0.919739   0.915541  0.921769      0.440969   1.619867e-08
0.000032    0.217968    0.068913          0.071006            5995  0.988472  0.950779  0.918417   0.930070  0.920415      0.443926   8.331909e-08
0.000046    0.191754    0.077335          0.078895            5274  0.985707  0.947638  0.914620   0.929577  0.916667      0.447139   2.724780e-08
Exporting resultDF
Exporting result Dict
Platelet Time elapsed: 5.228636844952901 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Treg
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 12:18:54 Max_iter: 1000
At iteration 217, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  218 ; minimum lost =  0.6151614785194397 ; diff loss =  2.980232238769531e-07 ; diff weight =  9.208051210407575e-08
lambda is : 9.999999999999997e-06, cost : 0.424 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 12:19:20 Max_iter: 1000
At iteration 214, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  215 ; minimum lost =  0.6191640496253967 ; diff loss =  4.76837158203125e-07 ; diff weight =  4.45354004341425e-07
lambda is : 1.4677992676220687e-05, cost : 0.384 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 12:19:43 Max_iter: 1000
At iteration 206, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  207 ; minimum lost =  0.6234210133552551 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.2982225900136655e-08
lambda is : 2.1544346900318854e-05, cost : 0.385 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 12:20:06 Max_iter: 1000
At iteration 203, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  204 ; minimum lost =  0.6276496052742004 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.518376535614152e-07
lambda is : 3.16227766016838e-05, cost : 0.358 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 12:20:27 Max_iter: 1000
At iteration 199, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  200 ; minimum lost =  0.6318008303642273 ; diff loss =  1.1920928955078125e-07 ; diff weight =  8.468351353485559e-08
lambda is : 4.6415888336127784e-05, cost : 0.318 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 12:20:46 Max_iter: 1000
At iteration 196, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  197 ; minimum lost =  0.6357892751693726 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.711029483710604e-09
lambda is : 6.81292069057961e-05, cost : 0.3 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 12:21:04 Max_iter: 1000
At iteration 191, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  192 ; minimum lost =  0.6396510004997253 ; diff loss =  1.1920928955078125e-07 ; diff weight =  7.978637306393921e-09
lambda is : 9.999999999999991e-05, cost : 0.279 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 12:21:21 Max_iter: 1000
At iteration 189, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  190 ; minimum lost =  0.6431990265846252 ; diff loss =  2.384185791015625e-07 ; diff weight =  5.661656246047642e-07
lambda is : 0.00014677992676220703, cost : 0.253 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 12:21:36 Max_iter: 1000
At iteration 184, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  185 ; minimum lost =  0.6462770700454712 ; diff loss =  2.980232238769531e-07 ; diff weight =  6.858338110760087e-07
lambda is : 0.0002154434690031884, cost : 0.215 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 12:21:49 Max_iter: 1000
At iteration 186, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  187 ; minimum lost =  0.6489002108573914 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.199535818041113e-08
lambda is : 0.00031622776601683783, cost : 0.213 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 12:22:02 Max_iter: 1000
At iteration 186, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  187 ; minimum lost =  0.6512547731399536 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.1950845646424568e-07
lambda is : 0.00046415888336127795, cost : 0.205 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 12:22:14 Max_iter: 1000
At iteration 183, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  184 ; minimum lost =  0.6543207168579102 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.194600542930857e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.217 min
==========
Testing lambda: 0.001 starting at 2024-09-27 12:22:27 Max_iter: 1000
At iteration 184, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  185 ; minimum lost =  0.6575677990913391 ; diff loss =  2.980232238769531e-07 ; diff weight =  2.3880431854195194e-06
lambda is : 0.0010000000000000002, cost : 0.188 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 12:22:39 Max_iter: 1000
At iteration 188, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  189 ; minimum lost =  0.6611476540565491 ; diff loss =  6.556510925292969e-07 ; diff weight =  8.34621744161268e-07
lambda is : 0.0014677992676220694, cost : 0.176 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 12:22:49 Max_iter: 1000
At iteration 202, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  203 ; minimum lost =  0.6654335260391235 ; diff loss =  8.940696716308594e-07 ; diff weight =  1.9074484498560196e-06
lambda is : 0.0021544346900318843, cost : 0.171 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 12:22:59 Max_iter: 1000
At iteration 244, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  244 ; minimum lost =  0.6709641814231873 ; diff loss =  0.0 ; diff weight =  2.3246554974321043e-06
lambda is : 0.003162277660168382, cost : 0.213 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 12:23:12 Max_iter: 1000
At iteration 295, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  296 ; minimum lost =  0.6773621439933777 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0011429315200075507
lambda is : 0.004641588833612781, cost : 0.192 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 12:23:24 Max_iter: 1000
At iteration 247, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  248 ; minimum lost =  0.6820500493049622 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004810686514247209
lambda is : 0.006812920690579613, cost : 0.164 min
==========
Testing lambda: 0.01 starting at 2024-09-27 12:23:34 Max_iter: 1000
At iteration 210, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  211 ; minimum lost =  0.6859427094459534 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003257923817727715
lambda is : 0.010000000000000004, cost : 0.142 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 12:23:42 Max_iter: 1000
At iteration 165, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  166 ; minimum lost =  0.6891472339630127 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00028836436104029417
lambda is : 0.014677992676220709, cost : 0.115 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 12:23:49 Max_iter: 1000
At iteration 109, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  110 ; minimum lost =  0.6914035677909851 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00030709803104400635
lambda is : 0.02154434690031885, cost : 0.082 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 12:23:54 Max_iter: 1000
At iteration 57, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  58 ; minimum lost =  0.6929306983947754 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.00029220618307590485
lambda is : 0.0316227766016838, cost : 0.051 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 12:23:57 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.018 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 12:23:58 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.017 min
==========
Testing lambda: 0.1 starting at 2024-09-27 12:23:59 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.343732    0.085714          0.085202            9454  0.994766  0.890561  0.820012   0.772308  0.822951      0.615161   9.208051e-08
0.000015    0.309191    0.095714          0.095964            8504  0.994830  0.901309  0.849743   0.830565  0.853242      0.619164   4.453540e-07
0.000022    0.278396    0.107857          0.108520            7657  0.994711  0.901022  0.834826   0.805825  0.838384      0.623421   2.298223e-08
0.000032    0.241892    0.124286          0.124664            6653  0.992751  0.895535  0.855040   0.854167  0.858639      0.627650   1.518377e-07
0.000046    0.207097    0.142857          0.142152            5696  0.992197  0.900559  0.834148   0.831034  0.838261      0.631801   8.468351e-08
Exporting resultDF
Exporting result Dict
Treg Time elapsed: 5.228289218743642 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for cDC1
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 12:24:31 Max_iter: 1000
At iteration 117, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  117 ; minimum lost =  0.6477212309837341 ; diff loss =  0.0 ; diff weight =  4.1690659813298225e-09
lambda is : 9.999999999999997e-06, cost : 0.446 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 12:24:58 Max_iter: 1000
At iteration 123, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  124 ; minimum lost =  0.6500673890113831 ; diff loss =  1.1920928955078125e-07 ; diff weight =  5.588048779259225e-08
lambda is : 1.4677992676220687e-05, cost : 0.408 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 12:25:23 Max_iter: 1000
At iteration 115, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  116 ; minimum lost =  0.6529399156570435 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.4898136885553868e-09
lambda is : 2.1544346900318854e-05, cost : 0.416 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 12:25:48 Max_iter: 1000
At iteration 124, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  125 ; minimum lost =  0.6551993489265442 ; diff loss =  2.980232238769531e-07 ; diff weight =  3.4120199643439264e-07
lambda is : 3.16227766016838e-05, cost : 0.354 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 12:26:09 Max_iter: 1000
At iteration 118, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  119 ; minimum lost =  0.6581326723098755 ; diff loss =  5.364418029785156e-07 ; diff weight =  2.3665117510063283e-07
lambda is : 4.6415888336127784e-05, cost : 0.348 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 12:26:30 Max_iter: 1000
At iteration 111, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  112 ; minimum lost =  0.6612169742584229 ; diff loss =  5.364418029785156e-07 ; diff weight =  6.603281690331642e-07
lambda is : 6.81292069057961e-05, cost : 0.31 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 12:26:48 Max_iter: 1000
At iteration 109, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  110 ; minimum lost =  0.6641784906387329 ; diff loss =  8.940696716308594e-07 ; diff weight =  7.14649900146469e-07
lambda is : 9.999999999999991e-05, cost : 0.291 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 12:27:06 Max_iter: 1000
At iteration 106, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  107 ; minimum lost =  0.6671170592308044 ; diff loss =  2.384185791015625e-07 ; diff weight =  1.8469288320943633e-08
lambda is : 0.00014677992676220703, cost : 0.272 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 12:27:22 Max_iter: 1000
At iteration 108, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  109 ; minimum lost =  0.6698967814445496 ; diff loss =  5.960464477539063e-08 ; diff weight =  7.544302960127425e-09
lambda is : 0.0002154434690031884, cost : 0.252 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 12:27:37 Max_iter: 1000
At iteration 98, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  99 ; minimum lost =  0.6725938320159912 ; diff loss =  1.7881393432617188e-07 ; diff weight =  7.973876137157276e-08
lambda is : 0.00031622776601683783, cost : 0.216 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 12:27:50 Max_iter: 1000
At iteration 93, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  94 ; minimum lost =  0.6747742891311646 ; diff loss =  2.384185791015625e-07 ; diff weight =  2.3074772315112568e-08
lambda is : 0.00046415888336127795, cost : 0.19 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 12:28:01 Max_iter: 1000
At iteration 89, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  90 ; minimum lost =  0.6764343976974487 ; diff loss =  1.7881393432617188e-07 ; diff weight =  2.0605811812401953e-07
lambda is : 0.0006812920690579617, cost : 0.161 min
==========
Testing lambda: 0.001 starting at 2024-09-27 12:28:11 Max_iter: 1000
At iteration 86, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  87 ; minimum lost =  0.6776602268218994 ; diff loss =  1.7881393432617188e-07 ; diff weight =  7.551712144504563e-08
lambda is : 0.0010000000000000002, cost : 0.137 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 12:28:19 Max_iter: 1000
At iteration 87, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  87 ; minimum lost =  0.6785576939582825 ; diff loss =  0.0 ; diff weight =  1.3268253269416164e-06
lambda is : 0.0014677992676220694, cost : 0.134 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 12:28:27 Max_iter: 1000
At iteration 88, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  89 ; minimum lost =  0.679241955280304 ; diff loss =  2.384185791015625e-07 ; diff weight =  2.4779251361906063e-07
lambda is : 0.0021544346900318843, cost : 0.11 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 12:28:34 Max_iter: 1000
At iteration 94, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  95 ; minimum lost =  0.6803829669952393 ; diff loss =  1.7881393432617188e-07 ; diff weight =  1.1760918994241365e-07
lambda is : 0.003162277660168382, cost : 0.124 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 12:28:41 Max_iter: 1000
At iteration 97, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  98 ; minimum lost =  0.6811655759811401 ; diff loss =  8.344650268554688e-07 ; diff weight =  5.79441746140219e-07
lambda is : 0.004641588833612781, cost : 0.125 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 12:28:49 Max_iter: 1000
At iteration 105, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  105 ; minimum lost =  0.682963490486145 ; diff loss =  0.0 ; diff weight =  3.4255745049449615e-06
lambda is : 0.006812920690579613, cost : 0.139 min
==========
Testing lambda: 0.01 starting at 2024-09-27 12:28:57 Max_iter: 1000
Hessian approximation fail, yTs = 0
Hessian approximation fail, yTs = 0
minimum epoch =  127 ; minimum lost =  0.6854157447814941 ; diff loss =  3.814697265625e-06 ; diff weight =  5.960646376479417e-08
lambda is : 0.010000000000000004, cost : 0.126 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 12:29:05 Max_iter: 1000
At iteration 220, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  220 ; minimum lost =  0.6891159415245056 ; diff loss =  0.0 ; diff weight =  6.959147867746651e-05
lambda is : 0.014677992676220709, cost : 0.157 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 12:29:14 Max_iter: 1000
At iteration 131, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  132 ; minimum lost =  0.6919122934341431 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.0005160868167877197
lambda is : 0.02154434690031885, cost : 0.094 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 12:29:20 Max_iter: 1000
At iteration 60, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  61 ; minimum lost =  0.6928815841674805 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.00034504756331443787
lambda is : 0.0316227766016838, cost : 0.053 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 12:29:23 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.017 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 12:29:24 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.015 min
==========
Testing lambda: 0.1 starting at 2024-09-27 12:29:25 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.015 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.437427    0.231884          0.233010           12031  0.986120  0.923432  0.788266   0.680851  0.780488      0.647721   4.169066e-09
0.000015    0.411286    0.260870          0.252427           11312  0.999888  0.978567  0.897209   0.829268  0.894737      0.650067   5.588049e-08
0.000022    0.384526    0.282609          0.281553           10576  0.999985  0.995350  0.912592   0.833333  0.909091      0.652940   2.489814e-09
0.000032    0.355148    0.318841          0.320388            9768  0.999709  0.969700  0.888885   0.864865  0.888889      0.655199   3.412020e-07
0.000046    0.327007    0.347826          0.339806            8994  0.999993  0.997514  0.947166   0.897436  0.945946      0.658133   2.366512e-07
Exporting resultDF
Exporting result Dict
cDC1 Time elapsed: 5.06278848250707 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for cDC2
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 12:30:04 Max_iter: 1000
At iteration 132, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  133 ; minimum lost =  0.5413004159927368 ; diff loss =  5.960464477539062e-07 ; diff weight =  1.1950385214731796e-07
lambda is : 9.999999999999997e-06, cost : 0.469 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 12:30:32 Max_iter: 1000
At iteration 139, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  140 ; minimum lost =  0.5305731892585754 ; diff loss =  2.980232238769531e-07 ; diff weight =  9.929313904422088e-08
lambda is : 1.4677992676220687e-05, cost : 0.474 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 12:31:00 Max_iter: 1000
At iteration 130, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  130 ; minimum lost =  0.5472083687782288 ; diff loss =  0.0 ; diff weight =  2.726735601754626e-07
lambda is : 2.1544346900318854e-05, cost : 0.427 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 12:31:26 Max_iter: 1000
At iteration 139, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  139 ; minimum lost =  0.5379893183708191 ; diff loss =  0.0 ; diff weight =  1.357932859491484e-07
lambda is : 3.16227766016838e-05, cost : 0.438 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 12:31:52 Max_iter: 1000
At iteration 127, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  128 ; minimum lost =  0.5540528893470764 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.7842472388451824e-08
lambda is : 4.6415888336127784e-05, cost : 0.397 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 12:32:16 Max_iter: 1000
At iteration 127, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  128 ; minimum lost =  0.5578628182411194 ; diff loss =  5.960464477539063e-08 ; diff weight =  0.021292414516210556
lambda is : 6.81292069057961e-05, cost : 0.353 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 12:32:37 Max_iter: 1000
At iteration 127, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  128 ; minimum lost =  0.5620483160018921 ; diff loss =  7.152557373046875e-07 ; diff weight =  2.389475923791906e-07
lambda is : 9.999999999999991e-05, cost : 0.339 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 12:32:57 Max_iter: 1000
At iteration 123, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  124 ; minimum lost =  0.5665842890739441 ; diff loss =  2.384185791015625e-07 ; diff weight =  4.7012239434707226e-08
lambda is : 0.00014677992676220703, cost : 0.322 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 12:33:17 Max_iter: 1000
At iteration 125, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  126 ; minimum lost =  0.5711036324501038 ; diff loss =  2.384185791015625e-07 ; diff weight =  8.975619181228467e-08
lambda is : 0.0002154434690031884, cost : 0.288 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 12:33:34 Max_iter: 1000
At iteration 122, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  123 ; minimum lost =  0.5752336978912354 ; diff loss =  5.960464477539063e-08 ; diff weight =  0.025589877739548683
lambda is : 0.00031622776601683783, cost : 0.246 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 12:33:49 Max_iter: 1000
At iteration 121, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  122 ; minimum lost =  0.5796592235565186 ; diff loss =  2.384185791015625e-07 ; diff weight =  4.1652487681176353e-08
lambda is : 0.00046415888336127795, cost : 0.236 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 12:34:03 Max_iter: 1000
At iteration 119, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  120 ; minimum lost =  0.5840001702308655 ; diff loss =  7.748603820800781e-07 ; diff weight =  2.8323273681962746e-07
lambda is : 0.0006812920690579617, cost : 0.197 min
==========
Testing lambda: 0.001 starting at 2024-09-27 12:34:15 Max_iter: 1000
At iteration 118, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  119 ; minimum lost =  0.5882130265235901 ; diff loss =  7.748603820800781e-07 ; diff weight =  2.477348175489169e-07
lambda is : 0.0010000000000000002, cost : 0.173 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 12:34:25 Max_iter: 1000
At iteration 119, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  120 ; minimum lost =  0.592588484287262 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.0910861192314769e-07
lambda is : 0.0014677992676220694, cost : 0.163 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 12:34:35 Max_iter: 1000
At iteration 121, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  122 ; minimum lost =  0.5975426435470581 ; diff loss =  2.384185791015625e-07 ; diff weight =  1.1119803389192384e-07
lambda is : 0.0021544346900318843, cost : 0.149 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 12:34:44 Max_iter: 1000
At iteration 127, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  127 ; minimum lost =  0.6029928922653198 ; diff loss =  0.0 ; diff weight =  3.308306020244345e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.169 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 12:34:54 Max_iter: 1000
At iteration 134, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  135 ; minimum lost =  0.6086500287055969 ; diff loss =  5.960464477539062e-07 ; diff weight =  4.714236467862065e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 0.144 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 12:35:03 Max_iter: 1000
At iteration 147, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  148 ; minimum lost =  0.6157541871070862 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.7018281539549207e-07
lambda is : 0.006812920690579613, cost : 0.152 min
==========
Testing lambda: 0.01 starting at 2024-09-27 12:35:12 Max_iter: 1000
At iteration 167, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  168 ; minimum lost =  0.6232715845108032 ; diff loss =  2.384185791015625e-07 ; diff weight =  2.16678188280639e-07
lambda is : 0.010000000000000004, cost : 0.159 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 12:35:21 Max_iter: 1000
At iteration 183, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  183 ; minimum lost =  0.6333276629447937 ; diff loss =  0.0 ; diff weight =  1.8969089978781994e-06
lambda is : 0.014677992676220709, cost : 0.177 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 12:35:32 Max_iter: 1000
At iteration 247, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  248 ; minimum lost =  0.6443356275558472 ; diff loss =  6.556510925292969e-07 ; diff weight =  2.882363787648501e-06
lambda is : 0.02154434690031885, cost : 0.186 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 12:35:43 Max_iter: 1000
At iteration 337, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  338 ; minimum lost =  0.6639281511306763 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0005438126972876489
lambda is : 0.0316227766016838, cost : 0.215 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 12:35:56 Max_iter: 1000
At iteration 220, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  221 ; minimum lost =  0.677617073059082 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0009472261881455779
lambda is : 0.04641588833612786, cost : 0.148 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 12:36:05 Max_iter: 1000
At iteration 234, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  235 ; minimum lost =  0.6866265535354614 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00044994967174716294
lambda is : 0.0681292069057962, cost : 0.155 min
==========
Testing lambda: 0.1 starting at 2024-09-27 12:36:14 Max_iter: 1000
At iteration 84, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  85 ; minimum lost =  0.692345917224884 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00029838085174560547
lambda is : 0.10000000000000002, cost : 0.067 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.437245    0.217609          0.217507           12026  0.980476  0.949596  0.851741   0.784810  0.852234      0.541300   1.195039e-07
0.000015    0.413104    0.241947          0.240495           11362  0.984457  0.957196  0.868736   0.802548  0.868966      0.530573   9.929314e-08
0.000022    0.388853    0.265569          0.265252           10695  0.985109  0.958089  0.882136   0.833333  0.883392      0.547208   2.726736e-07
0.000032    0.363147    0.287759          0.287356            9988  0.986814  0.963497  0.890560   0.835526  0.891228      0.537989   1.357933e-07
0.000046    0.331952    0.319256          0.318302            9130  0.984901  0.964370  0.901359   0.865517  0.902878      0.554053   1.784247e-08
Exporting resultDF
Exporting result Dict
cDC2 Time elapsed: 6.371975541114807 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for dnT
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 12:36:50 Max_iter: 1000
At iteration 206, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  206 ; minimum lost =  0.6606216430664062 ; diff loss =  0.0 ; diff weight =  4.3274962990835775e-06
lambda is : 9.999999999999997e-06, cost : 0.439 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 12:37:16 Max_iter: 1000
At iteration 204, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  205 ; minimum lost =  0.6639780402183533 ; diff loss =  8.940696716308594e-07 ; diff weight =  4.4087013861826563e-07
lambda is : 1.4677992676220687e-05, cost : 0.382 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 12:37:39 Max_iter: 1000
At iteration 205, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  206 ; minimum lost =  0.6672369837760925 ; diff loss =  2.384185791015625e-07 ; diff weight =  9.296719554185984e-07
lambda is : 2.1544346900318854e-05, cost : 0.367 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 12:38:01 Max_iter: 1000
At iteration 200, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  201 ; minimum lost =  0.6706215739250183 ; diff loss =  3.5762786865234375e-07 ; diff weight =  1.4438164726016112e-06
lambda is : 3.16227766016838e-05, cost : 0.339 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 12:38:21 Max_iter: 1000
At iteration 197, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  198 ; minimum lost =  0.6739725470542908 ; diff loss =  9.5367431640625e-07 ; diff weight =  5.31073555976036e-06
lambda is : 4.6415888336127784e-05, cost : 0.314 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 12:38:40 Max_iter: 1000
At iteration 184, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  185 ; minimum lost =  0.6772488355636597 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.25475957904564e-08
lambda is : 6.81292069057961e-05, cost : 0.3 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 12:38:58 Max_iter: 1000
At iteration 184, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  184 ; minimum lost =  0.680366039276123 ; diff loss =  0.0 ; diff weight =  8.541521310689859e-06
lambda is : 9.999999999999991e-05, cost : 0.271 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 12:39:14 Max_iter: 1000
At iteration 182, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  183 ; minimum lost =  0.6830849051475525 ; diff loss =  1.7881393432617188e-07 ; diff weight =  6.419263058887736e-07
lambda is : 0.00014677992676220703, cost : 0.238 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 12:39:29 Max_iter: 1000
At iteration 180, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  181 ; minimum lost =  0.685327410697937 ; diff loss =  5.960464477539062e-07 ; diff weight =  3.0389107905648416e-06
lambda is : 0.0002154434690031884, cost : 0.214 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 12:39:41 Max_iter: 1000
At iteration 184, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  185 ; minimum lost =  0.6872233748435974 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.0590562169454643e-06
lambda is : 0.00031622776601683783, cost : 0.209 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 12:39:54 Max_iter: 1000
At iteration 205, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  205 ; minimum lost =  0.6888120770454407 ; diff loss =  0.0 ; diff weight =  5.6630256040079985e-06
lambda is : 0.00046415888336127795, cost : 0.214 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 12:40:07 Max_iter: 1000
At iteration 173, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  174 ; minimum lost =  0.6902323961257935 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.0004030329582747072
lambda is : 0.0006812920690579617, cost : 0.135 min
==========
Testing lambda: 0.001 starting at 2024-09-27 12:40:15 Max_iter: 1000
At iteration 151, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  152 ; minimum lost =  0.6910464763641357 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0002943707222584635
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.118 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 12:40:22 Max_iter: 1000
At iteration 134, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  135 ; minimum lost =  0.6916496753692627 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0002841794630512595
lambda is : 0.0014677992676220694, cost : 0.101 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 12:40:28 Max_iter: 1000
At iteration 116, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  117 ; minimum lost =  0.6921842694282532 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0002664575295057148
lambda is : 0.0021544346900318843, cost : 0.09 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 12:40:34 Max_iter: 1000
At iteration 93, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  94 ; minimum lost =  0.6926541924476624 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00024915061658248305
lambda is : 0.003162277660168382, cost : 0.077 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 12:40:38 Max_iter: 1000
At iteration 52, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  53 ; minimum lost =  0.6930065751075745 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00023231588420458138
lambda is : 0.004641588833612781, cost : 0.051 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 12:40:41 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  2 ; minimum lost =  0.6931469440460205 ; diff loss =  4.172325134277344e-07 ; diff weight =  0.00032846402609720826
lambda is : 0.006812920690579613, cost : 0.033 min
==========
Testing lambda: 0.01 starting at 2024-09-27 12:40:43 Max_iter: 1000
At iteration 1, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  0.0 ; diff weight =  7.364899090589461e-08
lambda is : 0.010000000000000004, cost : 0.018 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 12:40:44 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.014677992676220709, cost : 0.018 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 12:40:45 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.02154434690031885, cost : 0.016 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 12:40:46 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.016 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 12:40:47 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.016 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 12:40:48 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.017 min
==========
Testing lambda: 0.1 starting at 2024-09-27 12:40:49 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.365910    0.114983          0.114035           10064  0.980666  0.711349  0.699352   0.706897  0.700855      0.660622   4.327496e-06
0.000015    0.338933    0.128920          0.127193            9322  0.979336  0.721226  0.697340   0.800000  0.692308      0.663978   4.408701e-07
0.000022    0.304828    0.142857          0.144737            8384  0.985489  0.779010  0.767838   0.811321  0.767857      0.667237   9.296720e-07
0.000032    0.272070    0.160279          0.162281            7483  0.983029  0.773096  0.764551   0.823529  0.763636      0.670622   1.443816e-06
0.000046    0.229639    0.182927          0.179825            6316  0.964447  0.748110  0.749512   0.923077  0.734694      0.673973   5.310736e-06
Exporting resultDF
Exporting result Dict
dnT Time elapsed: 4.139314635594686 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for gdT
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 12:41:24 Max_iter: 1000
At iteration 193, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  193 ; minimum lost =  0.5833368301391602 ; diff loss =  0.0 ; diff weight =  2.308238663317752e-06
lambda is : 9.999999999999997e-06, cost : 0.686 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 12:42:05 Max_iter: 1000
At iteration 187, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  188 ; minimum lost =  0.5874063968658447 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.150414373820354e-10
lambda is : 1.4677992676220687e-05, cost : 0.448 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 12:42:32 Max_iter: 1000
At iteration 180, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  181 ; minimum lost =  0.591724693775177 ; diff loss =  5.364418029785156e-07 ; diff weight =  9.437353583052754e-07
lambda is : 2.1544346900318854e-05, cost : 0.621 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 12:43:09 Max_iter: 1000
At iteration 186, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  187 ; minimum lost =  0.5961396098136902 ; diff loss =  5.364418029785156e-07 ; diff weight =  3.479497081571026e-07
lambda is : 3.16227766016838e-05, cost : 0.365 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 12:43:31 Max_iter: 1000
At iteration 178, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  179 ; minimum lost =  0.600761353969574 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.9056617112388494e-09
lambda is : 4.6415888336127784e-05, cost : 0.519 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 12:44:02 Max_iter: 1000
At iteration 173, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  174 ; minimum lost =  0.6053565144538879 ; diff loss =  4.76837158203125e-07 ; diff weight =  6.974739363840854e-08
lambda is : 6.81292069057961e-05, cost : 0.428 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 12:44:28 Max_iter: 1000
At iteration 168, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  169 ; minimum lost =  0.6097378730773926 ; diff loss =  3.5762786865234375e-07 ; diff weight =  3.453866668223782e-07
lambda is : 9.999999999999991e-05, cost : 0.284 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 12:44:45 Max_iter: 1000
At iteration 162, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  163 ; minimum lost =  0.6141771674156189 ; diff loss =  4.172325134277344e-07 ; diff weight =  4.7326579988293815e-07
lambda is : 0.00014677992676220703, cost : 0.385 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 12:45:08 Max_iter: 1000
At iteration 163, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  164 ; minimum lost =  0.618504524230957 ; diff loss =  7.152557373046875e-07 ; diff weight =  3.5027801459364127e-06
lambda is : 0.0002154434690031884, cost : 0.246 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 12:45:23 Max_iter: 1000
At iteration 159, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  160 ; minimum lost =  0.622651219367981 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.9820599561626295e-07
lambda is : 0.00031622776601683783, cost : 0.212 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 12:45:36 Max_iter: 1000
At iteration 157, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  158 ; minimum lost =  0.6264944076538086 ; diff loss =  3.5762786865234375e-07 ; diff weight =  2.7276863079350733e-07
lambda is : 0.00046415888336127795, cost : 0.205 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 12:45:48 Max_iter: 1000
At iteration 157, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  158 ; minimum lost =  0.6304949522018433 ; diff loss =  2.980232238769531e-07 ; diff weight =  7.637111707481381e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.431 min
==========
Testing lambda: 0.001 starting at 2024-09-27 12:46:14 Max_iter: 1000
At iteration 162, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  162 ; minimum lost =  0.6350126266479492 ; diff loss =  0.0 ; diff weight =  1.8045784599962644e-07
lambda is : 0.0010000000000000002, cost : 0.174 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 12:46:24 Max_iter: 1000
At iteration 172, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  173 ; minimum lost =  0.640455961227417 ; diff loss =  2.384185791015625e-07 ; diff weight =  3.581560577003984e-07
lambda is : 0.0014677992676220694, cost : 0.174 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 12:46:35 Max_iter: 1000
At iteration 195, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  196 ; minimum lost =  0.6472725868225098 ; diff loss =  5.364418029785156e-07 ; diff weight =  1.788177002026714e-07
lambda is : 0.0021544346900318843, cost : 0.218 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 12:46:48 Max_iter: 1000
At iteration 264, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  265 ; minimum lost =  0.6568052768707275 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.5763059713644907e-07
lambda is : 0.003162277660168382, cost : 0.525 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 12:47:19 Max_iter: 1000
At iteration 271, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  272 ; minimum lost =  0.6639500856399536 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004978033248335123
lambda is : 0.004641588833612781, cost : 0.177 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 12:47:30 Max_iter: 1000
At iteration 258, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  259 ; minimum lost =  0.6679324507713318 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004606824950315058
lambda is : 0.006812920690579613, cost : 0.17 min
==========
Testing lambda: 0.01 starting at 2024-09-27 12:47:40 Max_iter: 1000
At iteration 240, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  241 ; minimum lost =  0.6721611022949219 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0004749130748677999
lambda is : 0.010000000000000004, cost : 0.231 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 12:47:54 Max_iter: 1000
At iteration 249, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  250 ; minimum lost =  0.6763079166412354 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003309154708404094
lambda is : 0.014677992676220709, cost : 0.318 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 12:48:13 Max_iter: 1000
At iteration 260, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  261 ; minimum lost =  0.680092453956604 ; diff loss =  8.344650268554688e-07 ; diff weight =  0.0002966163447126746
lambda is : 0.02154434690031885, cost : 0.171 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 12:48:23 Max_iter: 1000
At iteration 185, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  186 ; minimum lost =  0.684321403503418 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0003395182720851153
lambda is : 0.0316227766016838, cost : 0.126 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 12:48:31 Max_iter: 1000
At iteration 233, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  234 ; minimum lost =  0.6882283687591553 ; diff loss =  8.940696716308594e-07 ; diff weight =  0.00033369113225489855
lambda is : 0.04641588833612786, cost : 0.214 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 12:48:44 Max_iter: 1000
At iteration 96, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  97 ; minimum lost =  0.6918007731437683 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.00032167136669158936
lambda is : 0.0681292069057962, cost : 0.174 min
==========
Testing lambda: 0.1 starting at 2024-09-27 12:48:54 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.019 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.377763    0.101931          0.102234           10390  0.988282  0.870681  0.769914   0.714597  0.775414      0.583337   2.308239e-06
0.000015    0.347150    0.113734          0.114421            9548  0.989328  0.877732  0.793617   0.754587  0.799514      0.587406   3.150414e-10
0.000022    0.316972    0.127146          0.127962            8718  0.988470  0.879349  0.791806   0.758140  0.798042      0.591725   9.437354e-07
0.000032    0.280141    0.144313          0.144888            7705  0.989702  0.878276  0.796539   0.771429  0.802974      0.596140   3.479497e-07
0.000046    0.248655    0.163627          0.163846            6839  0.989615  0.885328  0.800678   0.774347  0.806931      0.600761   2.905662e-09
Exporting resultDF
Exporting result Dict
gdT Time elapsed: 7.663190321127574 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for pDC
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Loss tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 12:49:26 Max_iter: 1000
At iteration 106, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  107 ; minimum lost =  0.5392228960990906 ; diff loss =  6.556510925292969e-07 ; diff weight =  1.194398606685354e-07
lambda is : 9.999999999999997e-06, cost : 0.478 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 12:49:55 Max_iter: 1000
At iteration 105, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  106 ; minimum lost =  0.5397131443023682 ; diff loss =  7.152557373046875e-07 ; diff weight =  9.992584892870582e-08
lambda is : 1.4677992676220687e-05, cost : 0.449 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 12:50:22 Max_iter: 1000
At iteration 105, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  106 ; minimum lost =  0.5419957637786865 ; diff loss =  1.7881393432617188e-07 ; diff weight =  1.0235607916797562e-08
lambda is : 2.1544346900318854e-05, cost : 0.426 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 12:50:48 Max_iter: 1000
At iteration 103, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  103 ; minimum lost =  0.546180248260498 ; diff loss =  0.0 ; diff weight =  1.0649130643969329e-07
lambda is : 3.16227766016838e-05, cost : 0.407 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 12:51:12 Max_iter: 1000
At iteration 101, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  102 ; minimum lost =  0.548968493938446 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.4532724357252391e-08
lambda is : 4.6415888336127784e-05, cost : 0.393 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 12:51:36 Max_iter: 1000
At iteration 101, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  101 ; minimum lost =  0.5499240159988403 ; diff loss =  0.0 ; diff weight =  4.0330530026722045e-08
lambda is : 6.81292069057961e-05, cost : 0.363 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 12:51:57 Max_iter: 1000
At iteration 100, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  101 ; minimum lost =  0.5532991886138916 ; diff loss =  7.152557373046875e-07 ; diff weight =  1.4872192366510717e-07
lambda is : 9.999999999999991e-05, cost : 0.323 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 12:52:17 Max_iter: 1000
At iteration 100, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  100 ; minimum lost =  0.5588065981864929 ; diff loss =  0.0 ; diff weight =  3.952492022563092e-07
lambda is : 0.00014677992676220703, cost : 0.307 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 12:52:35 Max_iter: 1000
At iteration 100, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  97 ; minimum lost =  0.563463032245636 ; diff loss =  0.0 ; diff weight =  0.01127413660287857
lambda is : 0.0002154434690031884, cost : 0.288 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 12:52:52 Max_iter: 1000
At iteration 96, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  97 ; minimum lost =  0.5674625635147095 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.430436829570226e-08
lambda is : 0.00031622776601683783, cost : 0.247 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 12:53:07 Max_iter: 1000
At iteration 95, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  96 ; minimum lost =  0.5718426704406738 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.86518044845252e-08
lambda is : 0.00046415888336127795, cost : 0.232 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 12:53:21 Max_iter: 1000
At iteration 93, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  94 ; minimum lost =  0.5769387483596802 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.42498402972069e-08
lambda is : 0.0006812920690579617, cost : 0.196 min
==========
Testing lambda: 0.001 starting at 2024-09-27 12:53:33 Max_iter: 1000
At iteration 94, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  95 ; minimum lost =  0.582987368106842 ; diff loss =  2.384185791015625e-07 ; diff weight =  3.7141735020895794e-08
lambda is : 0.0010000000000000002, cost : 0.171 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 12:53:43 Max_iter: 1000
At iteration 92, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  93 ; minimum lost =  0.5891652703285217 ; diff loss =  1.7881393432617188e-07 ; diff weight =  1.4300986173054753e-08
lambda is : 0.0014677992676220694, cost : 0.156 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 12:53:53 Max_iter: 1000
At iteration 93, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  94 ; minimum lost =  0.5978062152862549 ; diff loss =  1.7881393432617188e-07 ; diff weight =  6.897943194417167e-08
lambda is : 0.0021544346900318843, cost : 0.142 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 12:54:01 Max_iter: 1000
At iteration 92, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  92 ; minimum lost =  0.610552966594696 ; diff loss =  0.0 ; diff weight =  2.46362418465651e-07
lambda is : 0.003162277660168382, cost : 0.141 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 12:54:10 Max_iter: 1000
At iteration 92, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  93 ; minimum lost =  0.6228472590446472 ; diff loss =  7.152557373046875e-07 ; diff weight =  2.0551088653064653e-07
lambda is : 0.004641588833612781, cost : 0.118 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 12:54:17 Max_iter: 1000
At iteration 92, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  93 ; minimum lost =  0.6387465000152588 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.1382166320572651e-08
lambda is : 0.006812920690579613, cost : 0.122 min
==========
Testing lambda: 0.01 starting at 2024-09-27 12:54:24 Max_iter: 1000
At iteration 106, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  107 ; minimum lost =  0.6476836800575256 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.9579266208324952e-08
lambda is : 0.010000000000000004, cost : 0.143 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 12:54:33 Max_iter: 1000
At iteration 131, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  132 ; minimum lost =  0.6573428511619568 ; diff loss =  1.7881393432617188e-07 ; diff weight =  4.268691000675062e-08
lambda is : 0.014677992676220709, cost : 0.141 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 12:54:41 Max_iter: 1000
At iteration 196, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  197 ; minimum lost =  0.6693729758262634 ; diff loss =  5.960464477539063e-08 ; diff weight =  7.498881871015328e-08
lambda is : 0.02154434690031885, cost : 0.18 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 12:54:52 Max_iter: 1000
At iteration 267, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  268 ; minimum lost =  0.6833124160766602 ; diff loss =  9.5367431640625e-07 ; diff weight =  0.0007547635468654335
lambda is : 0.0316227766016838, cost : 0.174 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 12:55:02 Max_iter: 1000
At iteration 205, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  206 ; minimum lost =  0.6891369819641113 ; diff loss =  7.152557373046875e-07 ; diff weight =  0.0005246772198006511
lambda is : 0.04641588833612786, cost : 0.138 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 12:55:11 Max_iter: 1000
At iteration 98, Convergence with loss difference, Device: cuda
Convergence with loss difference, Device: cuda
minimum epoch =  99 ; minimum lost =  0.6925292611122131 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.00020840161596424878
lambda is : 0.0681292069057962, cost : 0.076 min
==========
Testing lambda: 0.1 starting at 2024-09-27 12:55:15 Max_iter: 1000
Hessian initialization fail, gradient diff = 0
Hessian initialization fail, gradient diff = 0
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.427574    0.174204          0.173469           11760  0.999304  0.965680  0.746613   0.566845  0.721088      0.539223   1.194399e-07
0.000015    0.406195    0.189280          0.189796           11172  0.990947  0.963479  0.710978   0.519802  0.679612      0.539713   9.992585e-08
0.000022    0.378709    0.212730          0.210204           10416  0.994461  0.962612  0.730874   0.543590  0.701987      0.541996   1.023561e-08
0.000032    0.350713    0.234506          0.232653            9646  0.999781  0.977679  0.829105   0.690323  0.816794      0.546180   1.064913e-07
0.000046    0.318208    0.262982          0.259184            8752  0.996542  0.971744  0.849478   0.731034  0.841270      0.548968   1.453272e-08
Exporting resultDF
Exporting result Dict
pDC Time elapsed: 5.959078534444173 minutes.
***** Finished lambda tuning
====================

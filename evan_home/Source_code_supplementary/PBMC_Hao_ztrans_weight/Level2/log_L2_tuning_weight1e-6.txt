nohup: ignoring input
Z-transformed rep_cells adata: (57515, 27504) <class 'numpy.ndarray'>
all cell types: ['ASDC', 'B_intermediate', 'B_memory', 'B_naive', 'CD14_Mono', 'CD16_Mono', 'CD4_CTL', 'CD4_Naive', 'CD4_Proliferating', 'CD4_TCM', 'CD4_TEM', 'CD8_Naive', 'CD8_Proliferating', 'CD8_TCM', 'CD8_TEM', 'Doublet', 'Eryth', 'HSPC', 'ILC', 'MAIT', 'NK', 'NK_CD56bright', 'NK_Proliferating', 'Plasmablast', 'Platelet', 'Treg', 'cDC1', 'cDC2', 'dnT', 'gdT', 'pDC']
====================
Queue ['ASDC', 'B_intermediate', 'B_memory', 'B_naive', 'CD14_Mono', 'CD16_Mono', 'CD4_CTL', 'CD4_Naive', 'CD4_Proliferating', 'CD4_TCM', 'CD4_TEM', 'CD8_Naive', 'CD8_Proliferating', 'CD8_TCM', 'CD8_TEM', 'Doublet', 'Eryth', 'HSPC', 'ILC', 'MAIT', 'NK', 'NK_CD56bright', 'NK_Proliferating', 'Plasmablast', 'Platelet', 'Treg', 'cDC1', 'cDC2', 'dnT', 'gdT', 'pDC']
====================
Subsetted raw count adata: (57515, 27504) <class 'anndata._core.views.SparseCSCView'>
***** Starting tuning
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for ASDC
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 13:28:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.06105857342481613 ; diff loss =  3.0919909477233887e-07 ; diff weight =  0.053865138441324234
lambda is : 9.999999999999997e-06, cost : 3.12 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 13:31:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  997 ; minimum lost =  0.08323636651039124 ; diff loss =  0.0 ; diff weight =  0.008881306275725365
lambda is : 1.4677992676220687e-05, cost : 1.147 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 13:32:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 776, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  777 ; minimum lost =  0.11280921846628189 ; diff loss =  7.450580596923828e-09 ; diff weight =  9.284361226491455e-07
lambda is : 2.1544346900318854e-05, cost : 0.604 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 13:33:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 795, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  793 ; minimum lost =  0.15179750323295593 ; diff loss =  0.0 ; diff weight =  3.6220153560861945e-05
lambda is : 3.16227766016838e-05, cost : 0.645 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 13:34:10 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 786, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  787 ; minimum lost =  0.20247818529605865 ; diff loss =  5.960464477539063e-08 ; diff weight =  8.793281267571729e-07
lambda is : 4.6415888336127784e-05, cost : 0.608 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 13:34:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  395 ; minimum lost =  0.26219406723976135 ; diff loss =  -3.269314765930176e-05 ; diff weight =  3.3750710487365723
lambda is : 6.81292069057961e-05, cost : 6.329 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 13:41:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  452 ; minimum lost =  0.2930085361003876 ; diff loss =  -1.5795230865478516e-06 ; diff weight =  2.908104658126831
lambda is : 9.999999999999991e-05, cost : 5.696 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 13:46:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  420 ; minimum lost =  0.3315350115299225 ; diff loss =  -2.104043960571289e-05 ; diff weight =  0.002027028240263462
lambda is : 0.00014677992676220703, cost : 6.056 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 13:52:51 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  488 ; minimum lost =  0.31415700912475586 ; diff loss =  -3.2782554626464844e-07 ; diff weight =  0.12999793887138367
lambda is : 0.0002154434690031884, cost : 5.39 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 13:58:15 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 717, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  717 ; minimum lost =  0.36685213446617126 ; diff loss =  0.0 ; diff weight =  1.4162240404402837e-05
lambda is : 0.00031622776601683783, cost : 0.509 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 13:58:45 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 714, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  712 ; minimum lost =  0.4324093461036682 ; diff loss =  0.0 ; diff weight =  3.2839548111951444e-06
lambda is : 0.00046415888336127795, cost : 0.499 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 13:59:15 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 743, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  744 ; minimum lost =  0.5144951343536377 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.9492143838183438e-08
lambda is : 0.0006812920690579617, cost : 0.488 min
==========
Testing lambda: 0.001 starting at 2024-09-27 13:59:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 706, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  706 ; minimum lost =  0.6093829274177551 ; diff loss =  0.0 ; diff weight =  1.907411160573247e-06
lambda is : 0.0010000000000000002, cost : 0.467 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 14:00:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 394, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  390 ; minimum lost =  0.6921042799949646 ; diff loss =  0.0 ; diff weight =  1.3049278777543805e-06
lambda is : 0.0014677992676220694, cost : 0.279 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 14:00:29 Max_iter: 1000
At iteration 266, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  266 ; minimum lost =  0.6923776268959045 ; diff loss =  0.0 ; diff weight =  1.7285272406297736e-05
lambda is : 0.0021544346900318843, cost : 0.183 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 14:00:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 227, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  227 ; minimum lost =  0.6925233602523804 ; diff loss =  0.0 ; diff weight =  2.874272013286827e-06
lambda is : 0.003162277660168382, cost : 0.168 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 14:00:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 167, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  167 ; minimum lost =  0.6926708221435547 ; diff loss =  0.0 ; diff weight =  4.031599382869899e-05
lambda is : 0.004641588833612781, cost : 0.132 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 14:00:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 149, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  149 ; minimum lost =  0.6928321719169617 ; diff loss =  0.0 ; diff weight =  7.821490726200864e-06
lambda is : 0.006812920690579613, cost : 0.121 min
==========
Testing lambda: 0.01 starting at 2024-09-27 14:01:05 Max_iter: 1000
At iteration 111, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  112 ; minimum lost =  0.6930038332939148 ; diff loss =  1.1920928955078125e-07 ; diff weight =  5.811452865600586e-07
lambda is : 0.010000000000000004, cost : 0.091 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 14:01:11 Max_iter: 1000
At iteration 83, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  84 ; minimum lost =  0.6931325197219849 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.873160600662231e-07
lambda is : 0.014677992676220709, cost : 0.08 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 14:01:16 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.02154434690031885, cost : 0.017 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 14:01:17 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.015 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 14:01:18 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.015 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 14:01:18 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.015 min
==========
Testing lambda: 0.1 starting at 2024-09-27 14:01:19 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.015 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.122128    0.565789          0.568966            3359  0.999961  0.982564  0.971783        1.0  0.971429      0.061059   5.386514e-02
0.000015    0.109693    0.578947          0.586207            3017  0.999976  0.987648  0.971783        1.0  0.971429      0.083236   8.881306e-03
0.000022    0.101585    0.592105          0.586207            2794  0.999971  0.985809  0.971783        1.0  0.971429      0.112809   9.284361e-07
0.000032    0.095441    0.605263          0.603448            2625  0.999976  0.987648  0.971783        1.0  0.971429      0.151798   3.622015e-05
0.000046    0.089951    0.605263          0.620690            2474  0.999976  0.987648  0.971783        1.0  0.971429      0.202478   8.793281e-07
Exporting resultDF
Exporting result Dict
ASDC Time elapsed: 32.824292774995165 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for B_intermediate
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 14:01:51 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 998, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  998 ; minimum lost =  0.3756539821624756 ; diff loss =  0.0 ; diff weight =  4.714254828286357e-06
lambda is : 9.999999999999997e-06, cost : 1.128 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 14:02:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  749 ; minimum lost =  0.4509643316268921 ; diff loss =  -1.6093254089355469e-06 ; diff weight =  0.0011482374975457788
lambda is : 1.4677992676220687e-05, cost : 3.484 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 14:06:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  976 ; minimum lost =  0.5260521173477173 ; diff loss =  -5.960464477539063e-08 ; diff weight =  9.31945105548948e-05
lambda is : 2.1544346900318854e-05, cost : 1.802 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 14:08:16 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 988, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  456 ; minimum lost =  0.6097986102104187 ; diff loss =  1.7881393432617188e-07 ; diff weight =  1.8947770513477735e-05
lambda is : 3.16227766016838e-05, cost : 2.208 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 14:10:29 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 970, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  441 ; minimum lost =  0.6151416301727295 ; diff loss =  0.0 ; diff weight =  3.1865318305790424e-05
lambda is : 4.6415888336127784e-05, cost : 2.493 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 14:12:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 984, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  419 ; minimum lost =  0.6206590533256531 ; diff loss =  0.0 ; diff weight =  3.3306605473626405e-05
lambda is : 6.81292069057961e-05, cost : 2.543 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 14:15:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 949, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  388 ; minimum lost =  0.6262083053588867 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.620777351898141e-05
lambda is : 9.999999999999991e-05, cost : 2.543 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 14:18:03 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 959, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  371 ; minimum lost =  0.6316977143287659 ; diff loss =  0.0 ; diff weight =  4.851576886721887e-05
lambda is : 0.00014677992676220703, cost : 2.605 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 14:20:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  358 ; minimum lost =  0.6369466781616211 ; diff loss =  7.748603820800781e-07 ; diff weight =  0.00010578506044112146
lambda is : 0.0002154434690031884, cost : 2.516 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 14:23:11 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 931, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  340 ; minimum lost =  0.641974687576294 ; diff loss =  0.0 ; diff weight =  7.705228199483827e-05
lambda is : 0.00031622776601683783, cost : 2.429 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 14:25:36 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 868, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  344 ; minimum lost =  0.6470249891281128 ; diff loss =  3.5762786865234375e-07 ; diff weight =  7.965118857100606e-05
lambda is : 0.00046415888336127795, cost : 2.201 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 14:27:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 709, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  359 ; minimum lost =  0.6521666646003723 ; diff loss =  0.0 ; diff weight =  5.179893196327612e-05
lambda is : 0.0006812920690579617, cost : 1.337 min
==========
Testing lambda: 0.001 starting at 2024-09-27 14:29:09 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 536, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  537 ; minimum lost =  0.6576074361801147 ; diff loss =  5.960464477539063e-08 ; diff weight =  9.862727665677085e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.506 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 14:29:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 599, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  506 ; minimum lost =  0.6627796292304993 ; diff loss =  0.0 ; diff weight =  1.8883523807744496e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.43 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 14:30:05 Max_iter: 1000
At iteration 493, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  494 ; minimum lost =  0.6675295233726501 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.624370598729001e-07
lambda is : 0.0021544346900318843, cost : 0.337 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 14:30:25 Max_iter: 1000
At iteration 483, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  484 ; minimum lost =  0.6716470718383789 ; diff loss =  5.960464477539063e-08 ; diff weight =  7.050817885101424e-07
lambda is : 0.003162277660168382, cost : 0.318 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 14:30:44 Max_iter: 1000
At iteration 503, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  496 ; minimum lost =  0.6751450300216675 ; diff loss =  0.0 ; diff weight =  3.0874616641085595e-06
lambda is : 0.004641588833612781, cost : 0.335 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 14:31:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 448, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  446 ; minimum lost =  0.6781971454620361 ; diff loss =  0.0 ; diff weight =  3.948219818994403e-05
lambda is : 0.006812920690579613, cost : 0.304 min
==========
Testing lambda: 0.01 starting at 2024-09-27 14:31:22 Max_iter: 1000
At iteration 458, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  453 ; minimum lost =  0.6811777353286743 ; diff loss =  0.0 ; diff weight =  3.188607297488488e-05
lambda is : 0.010000000000000004, cost : 0.316 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 14:31:41 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 308, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  309 ; minimum lost =  0.6843819618225098 ; diff loss =  3.5762786865234375e-07 ; diff weight =  7.942079491840559e-07
lambda is : 0.014677992676220709, cost : 0.21 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 14:31:54 Max_iter: 1000
At iteration 403, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  404 ; minimum lost =  0.6875815391540527 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.609005254176736e-07
lambda is : 0.02154434690031885, cost : 0.288 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 14:32:11 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 233, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  234 ; minimum lost =  0.6900523900985718 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.029855892260457e-07
lambda is : 0.0316227766016838, cost : 0.164 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 14:32:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 246, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  247 ; minimum lost =  0.6920629739761353 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.875286722632154e-07
lambda is : 0.04641588833612786, cost : 0.196 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 14:32:33 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 37, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  34 ; minimum lost =  0.6931452751159668 ; diff loss =  0.0 ; diff weight =  3.628246486186981e-05
lambda is : 0.0681292069057962, cost : 0.056 min
==========
Testing lambda: 0.1 starting at 2024-09-27 14:32:36 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.335660    0.151426          0.149338            9232  0.970677  0.887599  0.807063   0.781437  0.811820      0.375654       0.000005
0.000015    0.331043    0.156547          0.154064            9105  0.970813  0.883074  0.803167   0.780120  0.808112      0.450964       0.001148
0.000022    0.307992    0.166057          0.163516            8471  0.971507  0.887815  0.816650   0.796353  0.821317      0.526052       0.000093
0.000032    0.292794    0.174104          0.172968            8053  0.967901  0.879217  0.826429   0.811728  0.830964      0.609799       0.000019
0.000046    0.257090    0.195318          0.192817            7071  0.964383  0.879014  0.834842   0.818462  0.839117      0.615142       0.000032
Exporting resultDF
Exporting result Dict
B_intermediate Time elapsed: 30.897531429926556 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for B_memory
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 14:33:08 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.21301360428333282 ; diff loss =  7.857382297515869e-05 ; diff weight =  0.10164013504981995
lambda is : 9.999999999999997e-06, cost : 2.798 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 14:35:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  967 ; minimum lost =  0.3491474986076355 ; diff loss =  -2.682209014892578e-07 ; diff weight =  0.0023565280716866255
lambda is : 1.4677992676220687e-05, cost : 4.007 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 14:39:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  903 ; minimum lost =  0.34530431032180786 ; diff loss =  -1.4603137969970703e-06 ; diff weight =  0.00010707410547183827
lambda is : 2.1544346900318854e-05, cost : 3.531 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 14:43:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  921 ; minimum lost =  0.35732051730155945 ; diff loss =  -6.854534149169922e-07 ; diff weight =  1.3181658687244635e-05
lambda is : 3.16227766016838e-05, cost : 3.293 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 14:46:45 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  935 ; minimum lost =  0.3858063519001007 ; diff loss =  -4.172325134277344e-07 ; diff weight =  9.604930710338522e-06
lambda is : 4.6415888336127784e-05, cost : 3.052 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 14:49:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.41904759407043457 ; diff loss =  5.0127506256103516e-05 ; diff weight =  0.010633586905896664
lambda is : 6.81292069057961e-05, cost : 2.485 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 14:52:18 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  714 ; minimum lost =  0.4684993326663971 ; diff loss =  -1.9371509552001953e-06 ; diff weight =  5.1047558372374624e-05
lambda is : 9.999999999999991e-05, cost : 4.855 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 14:57:09 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.42750489711761475 ; diff loss =  1.1920928955078125e-06 ; diff weight =  0.00015966655337251723
lambda is : 0.00014677992676220703, cost : 2.176 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 14:59:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.44828635454177856 ; diff loss =  5.930662155151367e-06 ; diff weight =  0.00042957946425303817
lambda is : 0.0002154434690031884, cost : 2.034 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 15:01:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.47845131158828735 ; diff loss =  3.904104232788086e-06 ; diff weight =  0.00029165291925892234
lambda is : 0.00031622776601683783, cost : 2.231 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 15:03:36 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.5231133699417114 ; diff loss =  3.5762786865234375e-06 ; diff weight =  0.00026574009098112583
lambda is : 0.00046415888336127795, cost : 2.432 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 15:06:01 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  180 ; minimum lost =  0.5878270268440247 ; diff loss =  -4.172325134277344e-07 ; diff weight =  6.929031951585785e-05
lambda is : 0.0006812920690579617, cost : 4.542 min
==========
Testing lambda: 0.001 starting at 2024-09-27 15:10:34 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 809, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  175 ; minimum lost =  0.5956265926361084 ; diff loss =  0.0 ; diff weight =  8.117385732475668e-05
lambda is : 0.0010000000000000002, cost : 2.443 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 15:13:01 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  183 ; minimum lost =  0.6031561493873596 ; diff loss =  1.0728836059570312e-06 ; diff weight =  7.673831714782864e-05
lambda is : 0.0014677992676220694, cost : 2.903 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 15:15:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 952, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  194 ; minimum lost =  0.6117095351219177 ; diff loss =  0.0 ; diff weight =  7.60204711696133e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 2.643 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 15:18:33 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  196 ; minimum lost =  0.6209539771080017 ; diff loss =  3.36766242980957e-05 ; diff weight =  6.726208084728569e-05
lambda is : 0.003162277660168382, cost : 4.48 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 15:23:02 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  230 ; minimum lost =  0.6318382024765015 ; diff loss =  1.1920928955078125e-07 ; diff weight =  5.188374052522704e-05
lambda is : 0.004641588833612781, cost : 3.575 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 15:26:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 700, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  373 ; minimum lost =  0.6448482275009155 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.7500437024864368e-05
lambda is : 0.006812920690579613, cost : 1.798 min
==========
Testing lambda: 0.01 starting at 2024-09-27 15:28:25 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 473, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  471 ; minimum lost =  0.6591320633888245 ; diff loss =  0.0 ; diff weight =  7.262734288815409e-05
lambda is : 0.010000000000000004, cost : 0.324 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 15:28:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 394, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  394 ; minimum lost =  0.6700345873832703 ; diff loss =  0.0 ; diff weight =  7.555581305496162e-06
lambda is : 0.014677992676220709, cost : 0.274 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 15:29:01 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 327, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  327 ; minimum lost =  0.6784204840660095 ; diff loss =  0.0 ; diff weight =  2.0617994778149296e-06
lambda is : 0.02154434690031885, cost : 0.241 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 15:29:15 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 326, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  327 ; minimum lost =  0.6849712133407593 ; diff loss =  4.172325134277344e-07 ; diff weight =  5.944610848018783e-07
lambda is : 0.0316227766016838, cost : 0.218 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 15:29:28 Max_iter: 1000
At iteration 249, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  250 ; minimum lost =  0.6899362206459045 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.7007286601256055e-07
lambda is : 0.04641588833612786, cost : 0.18 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 15:29:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 205, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  205 ; minimum lost =  0.6926559209823608 ; diff loss =  0.0 ; diff weight =  1.1458992958068848e-05
lambda is : 0.0681292069057962, cost : 0.156 min
==========
Testing lambda: 0.1 starting at 2024-09-27 15:29:48 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.315518    0.153891          0.154286            8678  0.996903  0.958610  0.897867   0.856742  0.899705      0.213014       0.101640
0.000015    0.317372    0.156794          0.157143            8729  0.996079  0.959543  0.909480   0.881159  0.911544      0.349147       0.002357
0.000022    0.266143    0.180604          0.180000            7320  0.995906  0.963142  0.906194   0.869318  0.908012      0.345304       0.000107
0.000032    0.231021    0.202671          0.203571            6354  0.994769  0.962599  0.911569   0.879310  0.913433      0.357321       0.000013
0.000046    0.196153    0.229384          0.230000            5395  0.994680  0.958895  0.916701   0.891813  0.918675      0.385806       0.000010
Exporting resultDF
Exporting result Dict
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:949: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, ax1 = plt.subplots(figsize = (fig_width,fig_height))
B_memory Time elapsed: 56.82311123609543 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for B_naive
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 15:30:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  969 ; minimum lost =  0.26693910360336304 ; diff loss =  -1.1920928955078125e-07 ; diff weight =  0.0015480188885703683
lambda is : 9.999999999999997e-06, cost : 4.016 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 15:34:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  998 ; minimum lost =  0.22840121388435364 ; diff loss =  0.0 ; diff weight =  2.2004007405485027e-05
lambda is : 1.4677992676220687e-05, cost : 2.303 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 15:36:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.22378237545490265 ; diff loss =  1.150369644165039e-05 ; diff weight =  0.0038965665735304356
lambda is : 2.1544346900318854e-05, cost : 2.287 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 15:38:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.2217244952917099 ; diff loss =  5.677342414855957e-06 ; diff weight =  0.0009869299829006195
lambda is : 3.16227766016838e-05, cost : 2.189 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 15:41:08 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.22115512192249298 ; diff loss =  2.637505531311035e-06 ; diff weight =  0.0005594618269242346
lambda is : 4.6415888336127784e-05, cost : 2.21 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 15:43:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.22185085713863373 ; diff loss =  1.6689300537109375e-06 ; diff weight =  0.00024476167163811624
lambda is : 6.81292069057961e-05, cost : 2.184 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 15:45:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.22432760894298553 ; diff loss =  2.4437904357910156e-06 ; diff weight =  0.00037772409268654883
lambda is : 9.999999999999991e-05, cost : 2.085 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 15:47:36 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.22618865966796875 ; diff loss =  1.4007091522216797e-06 ; diff weight =  0.000247952964855358
lambda is : 0.00014677992676220703, cost : 2.047 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 15:49:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.23247604072093964 ; diff loss =  7.897615432739258e-07 ; diff weight =  0.00012539949966594577
lambda is : 0.0002154434690031884, cost : 2.001 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 15:51:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.2420990914106369 ; diff loss =  5.960464477539063e-08 ; diff weight =  7.003805512795225e-05
lambda is : 0.00031622776601683783, cost : 2.012 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 15:53:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 937, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  931 ; minimum lost =  0.2562128007411957 ; diff loss =  0.0 ; diff weight =  6.860643770778552e-05
lambda is : 0.00046415888336127795, cost : 1.962 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 15:55:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 892, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  888 ; minimum lost =  0.2762656509876251 ; diff loss =  0.0 ; diff weight =  3.559182368917391e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 1.775 min
==========
Testing lambda: 0.001 starting at 2024-09-27 15:57:24 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  991 ; minimum lost =  0.30438798666000366 ; diff loss =  0.0 ; diff weight =  8.597824489697814e-06
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 1.907 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 15:59:19 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 879, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  876 ; minimum lost =  0.34280920028686523 ; diff loss =  0.0 ; diff weight =  7.581915997434407e-05
lambda is : 0.0014677992676220694, cost : 1.778 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 16:01:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 946, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  946 ; minimum lost =  0.3936931788921356 ; diff loss =  0.0 ; diff weight =  1.2172839660706813e-06
lambda is : 0.0021544346900318843, cost : 1.911 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 16:03:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.4560531973838806 ; diff loss =  1.4901161193847656e-07 ; diff weight =  2.9058985091978684e-05
lambda is : 0.003162277660168382, cost : 1.974 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 16:04:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  214 ; minimum lost =  0.4777776598930359 ; diff loss =  1.6808509826660156e-05 ; diff weight =  0.00014111053314991295
lambda is : 0.004641588833612781, cost : 3.902 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 16:08:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 933, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  207 ; minimum lost =  0.49446576833724976 ; diff loss =  0.0 ; diff weight =  0.0001562955294502899
lambda is : 0.006812920690579613, cost : 3.437 min
==========
Testing lambda: 0.01 starting at 2024-09-27 16:12:19 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 886, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  205 ; minimum lost =  0.5033084750175476 ; diff loss =  0.0 ; diff weight =  0.0001751529925968498
lambda is : 0.010000000000000004, cost : 3.182 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 16:15:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 841, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  207 ; minimum lost =  0.5194559693336487 ; diff loss =  1.1920928955078125e-07 ; diff weight =  0.00011224266199860722
lambda is : 0.014677992676220709, cost : 2.716 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 16:18:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 351, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  236 ; minimum lost =  0.542265772819519 ; diff loss =  -0.0018260478973388672 ; diff weight =  0.00011815651669166982
lambda is : 0.02154434690031885, cost : 0.665 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 16:18:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 552, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  505 ; minimum lost =  0.5754878520965576 ; diff loss =  -2.682209014892578e-06 ; diff weight =  4.687593445851235e-06
lambda is : 0.0316227766016838, cost : 0.898 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 16:19:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 483, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  483 ; minimum lost =  0.6163415312767029 ; diff loss =  0.0 ; diff weight =  4.06839135393966e-05
lambda is : 0.04641588833612786, cost : 0.356 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 16:20:08 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 350, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  351 ; minimum lost =  0.6497005820274353 ; diff loss =  1.7881393432617188e-07 ; diff weight =  5.397430413722759e-07
lambda is : 0.0681292069057962, cost : 0.239 min
==========
Testing lambda: 0.1 starting at 2024-09-27 16:20:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 269, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  270 ; minimum lost =  0.6735580563545227 ; diff loss =  2.384185791015625e-07 ; diff weight =  6.260261216084473e-07
lambda is : 0.10000000000000002, cost : 0.185 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.309337    0.132628          0.134473            8508  0.998326  0.986861  0.938619   0.898860  0.941089      0.266939       0.001548
0.000015    0.259090    0.157223          0.158958            7126  0.998273  0.990165  0.950716   0.923642  0.953030      0.228401       0.000022
0.000022    0.219641    0.179950          0.181500            6041  0.998482  0.989759  0.959091   0.937500  0.961098      0.223782       0.003897
0.000032    0.178338    0.209838          0.211426            4905  0.999140  0.990428  0.964447   0.947368  0.966258      0.221724       0.000987
0.000046    0.136816    0.247198          0.249903            3763  0.998833  0.990231  0.956412   0.938531  0.958652      0.221155       0.000559
Exporting resultDF
Exporting result Dict
B_naive Time elapsed: 50.35733477671941 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD14_Mono
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 16:21:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 773, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  764 ; minimum lost =  0.0741157978773117 ; diff loss =  0.0 ; diff weight =  5.287699605105445e-05
lambda is : 9.999999999999997e-06, cost : 1.727 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 16:22:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 797, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  787 ; minimum lost =  0.0907140001654625 ; diff loss =  0.0 ; diff weight =  3.577386087272316e-05
lambda is : 1.4677992676220687e-05, cost : 2.144 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 16:24:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 944, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  937 ; minimum lost =  0.1082521378993988 ; diff loss =  -2.2351741790771484e-08 ; diff weight =  2.0805389794986695e-05
lambda is : 2.1544346900318854e-05, cost : 2.77 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 16:27:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 971, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  965 ; minimum lost =  0.12946370244026184 ; diff loss =  -2.9802322387695312e-08 ; diff weight =  8.503763638145756e-06
lambda is : 3.16227766016838e-05, cost : 2.851 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 16:30:34 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 785, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  774 ; minimum lost =  0.15443040430545807 ; diff loss =  0.0 ; diff weight =  4.56054913229309e-05
lambda is : 4.6415888336127784e-05, cost : 1.696 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 16:32:15 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  350 ; minimum lost =  0.16682158410549164 ; diff loss =  -2.9802322387695312e-08 ; diff weight =  5.9889160183956847e-05
lambda is : 6.81292069057961e-05, cost : 2.966 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 16:35:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  193 ; minimum lost =  0.17572103440761566 ; diff loss =  -2.9802322387695312e-08 ; diff weight =  4.7602799895685166e-05
lambda is : 9.999999999999991e-05, cost : 2.626 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 16:37:51 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 873, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  232 ; minimum lost =  0.18122553825378418 ; diff loss =  0.0 ; diff weight =  5.032584158470854e-05
lambda is : 0.00014677992676220703, cost : 2.058 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 16:39:54 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  209 ; minimum lost =  0.18566980957984924 ; diff loss =  0.0 ; diff weight =  5.235885691945441e-05
lambda is : 0.0002154434690031884, cost : 3.633 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 16:43:32 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 952, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  212 ; minimum lost =  0.19140727818012238 ; diff loss =  0.0 ; diff weight =  5.402578244684264e-05
lambda is : 0.00031622776601683783, cost : 2.828 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 16:46:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 876, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  210 ; minimum lost =  0.19797848165035248 ; diff loss =  0.0 ; diff weight =  5.833767863805406e-05
lambda is : 0.00046415888336127795, cost : 2.286 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 16:48:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 790, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  221 ; minimum lost =  0.20606368780136108 ; diff loss =  0.0 ; diff weight =  6.155318988021463e-05
lambda is : 0.0006812920690579617, cost : 1.978 min
==========
Testing lambda: 0.001 starting at 2024-09-27 16:50:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 743, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  201 ; minimum lost =  0.2147880345582962 ; diff loss =  1.4901161193847656e-08 ; diff weight =  6.054212644812651e-05
lambda is : 0.0010000000000000002, cost : 1.695 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 16:52:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 755, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  216 ; minimum lost =  0.22533771395683289 ; diff loss =  2.9802322387695312e-08 ; diff weight =  6.469390064012259e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 1.882 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 16:54:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 758, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  208 ; minimum lost =  0.23834165930747986 ; diff loss =  0.0 ; diff weight =  6.548046803800389e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 1.94 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 16:56:09 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 651, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  205 ; minimum lost =  0.25438275933265686 ; diff loss =  0.0 ; diff weight =  7.221222767839208e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 1.313 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 16:57:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 641, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  250 ; minimum lost =  0.27226006984710693 ; diff loss =  0.0 ; diff weight =  7.579363591503352e-05
lambda is : 0.004641588833612781, cost : 1.265 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 16:58:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 586, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  175 ; minimum lost =  0.29317131638526917 ; diff loss =  0.0 ; diff weight =  8.432022150373086e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.006812920690579613, cost : 0.939 min
==========
Testing lambda: 0.01 starting at 2024-09-27 16:59:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 531, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  272 ; minimum lost =  0.30952489376068115 ; diff loss =  2.9802322387695312e-08 ; diff weight =  5.359000715543516e-05
lambda is : 0.010000000000000004, cost : 0.741 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 17:00:25 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  883 ; minimum lost =  0.32874926924705505 ; diff loss =  0.0 ; diff weight =  0.00018766045104712248
lambda is : 0.014677992676220709, cost : 3.597 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 17:04:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 820, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  753 ; minimum lost =  0.36757367849349976 ; diff loss =  -2.9802322387695312e-08 ; diff weight =  1.2439843430911424e-06
lambda is : 0.02154434690031885, cost : 1.822 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 17:05:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 705, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  706 ; minimum lost =  0.4117097854614258 ; diff loss =  2.9802322387695312e-08 ; diff weight =  7.073890060382837e-07
lambda is : 0.0316227766016838, cost : 0.489 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 17:06:19 Max_iter: 1000
At iteration 757, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  739 ; minimum lost =  0.46317964792251587 ; diff loss =  0.0 ; diff weight =  3.0102626624284312e-05
lambda is : 0.04641588833612786, cost : 0.466 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 17:06:47 Max_iter: 1000
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  967 ; minimum lost =  0.5208667516708374 ; diff loss =  0.0 ; diff weight =  2.3001861336524598e-05
lambda is : 0.0681292069057962, cost : 0.625 min
==========
Testing lambda: 0.1 starting at 2024-09-27 17:07:25 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 873, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  873 ; minimum lost =  0.5789226293563843 ; diff loss =  0.0 ; diff weight =  1.8977487343363464e-05
lambda is : 0.10000000000000002, cost : 0.547 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.297702    0.253865          0.252416            8188  0.992678  0.977186  0.922747   0.901854  0.933936      0.074116       0.000053
0.000015    0.268216    0.276294          0.274817            7377  0.993704  0.978399  0.925543   0.905857  0.936351      0.090714       0.000036
0.000022    0.232657    0.304287          0.302196            6399  0.994619  0.979171  0.925176   0.903103  0.935966      0.108252       0.000021
0.000032    0.204225    0.337433          0.335286            5617  0.995486  0.981784  0.933547   0.918934  0.943289      0.129464       0.000009
0.000046    0.171611    0.372394          0.370791            4720  0.994675  0.979401  0.930131   0.916620  0.940405      0.154430       0.000046
Exporting resultDF
Exporting result Dict
CD14_Mono Time elapsed: 47.024634691079456 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD16_Mono
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 17:08:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  137 ; minimum lost =  0.4627964496612549 ; diff loss =  0.00036263465881347656 ; diff weight =  5.664794662152417e-05
lambda is : 9.999999999999997e-06, cost : 4.015 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 17:12:29 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 796, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  135 ; minimum lost =  0.4653584063053131 ; diff loss =  0.0 ; diff weight =  6.069343726267107e-05
lambda is : 1.4677992676220687e-05, cost : 3.515 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 17:16:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  137 ; minimum lost =  0.4675983488559723 ; diff loss =  0.00026679039001464844 ; diff weight =  5.9372014220571145e-05
lambda is : 2.1544346900318854e-05, cost : 4.09 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 17:20:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  136 ; minimum lost =  0.47009462118148804 ; diff loss =  0.00020515918731689453 ; diff weight =  5.6401073379674926e-05
lambda is : 3.16227766016838e-05, cost : 4.028 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 17:24:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  136 ; minimum lost =  0.47367414832115173 ; diff loss =  0.00029546022415161133 ; diff weight =  6.740532990079373e-05
lambda is : 4.6415888336127784e-05, cost : 3.971 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 17:28:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  136 ; minimum lost =  0.4778701364994049 ; diff loss =  0.0001571178436279297 ; diff weight =  5.974480154691264e-05
lambda is : 6.81292069057961e-05, cost : 3.896 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 17:31:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  138 ; minimum lost =  0.48265305161476135 ; diff loss =  0.00014722347259521484 ; diff weight =  5.676383079844527e-05
lambda is : 9.999999999999991e-05, cost : 3.82 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 17:35:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  136 ; minimum lost =  0.4874439537525177 ; diff loss =  0.0019969940185546875 ; diff weight =  6.812297215219587e-05
lambda is : 0.00014677992676220703, cost : 3.769 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 17:39:34 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  136 ; minimum lost =  0.49220770597457886 ; diff loss =  -2.384185791015625e-07 ; diff weight =  5.5735057685524225e-05
lambda is : 0.0002154434690031884, cost : 4.081 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 17:43:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  135 ; minimum lost =  0.49740245938301086 ; diff loss =  -2.384185791015625e-07 ; diff weight =  6.879447028040886e-05
lambda is : 0.00031622776601683783, cost : 3.877 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 17:47:32 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  138 ; minimum lost =  0.5024549961090088 ; diff loss =  8.90493392944336e-05 ; diff weight =  5.6729812058620155e-05
lambda is : 0.00046415888336127795, cost : 3.985 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 17:51:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  137 ; minimum lost =  0.50865238904953 ; diff loss =  -1.1920928955078125e-07 ; diff weight =  4.6961940824985504e-05
lambda is : 0.0006812920690579617, cost : 4.918 min
==========
Testing lambda: 0.001 starting at 2024-09-27 17:56:26 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  140 ; minimum lost =  0.5152378678321838 ; diff loss =  0.0 ; diff weight =  6.159122858662158e-05
lambda is : 0.0010000000000000002, cost : 5.073 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 18:01:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  146 ; minimum lost =  0.5235872864723206 ; diff loss =  0.0 ; diff weight =  5.9601654356811196e-05
lambda is : 0.0014677992676220694, cost : 4.778 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 18:06:17 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  146 ; minimum lost =  0.5320549011230469 ; diff loss =  -2.384185791015625e-07 ; diff weight =  5.615044210571796e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 4.553 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 18:10:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 778, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  159 ; minimum lost =  0.5416451096534729 ; diff loss =  0.0 ; diff weight =  5.5242540838662535e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 2.374 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 18:13:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 653, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  164 ; minimum lost =  0.5535240769386292 ; diff loss =  2.384185791015625e-07 ; diff weight =  5.3120551456231624e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 1.947 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 18:15:09 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 613, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  189 ; minimum lost =  0.5658490657806396 ; diff loss =  1.1920928955078125e-07 ; diff weight =  4.795244967681356e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.006812920690579613, cost : 1.542 min
==========
Testing lambda: 0.01 starting at 2024-09-27 18:16:42 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 563, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  242 ; minimum lost =  0.5784168839454651 ; diff loss =  0.0 ; diff weight =  5.0044796807924286e-05
lambda is : 0.010000000000000004, cost : 1.126 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 18:17:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 720, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  434 ; minimum lost =  0.5957441926002502 ; diff loss =  0.0 ; diff weight =  5.410198355093598e-06
lambda is : 0.014677992676220709, cost : 2.3 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 18:20:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 498, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  493 ; minimum lost =  0.6165564060211182 ; diff loss =  0.0 ; diff weight =  4.7939756768755615e-05
lambda is : 0.02154434690031885, cost : 0.425 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 18:20:33 Max_iter: 1000
At iteration 504, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  504 ; minimum lost =  0.637737512588501 ; diff loss =  0.0 ; diff weight =  2.1532723621930927e-05
lambda is : 0.0316227766016838, cost : 0.325 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 18:20:52 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 457, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  458 ; minimum lost =  0.6574567556381226 ; diff loss =  5.960464477539063e-08 ; diff weight =  5.518461421161192e-07
lambda is : 0.04641588833612786, cost : 0.304 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 18:21:11 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 299, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  300 ; minimum lost =  0.6744875907897949 ; diff loss =  1.7881393432617188e-07 ; diff weight =  4.2133675037803187e-07
lambda is : 0.0681292069057962, cost : 0.202 min
==========
Testing lambda: 0.1 starting at 2024-09-27 18:21:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 437, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  438 ; minimum lost =  0.6876704692840576 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.128963529912653e-07
lambda is : 0.10000000000000002, cost : 0.309 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.409540    0.184588          0.185119           11264  0.993020  0.935970  0.881884   0.845779  0.886809      0.462796       0.000057
0.000015    0.388234    0.203226          0.203496           10678  0.992483  0.935402  0.880850   0.845528  0.885860      0.465358       0.000061
0.000022    0.363947    0.225090          0.225908           10010  0.993835  0.938178  0.880553   0.851485  0.885837      0.467598       0.000059
0.000032    0.338896    0.244086          0.244733            9321  0.994491  0.942031  0.896055   0.864909  0.900515      0.470095       0.000056
0.000046    0.310573    0.268459          0.268489            8542  0.993610  0.937008  0.896373   0.868771  0.900947      0.473674       0.000067
Exporting resultDF
Exporting result Dict
CD16_Mono Time elapsed: 73.35918555259704 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_CTL
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 18:22:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 569, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  568 ; minimum lost =  0.6457169651985168 ; diff loss =  0.0 ; diff weight =  0.00016172575124073774
lambda is : 9.999999999999997e-06, cost : 0.603 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 18:22:48 Max_iter: 1000
At iteration 544, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  545 ; minimum lost =  0.6493345499038696 ; diff loss =  1.7881393432617188e-07 ; diff weight =  7.989776804606663e-07
lambda is : 1.4677992676220687e-05, cost : 0.556 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 18:23:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 557, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  558 ; minimum lost =  0.6530837416648865 ; diff loss =  1.1920928955078125e-07 ; diff weight =  7.495256113543292e-07
lambda is : 2.1544346900318854e-05, cost : 0.553 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 18:23:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 582, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  582 ; minimum lost =  0.6569234132766724 ; diff loss =  0.0 ; diff weight =  7.510747764172265e-06
lambda is : 3.16227766016838e-05, cost : 0.556 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 18:24:28 Max_iter: 1000
At iteration 594, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  592 ; minimum lost =  0.6607515215873718 ; diff loss =  0.0 ; diff weight =  3.9287599065573886e-05
lambda is : 4.6415888336127784e-05, cost : 0.531 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 18:25:00 Max_iter: 1000
At iteration 545, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  542 ; minimum lost =  0.6644929647445679 ; diff loss =  0.0 ; diff weight =  6.098506128182635e-05
lambda is : 6.81292069057961e-05, cost : 0.475 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 18:25:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 540, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  539 ; minimum lost =  0.6680184006690979 ; diff loss =  0.0 ; diff weight =  4.7425786760868505e-05
lambda is : 9.999999999999991e-05, cost : 0.45 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 18:25:55 Max_iter: 1000
At iteration 543, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  543 ; minimum lost =  0.671267569065094 ; diff loss =  0.0 ; diff weight =  2.6613547561282758e-06
lambda is : 0.00014677992676220703, cost : 0.46 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 18:26:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 500, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  492 ; minimum lost =  0.6742129325866699 ; diff loss =  0.0 ; diff weight =  4.800407168659149e-06
lambda is : 0.0002154434690031884, cost : 0.408 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 18:26:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 480, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  476 ; minimum lost =  0.6768639087677002 ; diff loss =  0.0 ; diff weight =  4.613780038198456e-05
lambda is : 0.00031622776601683783, cost : 0.367 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 18:27:09 Max_iter: 1000
At iteration 428, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  427 ; minimum lost =  0.6792263388633728 ; diff loss =  0.0 ; diff weight =  0.0001014524677884765
lambda is : 0.00046415888336127795, cost : 0.312 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 18:27:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 431, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  431 ; minimum lost =  0.6813028454780579 ; diff loss =  0.0 ; diff weight =  2.6673216780181974e-05
lambda is : 0.0006812920690579617, cost : 0.316 min
==========
Testing lambda: 0.001 starting at 2024-09-27 18:27:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 442, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  442 ; minimum lost =  0.6831443905830383 ; diff loss =  0.0 ; diff weight =  2.6342246201238595e-05
lambda is : 0.0010000000000000002, cost : 0.312 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 18:28:06 Max_iter: 1000
At iteration 438, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  438 ; minimum lost =  0.6848633289337158 ; diff loss =  0.0 ; diff weight =  4.7386922233272344e-05
lambda is : 0.0014677992676220694, cost : 0.306 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 18:28:24 Max_iter: 1000
At iteration 447, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  448 ; minimum lost =  0.6866530776023865 ; diff loss =  5.960464477539063e-08 ; diff weight =  7.759705908938486e-07
lambda is : 0.0021544346900318843, cost : 0.292 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 18:28:42 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 516, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  516 ; minimum lost =  0.6884137392044067 ; diff loss =  0.0 ; diff weight =  7.952159648993984e-06
lambda is : 0.003162277660168382, cost : 0.34 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 18:29:02 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 535, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  535 ; minimum lost =  0.6898447871208191 ; diff loss =  0.0 ; diff weight =  1.0450454510646523e-06
lambda is : 0.004641588833612781, cost : 0.364 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 18:29:24 Max_iter: 1000
At iteration 350, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  351 ; minimum lost =  0.6908015608787537 ; diff loss =  1.1920928955078125e-07 ; diff weight =  9.876395097307977e-07
lambda is : 0.006812920690579613, cost : 0.231 min
==========
Testing lambda: 0.01 starting at 2024-09-27 18:29:38 Max_iter: 1000
At iteration 365, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  364 ; minimum lost =  0.6914893984794617 ; diff loss =  0.0 ; diff weight =  1.8650682250154205e-05
lambda is : 0.010000000000000004, cost : 0.243 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 18:29:52 Max_iter: 1000
At iteration 259, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  258 ; minimum lost =  0.6921197772026062 ; diff loss =  0.0 ; diff weight =  8.547125617042184e-06
lambda is : 0.014677992676220709, cost : 0.181 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 18:30:03 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 156, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  157 ; minimum lost =  0.6926786303520203 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.942979335784912e-07
lambda is : 0.02154434690031885, cost : 0.12 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 18:30:10 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 115, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  116 ; minimum lost =  0.6930997371673584 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.1047890186309814e-07
lambda is : 0.0316227766016838, cost : 0.1 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 18:30:16 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.018 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 18:30:18 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-27 18:30:18 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.342277    0.102857          0.102715            9414  0.989253  0.884564  0.800036   0.728745  0.800000      0.645717   1.617258e-04
0.000015    0.312355    0.114286          0.113341            8591  0.989030  0.889802  0.809391   0.784404  0.812352      0.649335   7.989777e-07
0.000022    0.282104    0.126667          0.126328            7759  0.989168  0.892688  0.830665   0.797297  0.832941      0.653084   7.495256e-07
0.000032    0.249309    0.141905          0.142857            6857  0.989859  0.900342  0.825866   0.792793  0.828235      0.656923   7.510748e-06
0.000046    0.214405    0.162857          0.164109            5897  0.989414  0.904774  0.822007   0.803738  0.824940      0.660752   3.928760e-05
Exporting resultDF
Exporting result Dict
CD4_CTL Time elapsed: 8.253396586577098 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_Naive
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 18:30:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.35747474431991577 ; diff loss =  3.4570693969726562e-06 ; diff weight =  0.0007192870834842324
lambda is : 9.999999999999997e-06, cost : 1.007 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 18:31:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.4026680886745453 ; diff loss =  5.424022674560547e-06 ; diff weight =  0.0007468796684406698
lambda is : 1.4677992676220687e-05, cost : 1.032 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 18:32:52 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  706 ; minimum lost =  0.4617633521556854 ; diff loss =  6.3478946685791016e-06 ; diff weight =  1.5231848010444082e-05
lambda is : 2.1544346900318854e-05, cost : 1.249 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 18:34:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 733, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  733 ; minimum lost =  0.4717784523963928 ; diff loss =  0.0 ; diff weight =  1.2102359505661298e-05
lambda is : 3.16227766016838e-05, cost : 0.933 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 18:35:03 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 705, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  700 ; minimum lost =  0.48199889063835144 ; diff loss =  0.0 ; diff weight =  1.1599071285672835e-06
lambda is : 4.6415888336127784e-05, cost : 0.948 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 18:36:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 672, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  670 ; minimum lost =  0.4923153519630432 ; diff loss =  0.0 ; diff weight =  3.2333991839550436e-05
lambda is : 6.81292069057961e-05, cost : 0.672 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 18:36:40 Max_iter: 1000
At iteration 625, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  626 ; minimum lost =  0.5027667284011841 ; diff loss =  5.960464477539063e-08 ; diff weight =  5.40566304607637e-07
lambda is : 9.999999999999991e-05, cost : 0.514 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 18:37:11 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 637, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  637 ; minimum lost =  0.5130820870399475 ; diff loss =  0.0 ; diff weight =  9.386667443322949e-06
lambda is : 0.00014677992676220703, cost : 0.523 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 18:37:42 Max_iter: 1000
At iteration 655, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  655 ; minimum lost =  0.523308515548706 ; diff loss =  0.0 ; diff weight =  1.0269866834278218e-05
lambda is : 0.0002154434690031884, cost : 0.503 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 18:38:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 594, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  593 ; minimum lost =  0.5334950089454651 ; diff loss =  0.0 ; diff weight =  3.22302475979086e-05
lambda is : 0.00031622776601683783, cost : 0.465 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 18:38:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 498, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  499 ; minimum lost =  0.5436239242553711 ; diff loss =  5.960464477539063e-08 ; diff weight =  7.553366572210507e-07
lambda is : 0.00046415888336127795, cost : 0.41 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 18:39:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 456, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  456 ; minimum lost =  0.5539873838424683 ; diff loss =  0.0 ; diff weight =  3.973148977820529e-06
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.36 min
==========
Testing lambda: 0.001 starting at 2024-09-27 18:39:26 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 506, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  503 ; minimum lost =  0.5646928548812866 ; diff loss =  0.0 ; diff weight =  5.766104732174426e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.375 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 18:39:49 Max_iter: 1000
At iteration 516, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  516 ; minimum lost =  0.5754716992378235 ; diff loss =  0.0 ; diff weight =  2.428183870506473e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.363 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 18:40:11 Max_iter: 1000
At iteration 542, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  542 ; minimum lost =  0.5857284069061279 ; diff loss =  0.0 ; diff weight =  1.3616490832646377e-05
lambda is : 0.0021544346900318843, cost : 0.37 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 18:40:33 Max_iter: 1000
At iteration 578, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  578 ; minimum lost =  0.5958928465843201 ; diff loss =  0.0 ; diff weight =  1.0391053137936979e-06
lambda is : 0.003162277660168382, cost : 0.394 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 18:40:57 Max_iter: 1000
At iteration 519, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  520 ; minimum lost =  0.6059120297431946 ; diff loss =  5.960464477539063e-08 ; diff weight =  8.249282501537891e-08
lambda is : 0.004641588833612781, cost : 0.345 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 18:41:17 Max_iter: 1000
At iteration 478, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  478 ; minimum lost =  0.6163898706436157 ; diff loss =  0.0 ; diff weight =  2.1884978195885196e-05
lambda is : 0.006812920690579613, cost : 0.312 min
==========
Testing lambda: 0.01 starting at 2024-09-27 18:41:36 Max_iter: 1000
At iteration 492, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  493 ; minimum lost =  0.6278135180473328 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.638910576839407e-07
lambda is : 0.010000000000000004, cost : 0.318 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 18:41:55 Max_iter: 1000
At iteration 512, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  513 ; minimum lost =  0.6397753953933716 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.896696168543713e-07
lambda is : 0.014677992676220709, cost : 0.335 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 18:42:15 Max_iter: 1000
At iteration 515, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  516 ; minimum lost =  0.6527760028839111 ; diff loss =  5.960464477539063e-08 ; diff weight =  7.785486104694428e-07
lambda is : 0.02154434690031885, cost : 0.339 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 18:42:36 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 505, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  502 ; minimum lost =  0.666428804397583 ; diff loss =  0.0 ; diff weight =  1.6508476619492285e-05
lambda is : 0.0316227766016838, cost : 0.337 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 18:42:56 Max_iter: 1000
At iteration 501, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  501 ; minimum lost =  0.6793808937072754 ; diff loss =  0.0 ; diff weight =  1.7933931303559802e-05
lambda is : 0.04641588833612786, cost : 0.324 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 18:43:15 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 575, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  574 ; minimum lost =  0.6891046762466431 ; diff loss =  0.0 ; diff weight =  1.183810695692955e-06
lambda is : 0.0681292069057962, cost : 0.38 min
==========
Testing lambda: 0.1 starting at 2024-09-27 18:43:38 Max_iter: 1000
At iteration 74, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  72 ; minimum lost =  0.6931458711624146 ; diff loss =  0.0 ; diff weight =  2.488028258085251e-06
lambda is : 0.10000000000000002, cost : 0.081 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.334533    0.093801          0.094085            9201  0.993000  0.957446  0.872405   0.825879  0.883006      0.357475       0.000719
0.000015    0.310028    0.104041          0.103905            8527  0.992372  0.953044  0.866917   0.822258  0.878153      0.402668       0.000747
0.000022    0.290612    0.110989          0.111441            7993  0.993097  0.957828  0.872164   0.828640  0.882983      0.461763       0.000015
0.000032    0.256145    0.127446          0.127883            7045  0.993199  0.956377  0.876544   0.831994  0.886889      0.471778       0.000012
0.000046    0.221640    0.145091          0.145239            6096  0.993375  0.956505  0.882284   0.845649  0.892548      0.481999       0.000001
Exporting resultDF
Exporting result Dict
CD4_Naive Time elapsed: 13.02588655948639 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_Proliferating
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 18:44:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.39706069231033325 ; diff loss =  5.960464477539063e-08 ; diff weight =  0.0002114869566867128
lambda is : 9.999999999999997e-06, cost : 0.936 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 18:45:10 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 961, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  961 ; minimum lost =  0.4969853162765503 ; diff loss =  0.0 ; diff weight =  0.0001861222553998232
lambda is : 1.4677992676220687e-05, cost : 0.899 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 18:46:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 953, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  953 ; minimum lost =  0.5971555113792419 ; diff loss =  0.0 ; diff weight =  7.7259392128326e-05
lambda is : 2.1544346900318854e-05, cost : 0.842 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 18:46:54 Max_iter: 1000
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  985 ; minimum lost =  0.6648792028427124 ; diff loss =  0.0 ; diff weight =  0.00031229498563334346
lambda is : 3.16227766016838e-05, cost : 0.856 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 18:47:45 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 536, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  536 ; minimum lost =  0.6708064675331116 ; diff loss =  0.0 ; diff weight =  6.9486968641285785e-06
lambda is : 4.6415888336127784e-05, cost : 0.565 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 18:48:19 Max_iter: 1000
At iteration 521, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  522 ; minimum lost =  0.6737739443778992 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.011179726148839e-07
lambda is : 6.81292069057961e-05, cost : 0.537 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 18:48:52 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 539, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  537 ; minimum lost =  0.6768408417701721 ; diff loss =  0.0 ; diff weight =  2.2040127078071237e-05
lambda is : 9.999999999999991e-05, cost : 0.543 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 18:49:24 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 489, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  490 ; minimum lost =  0.6799887418746948 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.3369496204850293e-07
lambda is : 0.00014677992676220703, cost : 0.474 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 18:49:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 463, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  463 ; minimum lost =  0.6830759644508362 ; diff loss =  0.0 ; diff weight =  1.8008186088991351e-06
lambda is : 0.0002154434690031884, cost : 0.437 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 18:50:19 Max_iter: 1000
At iteration 411, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  412 ; minimum lost =  0.6859636902809143 ; diff loss =  5.960464477539063e-08 ; diff weight =  5.911981020290114e-07
lambda is : 0.00031622776601683783, cost : 0.369 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 18:50:41 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 426, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  425 ; minimum lost =  0.6884194016456604 ; diff loss =  0.0 ; diff weight =  1.2871193575847428e-05
lambda is : 0.00046415888336127795, cost : 0.367 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 18:51:03 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 335, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  336 ; minimum lost =  0.6902595162391663 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.0230780251040414e-07
lambda is : 0.0006812920690579617, cost : 0.275 min
==========
Testing lambda: 0.001 starting at 2024-09-27 18:51:19 Max_iter: 1000
At iteration 416, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  417 ; minimum lost =  0.6914694905281067 ; diff loss =  5.960464477539063e-08 ; diff weight =  5.572465511249902e-07
lambda is : 0.0010000000000000002, cost : 0.303 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 18:51:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 252, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  253 ; minimum lost =  0.6921144127845764 ; diff loss =  1.7881393432617188e-07 ; diff weight =  3.8384465028684644e-07
lambda is : 0.0014677992676220694, cost : 0.18 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 18:51:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 261, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  261 ; minimum lost =  0.6923828125 ; diff loss =  0.0 ; diff weight =  4.136010375077603e-06
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.189 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 18:52:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 259, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  260 ; minimum lost =  0.692550778388977 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.913521939262864e-07
lambda is : 0.003162277660168382, cost : 0.18 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 18:52:11 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 208, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  209 ; minimum lost =  0.6927222013473511 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.784121069358662e-07
lambda is : 0.004641588833612781, cost : 0.162 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 18:52:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 195, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  194 ; minimum lost =  0.6929015517234802 ; diff loss =  0.0 ; diff weight =  2.8697702873614617e-05
lambda is : 0.006812920690579613, cost : 0.154 min
==========
Testing lambda: 0.01 starting at 2024-09-27 18:52:30 Max_iter: 1000
At iteration 163, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  164 ; minimum lost =  0.6930667757987976 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.3975595076517493e-07
lambda is : 0.010000000000000004, cost : 0.129 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 18:52:37 Max_iter: 1000
At iteration 7, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  7 ; minimum lost =  0.6931467652320862 ; diff loss =  0.0 ; diff weight =  2.9563583666458726e-05
lambda is : 0.014677992676220709, cost : 0.03 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 18:52:39 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.02154434690031885, cost : 0.015 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 18:52:40 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.015 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 18:52:41 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.015 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 18:52:42 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.015 min
==========
Testing lambda: 0.1 starting at 2024-09-27 18:52:43 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.015 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.353149    0.375000          0.382716            9713  0.924678  0.462111  0.573267   0.631579  0.571429      0.397061       0.000211
0.000015    0.350640    0.375000          0.382716            9644  0.928090  0.431873  0.511970   0.550000  0.511628      0.496985       0.000186
0.000022    0.348640    0.384615          0.395062            9589  0.928799  0.583091  0.652108   0.700000  0.651163      0.597156       0.000077
0.000032    0.347840    0.375000          0.395062            9567  0.937752  0.610633  0.605395   0.650000  0.604651      0.664879       0.000312
0.000046    0.325698    0.403846          0.419753            8958  0.979336  0.480554  0.477216   0.478261  0.478261      0.670806       0.000007
Exporting resultDF
Exporting result Dict
CD4_Proliferating Time elapsed: 8.638339718182882 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_TCM
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 18:53:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  696 ; minimum lost =  0.28980687260627747 ; diff loss =  -1.6391277313232422e-06 ; diff weight =  0.0003195214958395809
lambda is : 9.999999999999997e-06, cost : 3.886 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 18:57:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  863 ; minimum lost =  0.3211129605770111 ; diff loss =  -1.2367963790893555e-05 ; diff weight =  1.3366434359340928e-05
lambda is : 1.4677992676220687e-05, cost : 2.364 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 18:59:29 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  641 ; minimum lost =  0.32152876257896423 ; diff loss =  -1.4901161193847656e-07 ; diff weight =  5.907729246246163e-06
lambda is : 2.1544346900318854e-05, cost : 4.389 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 19:03:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.3536493182182312 ; diff loss =  4.76837158203125e-07 ; diff weight =  9.936431160895154e-05
lambda is : 3.16227766016838e-05, cost : 1.049 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 19:04:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 983, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  983 ; minimum lost =  0.39450520277023315 ; diff loss =  0.0 ; diff weight =  1.8867941662392695e-06
lambda is : 4.6415888336127784e-05, cost : 0.993 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 19:05:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.44764965772628784 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.3186701582744718e-05
lambda is : 6.81292069057961e-05, cost : 0.989 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 19:06:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.5138052701950073 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.8882989024859853e-05
lambda is : 9.999999999999991e-05, cost : 0.981 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 19:07:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  602 ; minimum lost =  0.5620365142822266 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.297657167422585e-05
lambda is : 0.00014677992676220703, cost : 1.075 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 19:08:58 Max_iter: 1000
At iteration 580, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  579 ; minimum lost =  0.5701576471328735 ; diff loss =  0.0 ; diff weight =  2.0327247511886526e-06
lambda is : 0.0002154434690031884, cost : 0.479 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 19:09:27 Max_iter: 1000
At iteration 559, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  560 ; minimum lost =  0.5776861310005188 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.921796966707916e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00031622776601683783, cost : 0.485 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 19:09:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 539, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  539 ; minimum lost =  0.585229218006134 ; diff loss =  0.0 ; diff weight =  4.30064255851903e-06
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00046415888336127795, cost : 0.456 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 19:10:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 549, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  547 ; minimum lost =  0.5929972529411316 ; diff loss =  0.0 ; diff weight =  2.66193146671867e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.432 min
==========
Testing lambda: 0.001 starting at 2024-09-27 19:10:49 Max_iter: 1000
At iteration 514, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  502 ; minimum lost =  0.6009703278541565 ; diff loss =  0.0 ; diff weight =  1.911576146085281e-05
lambda is : 0.0010000000000000002, cost : 0.369 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 19:11:11 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 486, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  486 ; minimum lost =  0.6089199781417847 ; diff loss =  0.0 ; diff weight =  3.7474910641321912e-06
lambda is : 0.0014677992676220694, cost : 0.344 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 19:11:32 Max_iter: 1000
At iteration 489, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  486 ; minimum lost =  0.6167744994163513 ; diff loss =  0.0 ; diff weight =  2.4388704332523048e-05
lambda is : 0.0021544346900318843, cost : 0.332 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 19:11:52 Max_iter: 1000
At iteration 471, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  471 ; minimum lost =  0.6246443390846252 ; diff loss =  0.0 ; diff weight =  3.7987742871337105e-06
lambda is : 0.003162277660168382, cost : 0.324 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 19:12:11 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 442, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  443 ; minimum lost =  0.6332653164863586 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.470658841957629e-07
lambda is : 0.004641588833612781, cost : 0.29 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 19:12:29 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 446, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  445 ; minimum lost =  0.6427685022354126 ; diff loss =  0.0 ; diff weight =  1.1323447324684821e-05
lambda is : 0.006812920690579613, cost : 0.301 min
==========
Testing lambda: 0.01 starting at 2024-09-27 19:12:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 438, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  436 ; minimum lost =  0.6530568599700928 ; diff loss =  0.0 ; diff weight =  3.133781865471974e-05
lambda is : 0.010000000000000004, cost : 0.297 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 19:13:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 521, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  520 ; minimum lost =  0.6633342504501343 ; diff loss =  0.0 ; diff weight =  5.702384896721924e-06
lambda is : 0.014677992676220709, cost : 0.342 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 19:13:25 Max_iter: 1000
At iteration 500, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  501 ; minimum lost =  0.6723794937133789 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.213098409560189e-07
lambda is : 0.02154434690031885, cost : 0.328 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 19:13:45 Max_iter: 1000
At iteration 594, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  595 ; minimum lost =  0.6806237101554871 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.541540820606315e-07
lambda is : 0.0316227766016838, cost : 0.377 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 19:14:07 Max_iter: 1000
At iteration 667, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  666 ; minimum lost =  0.6870033144950867 ; diff loss =  0.0 ; diff weight =  8.510276529705152e-06
lambda is : 0.04641588833612786, cost : 0.423 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 19:14:33 Max_iter: 1000
At iteration 224, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  218 ; minimum lost =  0.6913931965827942 ; diff loss =  0.0 ; diff weight =  6.281475634750677e-06
lambda is : 0.0681292069057962, cost : 0.169 min
==========
Testing lambda: 0.1 starting at 2024-09-27 19:14:43 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.335079    0.121169          0.121505            9216  0.971631  0.829459  0.743156   0.708126  0.765233      0.289807       0.000320
0.000015    0.302247    0.133468          0.133960            8313  0.969447  0.822894  0.741827   0.716354  0.764545      0.321113       0.000013
0.000022    0.284177    0.145363          0.145780            7816  0.970639  0.826427  0.738073   0.724077  0.761553      0.321529       0.000006
0.000032    0.243019    0.162702          0.162938            6684  0.970472  0.824999  0.732118   0.708440  0.755798      0.353649       0.000099
0.000046    0.213133    0.181048          0.181622            5862  0.968710  0.820774  0.730010   0.718062  0.754280      0.394505       0.000002
Exporting resultDF
Exporting result Dict
CD4_TCM Time elapsed: 21.620912027359008 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD4_TEM
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 19:15:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 631, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  631 ; minimum lost =  0.633583664894104 ; diff loss =  0.0 ; diff weight =  1.6479233408972505e-06
lambda is : 9.999999999999997e-06, cost : 0.653 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 19:15:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 592, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  592 ; minimum lost =  0.6376332640647888 ; diff loss =  0.0 ; diff weight =  7.157999334594933e-06
lambda is : 1.4677992676220687e-05, cost : 0.604 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 19:16:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 559, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  559 ; minimum lost =  0.6418198943138123 ; diff loss =  0.0 ; diff weight =  6.895761544001289e-06
lambda is : 2.1544346900318854e-05, cost : 0.564 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 19:17:03 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 607, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  607 ; minimum lost =  0.6461004614830017 ; diff loss =  0.0 ; diff weight =  1.0802365295603522e-06
lambda is : 3.16227766016838e-05, cost : 0.577 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 19:17:38 Max_iter: 1000
At iteration 570, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  570 ; minimum lost =  0.6504222750663757 ; diff loss =  0.0 ; diff weight =  3.484497938188724e-05
lambda is : 4.6415888336127784e-05, cost : 0.529 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 19:18:10 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 527, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  527 ; minimum lost =  0.6546915173530579 ; diff loss =  0.0 ; diff weight =  7.899029697000515e-06
lambda is : 6.81292069057961e-05, cost : 0.48 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 19:18:39 Max_iter: 1000
At iteration 562, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  562 ; minimum lost =  0.658772885799408 ; diff loss =  0.0 ; diff weight =  1.758981125021819e-05
lambda is : 9.999999999999991e-05, cost : 0.493 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 19:19:08 Max_iter: 1000
At iteration 499, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  498 ; minimum lost =  0.6625552177429199 ; diff loss =  0.0 ; diff weight =  9.33394258026965e-05
lambda is : 0.00014677992676220703, cost : 0.418 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 19:19:33 Max_iter: 1000
At iteration 487, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  487 ; minimum lost =  0.6659545302391052 ; diff loss =  0.0 ; diff weight =  1.1990487109869719e-05
lambda is : 0.0002154434690031884, cost : 0.398 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 19:19:57 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 478, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  477 ; minimum lost =  0.6689903140068054 ; diff loss =  0.0 ; diff weight =  1.6195845091715455e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00031622776601683783, cost : 0.426 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 19:20:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 433, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  433 ; minimum lost =  0.6716911792755127 ; diff loss =  0.0 ; diff weight =  2.3509524908149615e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00046415888336127795, cost : 0.352 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 19:20:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 446, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  444 ; minimum lost =  0.6741129755973816 ; diff loss =  0.0 ; diff weight =  7.78694375185296e-05
lambda is : 0.0006812920690579617, cost : 0.348 min
==========
Testing lambda: 0.001 starting at 2024-09-27 19:21:05 Max_iter: 1000
At iteration 448, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  448 ; minimum lost =  0.6763458847999573 ; diff loss =  0.0 ; diff weight =  2.5415092750336044e-05
lambda is : 0.0010000000000000002, cost : 0.322 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 19:21:24 Max_iter: 1000
At iteration 456, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  451 ; minimum lost =  0.6784606575965881 ; diff loss =  0.0 ; diff weight =  3.4465778298908845e-05
lambda is : 0.0014677992676220694, cost : 0.315 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 19:21:43 Max_iter: 1000
At iteration 487, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  488 ; minimum lost =  0.6805058121681213 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.3894399937016715e-07
lambda is : 0.0021544346900318843, cost : 0.317 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 19:22:02 Max_iter: 1000
At iteration 567, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  567 ; minimum lost =  0.6825150847434998 ; diff loss =  0.0 ; diff weight =  1.2137360499764327e-05
lambda is : 0.003162277660168382, cost : 0.367 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 19:22:24 Max_iter: 1000
At iteration 525, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  526 ; minimum lost =  0.6844350099563599 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.1143729845316557e-07
lambda is : 0.004641588833612781, cost : 0.336 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 19:22:44 Max_iter: 1000
At iteration 525, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  526 ; minimum lost =  0.6863408088684082 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.758824280135741e-07
lambda is : 0.006812920690579613, cost : 0.342 min
==========
Testing lambda: 0.01 starting at 2024-09-27 19:23:04 Max_iter: 1000
At iteration 470, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  466 ; minimum lost =  0.688045859336853 ; diff loss =  0.0 ; diff weight =  2.0983305148547515e-05
lambda is : 0.010000000000000004, cost : 0.312 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 19:23:23 Max_iter: 1000
At iteration 426, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  426 ; minimum lost =  0.6896668672561646 ; diff loss =  0.0 ; diff weight =  2.3773247448843904e-05
lambda is : 0.014677992676220709, cost : 0.274 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 19:23:40 Max_iter: 1000
At iteration 267, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  268 ; minimum lost =  0.6912064552307129 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.790330763171369e-07
lambda is : 0.02154434690031885, cost : 0.18 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 19:23:51 Max_iter: 1000
At iteration 219, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  220 ; minimum lost =  0.6923637986183167 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.3958425521850586e-07
lambda is : 0.0316227766016838, cost : 0.159 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 19:24:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 121, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  122 ; minimum lost =  0.6931033134460449 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.2351741790771484e-07
lambda is : 0.04641588833612786, cost : 0.106 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 19:24:06 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.017 min
==========
Testing lambda: 0.1 starting at 2024-09-27 19:24:07 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.015 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.353367    0.100428          0.100233            9719  0.957235  0.631838  0.595001   0.540816  0.605714      0.633584       0.000002
0.000015    0.323444    0.113279          0.113054            8896  0.959818  0.640789  0.613819   0.566596  0.624709      0.637633       0.000007
0.000022    0.293266    0.126606          0.125874            8066  0.963320  0.643797  0.608659   0.568035  0.620283      0.641820       0.000007
0.000032    0.257781    0.142789          0.142191            7090  0.963164  0.646324  0.595522   0.545643  0.606690      0.646100       0.000001
0.000046    0.223640    0.164208          0.163170            6151  0.964368  0.641037  0.601251   0.543434  0.611364      0.650422       0.000035
Exporting resultDF
Exporting result Dict
CD4_TEM Time elapsed: 9.0298495054245 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD8_Naive
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 19:24:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  324 ; minimum lost =  0.46343356370925903 ; diff loss =  0.00034224987030029297 ; diff weight =  7.38765811547637e-05
lambda is : 9.999999999999997e-06, cost : 3.705 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 19:28:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  325 ; minimum lost =  0.4700835347175598 ; diff loss =  8.058547973632812e-05 ; diff weight =  0.0001570299791637808
lambda is : 1.4677992676220687e-05, cost : 4.401 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 19:32:45 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  319 ; minimum lost =  0.47867369651794434 ; diff loss =  -8.940696716308594e-07 ; diff weight =  0.00011874319170601666
lambda is : 2.1544346900318854e-05, cost : 4.011 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 19:36:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  304 ; minimum lost =  0.4873991310596466 ; diff loss =  -1.2516975402832031e-06 ; diff weight =  8.48926865728572e-05
lambda is : 3.16227766016838e-05, cost : 4.15 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 19:40:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.4949834644794464 ; diff loss =  3.129243850708008e-06 ; diff weight =  0.00017361521895509213
lambda is : 4.6415888336127784e-05, cost : 2.778 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 19:43:41 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.49814072251319885 ; diff loss =  5.662441253662109e-07 ; diff weight =  8.727233216632158e-05
lambda is : 6.81292069057961e-05, cost : 2.52 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 19:46:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.5041996836662292 ; diff loss =  1.7881393432617188e-07 ; diff weight =  5.522556966752745e-05
lambda is : 9.999999999999991e-05, cost : 2.514 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 19:48:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.5137567520141602 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.457536149653606e-05
lambda is : 0.00014677992676220703, cost : 2.376 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 19:51:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.5281956195831299 ; diff loss =  2.980232238769531e-07 ; diff weight =  2.0130757548031397e-05
lambda is : 0.0002154434690031884, cost : 1.902 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 19:53:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 968, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  254 ; minimum lost =  0.5416678786277771 ; diff loss =  0.0 ; diff weight =  0.00017196862609125674
lambda is : 0.00031622776601683783, cost : 1.905 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 19:54:54 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 912, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  260 ; minimum lost =  0.5512040257453918 ; diff loss =  0.0 ; diff weight =  0.00016362930182367563
lambda is : 0.00046415888336127795, cost : 1.876 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 19:56:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 822, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  229 ; minimum lost =  0.5601470470428467 ; diff loss =  0.0 ; diff weight =  5.7692253903951496e-05
lambda is : 0.0006812920690579617, cost : 1.955 min
==========
Testing lambda: 0.001 starting at 2024-09-27 19:58:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 956, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  258 ; minimum lost =  0.569621205329895 ; diff loss =  1.7881393432617188e-07 ; diff weight =  7.587824075017124e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 2.093 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 20:00:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 872, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  312 ; minimum lost =  0.5804839730262756 ; diff loss =  2.384185791015625e-07 ; diff weight =  6.956230936339125e-05
lambda is : 0.0014677992676220694, cost : 1.885 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 20:02:43 Max_iter: 1000
At iteration 629, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  630 ; minimum lost =  0.5920626521110535 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.347016388488555e-07
lambda is : 0.0021544346900318843, cost : 0.45 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 20:03:10 Max_iter: 1000
At iteration 468, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  467 ; minimum lost =  0.6016666889190674 ; diff loss =  0.0 ; diff weight =  2.6813031581696123e-05
lambda is : 0.003162277660168382, cost : 0.306 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 20:03:28 Max_iter: 1000
At iteration 510, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  510 ; minimum lost =  0.6109058260917664 ; diff loss =  0.0 ; diff weight =  8.470668035442941e-06
lambda is : 0.004641588833612781, cost : 0.327 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 20:03:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 494, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  495 ; minimum lost =  0.6208613514900208 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.1687038181662501e-07
lambda is : 0.006812920690579613, cost : 0.322 min
==========
Testing lambda: 0.01 starting at 2024-09-27 20:04:07 Max_iter: 1000
At iteration 503, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  486 ; minimum lost =  0.6313596367835999 ; diff loss =  0.0 ; diff weight =  1.5776260624988936e-05
lambda is : 0.010000000000000004, cost : 0.334 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 20:04:27 Max_iter: 1000
At iteration 477, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  477 ; minimum lost =  0.6421469449996948 ; diff loss =  0.0 ; diff weight =  9.056372618942987e-06
lambda is : 0.014677992676220709, cost : 0.319 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 20:04:46 Max_iter: 1000
At iteration 563, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  564 ; minimum lost =  0.6526615023612976 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.0414855466933659e-07
lambda is : 0.02154434690031885, cost : 0.373 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 20:05:09 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 473, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  474 ; minimum lost =  0.6632664799690247 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.378465400302957e-08
lambda is : 0.0316227766016838, cost : 0.309 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 20:05:27 Max_iter: 1000
At iteration 536, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  536 ; minimum lost =  0.6726853847503662 ; diff loss =  0.0 ; diff weight =  7.095128694345476e-06
lambda is : 0.04641588833612786, cost : 0.354 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 20:05:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 253, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  254 ; minimum lost =  0.6815598011016846 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.980232238769531e-07
lambda is : 0.0681292069057962, cost : 0.19 min
==========
Testing lambda: 0.1 starting at 2024-09-27 20:06:00 Max_iter: 1000
At iteration 218, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  219 ; minimum lost =  0.6897485852241516 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.76837158203125e-07
lambda is : 0.10000000000000002, cost : 0.161 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.371401    0.097815          0.097538           10215  0.992250  0.965236  0.863460   0.803719  0.870733      0.463434       0.000074
0.000015    0.338460    0.110477          0.110315            9309  0.991035  0.962635  0.879617   0.836580  0.886976      0.470084       0.000157
0.000022    0.309846    0.122642          0.122468            8522  0.992389  0.964666  0.882730   0.845225  0.890173      0.478674       0.000119
0.000032    0.283195    0.136544          0.135868            7789  0.991680  0.964131  0.881636   0.846578  0.889275      0.487399       0.000085
0.000046    0.200189    0.178749          0.178560            5506  0.994173  0.970383  0.905144   0.881414  0.911557      0.494983       0.000174
Exporting resultDF
Exporting result Dict
CD8_Naive Time elapsed: 41.64379186630249 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD8_Proliferating
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 20:06:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  997 ; minimum lost =  0.37166914343833923 ; diff loss =  0.0 ; diff weight =  0.00014104081492405385
lambda is : 9.999999999999997e-06, cost : 0.872 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 20:07:32 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 902, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  901 ; minimum lost =  0.46927815675735474 ; diff loss =  0.0 ; diff weight =  6.144055078038946e-05
lambda is : 1.4677992676220687e-05, cost : 0.784 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 20:08:19 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 946, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  946 ; minimum lost =  0.5719643831253052 ; diff loss =  0.0 ; diff weight =  1.1952204204135342e-06
lambda is : 2.1544346900318854e-05, cost : 0.811 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 20:09:08 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 980, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  979 ; minimum lost =  0.6554649472236633 ; diff loss =  0.0 ; diff weight =  0.00023126248561311513
lambda is : 3.16227766016838e-05, cost : 0.849 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 20:09:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 596, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  594 ; minimum lost =  0.6740992665290833 ; diff loss =  0.0 ; diff weight =  3.38099998771213e-05
lambda is : 4.6415888336127784e-05, cost : 0.614 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 20:10:35 Max_iter: 1000
At iteration 587, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  583 ; minimum lost =  0.6771060228347778 ; diff loss =  0.0 ; diff weight =  2.88287119474262e-05
lambda is : 6.81292069057961e-05, cost : 0.579 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 20:11:10 Max_iter: 1000
At iteration 496, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  496 ; minimum lost =  0.6801481246948242 ; diff loss =  0.0 ; diff weight =  1.3281035535328556e-05
lambda is : 9.999999999999991e-05, cost : 0.477 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 20:11:39 Max_iter: 1000
At iteration 517, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  515 ; minimum lost =  0.6831559538841248 ; diff loss =  0.0 ; diff weight =  2.6615311071509495e-05
lambda is : 0.00014677992676220703, cost : 0.477 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 20:12:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 436, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  433 ; minimum lost =  0.6859763264656067 ; diff loss =  0.0 ; diff weight =  2.4686430606379872e-06
lambda is : 0.0002154434690031884, cost : 0.405 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 20:12:32 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 408, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  408 ; minimum lost =  0.6884506940841675 ; diff loss =  0.0 ; diff weight =  1.570220774738118e-05
lambda is : 0.00031622776601683783, cost : 0.355 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 20:12:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 291, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  292 ; minimum lost =  0.6903937458992004 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.073162417877029e-07
lambda is : 0.00046415888336127795, cost : 0.26 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 20:13:09 Max_iter: 1000
At iteration 416, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  415 ; minimum lost =  0.6917256116867065 ; diff loss =  0.0 ; diff weight =  1.011679955809086e-06
lambda is : 0.0006812920690579617, cost : 0.319 min
==========
Testing lambda: 0.001 starting at 2024-09-27 20:13:28 Max_iter: 1000
At iteration 362, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  363 ; minimum lost =  0.692474365234375 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.858795819018269e-07
lambda is : 0.0010000000000000002, cost : 0.257 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 20:13:43 Max_iter: 1000
At iteration 347, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  347 ; minimum lost =  0.6928166151046753 ; diff loss =  0.0 ; diff weight =  2.6816906029125676e-06
lambda is : 0.0014677992676220694, cost : 0.246 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 20:13:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 234, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  231 ; minimum lost =  0.692968487739563 ; diff loss =  0.0 ; diff weight =  3.3009015169227496e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.179 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 20:14:09 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 222, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  222 ; minimum lost =  0.6930581331253052 ; diff loss =  0.0 ; diff weight =  2.4809821752569405e-06
lambda is : 0.003162277660168382, cost : 0.164 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 20:14:19 Max_iter: 1000
At iteration 175, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  176 ; minimum lost =  0.6931157112121582 ; diff loss =  5.960464477539063e-08 ; diff weight =  9.481134384259349e-07
lambda is : 0.004641588833612781, cost : 0.144 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 20:14:27 Max_iter: 1000
At iteration 65, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  65 ; minimum lost =  0.693145751953125 ; diff loss =  0.0 ; diff weight =  1.0852232662728056e-05
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.006812920690579613, cost : 0.083 min
==========
Testing lambda: 0.01 starting at 2024-09-27 20:14:32 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.010000000000000004, cost : 0.017 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 20:14:33 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.014677992676220709, cost : 0.015 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 20:14:34 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.02154434690031885, cost : 0.015 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 20:14:35 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.015 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 20:14:36 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.015 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 20:14:37 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.015 min
==========
Testing lambda: 0.1 starting at 2024-09-27 20:14:38 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.015 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.330606    0.292135          0.309859            9093  0.923136  0.113224  0.234574   0.250000  0.235294      0.371669       0.000141
0.000015    0.327043    0.292135          0.309859            8995  0.938301  0.187110  0.221003   0.222222  0.222222      0.469278       0.000061
0.000022    0.325553    0.292135          0.309859            8954  0.946312  0.164932  0.215033   0.210526  0.216216      0.571964       0.000001
0.000032    0.323080    0.303371          0.309859            8886  0.939656  0.188026  0.204394   0.190476  0.205128      0.655465       0.000231
0.000046    0.307373    0.314607          0.323944            8454  0.923272  0.206580  0.170237   0.176471  0.171429      0.674099       0.000034
Exporting resultDF
Exporting result Dict
CD8_Proliferating Time elapsed: 8.109980034828187 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD8_TCM
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 20:15:09 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 624, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  625 ; minimum lost =  0.6424288749694824 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.405523839068337e-07
lambda is : 9.999999999999997e-06, cost : 0.661 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 20:15:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 661, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  659 ; minimum lost =  0.6463227868080139 ; diff loss =  0.0 ; diff weight =  4.507378616835922e-05
lambda is : 1.4677992676220687e-05, cost : 0.672 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 20:16:29 Max_iter: 1000
At iteration 667, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  668 ; minimum lost =  0.650337278842926 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.9398827905424696e-07
lambda is : 2.1544346900318854e-05, cost : 0.645 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 20:17:08 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 522, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  523 ; minimum lost =  0.6544191241264343 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.982333052794274e-07
lambda is : 3.16227766016838e-05, cost : 0.518 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 20:17:39 Max_iter: 1000
At iteration 560, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  561 ; minimum lost =  0.6585183143615723 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.440634479076834e-07
lambda is : 4.6415888336127784e-05, cost : 0.529 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 20:18:10 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 528, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  527 ; minimum lost =  0.6625290513038635 ; diff loss =  0.0 ; diff weight =  1.6715077435947023e-05
lambda is : 6.81292069057961e-05, cost : 0.474 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 20:18:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 490, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  488 ; minimum lost =  0.666355311870575 ; diff loss =  0.0 ; diff weight =  7.197800186986569e-06
lambda is : 9.999999999999991e-05, cost : 0.444 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 20:19:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 443, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  443 ; minimum lost =  0.6698489785194397 ; diff loss =  0.0 ; diff weight =  1.8319561831958708e-06
lambda is : 0.00014677992676220703, cost : 0.384 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 20:19:29 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 454, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  451 ; minimum lost =  0.6729827523231506 ; diff loss =  0.0 ; diff weight =  2.6392355721327476e-05
lambda is : 0.0002154434690031884, cost : 0.373 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 20:19:51 Max_iter: 1000
At iteration 477, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  478 ; minimum lost =  0.67580646276474 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.478882141891518e-07
lambda is : 0.00031622776601683783, cost : 0.368 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 20:20:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 410, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  408 ; minimum lost =  0.6783586740493774 ; diff loss =  0.0 ; diff weight =  2.5051849661394954e-05
lambda is : 0.00046415888336127795, cost : 0.322 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 20:20:32 Max_iter: 1000
At iteration 445, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  444 ; minimum lost =  0.6806966662406921 ; diff loss =  0.0 ; diff weight =  1.998914740397595e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.345 min
==========
Testing lambda: 0.001 starting at 2024-09-27 20:20:53 Max_iter: 1000
At iteration 403, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  404 ; minimum lost =  0.6828567385673523 ; diff loss =  5.960464477539063e-08 ; diff weight =  7.103812436071166e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.289 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 20:21:10 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 429, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  428 ; minimum lost =  0.6848262548446655 ; diff loss =  0.0 ; diff weight =  1.666594653215725e-05
lambda is : 0.0014677992676220694, cost : 0.302 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 20:21:29 Max_iter: 1000
At iteration 435, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  435 ; minimum lost =  0.6865385174751282 ; diff loss =  0.0 ; diff weight =  1.3736738765146583e-05
lambda is : 0.0021544346900318843, cost : 0.291 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 20:21:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 463, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  461 ; minimum lost =  0.6879639625549316 ; diff loss =  0.0 ; diff weight =  1.937417073349934e-05
lambda is : 0.003162277660168382, cost : 0.313 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 20:22:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 437, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  438 ; minimum lost =  0.6891467571258545 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.891444583179691e-07
lambda is : 0.004641588833612781, cost : 0.29 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 20:22:22 Max_iter: 1000
At iteration 452, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  452 ; minimum lost =  0.6900990009307861 ; diff loss =  0.0 ; diff weight =  1.8723269022302702e-05
lambda is : 0.006812920690579613, cost : 0.294 min
==========
Testing lambda: 0.01 starting at 2024-09-27 20:22:40 Max_iter: 1000
At iteration 424, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  420 ; minimum lost =  0.6909391283988953 ; diff loss =  0.0 ; diff weight =  2.6418414563522674e-05
lambda is : 0.010000000000000004, cost : 0.283 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 20:22:57 Max_iter: 1000
At iteration 242, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  236 ; minimum lost =  0.6917855739593506 ; diff loss =  0.0 ; diff weight =  1.8247061234433204e-05
lambda is : 0.014677992676220709, cost : 0.167 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 20:23:07 Max_iter: 1000
At iteration 185, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  186 ; minimum lost =  0.6926438808441162 ; diff loss =  8.940696716308594e-07 ; diff weight =  8.330002287948446e-08
lambda is : 0.02154434690031885, cost : 0.129 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 20:23:15 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 130, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  131 ; minimum lost =  0.6931374073028564 ; diff loss =  5.960464477539063e-08 ; diff weight =  8.66129994392395e-08
lambda is : 0.0316227766016838, cost : 0.127 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 20:23:22 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.018 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 20:23:23 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-27 20:23:24 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.357984    0.104554          0.104793            9846  0.975157  0.681382  0.633026   0.604839  0.642857      0.642429   4.405524e-07
0.000015    0.328461    0.116100          0.116166            9034  0.972169  0.681093  0.640225   0.620499  0.650218      0.646323   4.507379e-05
0.000022    0.298248    0.129570          0.129163            8203  0.972055  0.693991  0.655873   0.646552  0.665680      0.650337   2.939883e-07
0.000032    0.263598    0.146248          0.147035            7250  0.972802  0.699281  0.647170   0.627778  0.656977      0.654419   4.982333e-07
0.000046    0.228730    0.166132          0.166531            6291  0.971913  0.702017  0.654835   0.667692  0.664625      0.658518   6.440634e-07
Exporting resultDF
Exporting result Dict
CD8_TCM Time elapsed: 8.413489186763764 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for CD8_TEM
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 20:23:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 801, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  800 ; minimum lost =  0.5032347440719604 ; diff loss =  0.0 ; diff weight =  3.977285450673662e-05
lambda is : 9.999999999999997e-06, cost : 0.789 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 20:24:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 722, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  723 ; minimum lost =  0.5104721784591675 ; diff loss =  5.960464477539063e-08 ; diff weight =  7.477991630366887e-07
lambda is : 1.4677992676220687e-05, cost : 0.694 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 20:25:25 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 751, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  750 ; minimum lost =  0.5179955959320068 ; diff loss =  0.0 ; diff weight =  6.468120409408584e-05
lambda is : 2.1544346900318854e-05, cost : 0.688 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 20:26:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 711, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  711 ; minimum lost =  0.5257794857025146 ; diff loss =  0.0 ; diff weight =  1.4882848518027458e-06
lambda is : 3.16227766016838e-05, cost : 0.661 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 20:26:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 656, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  655 ; minimum lost =  0.533708393573761 ; diff loss =  0.0 ; diff weight =  1.1129693120892625e-05
lambda is : 4.6415888336127784e-05, cost : 0.588 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 20:27:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 735, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  734 ; minimum lost =  0.541599452495575 ; diff loss =  0.0 ; diff weight =  5.2219176723156124e-05
lambda is : 6.81292069057961e-05, cost : 0.649 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 20:28:00 Max_iter: 1000
At iteration 709, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  709 ; minimum lost =  0.5493404865264893 ; diff loss =  0.0 ; diff weight =  8.951401468948461e-06
lambda is : 9.999999999999991e-05, cost : 0.609 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 20:28:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 580, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  580 ; minimum lost =  0.5567857027053833 ; diff loss =  0.0 ; diff weight =  1.4627420569013339e-05
lambda is : 0.00014677992676220703, cost : 0.479 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 20:29:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 631, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  631 ; minimum lost =  0.5638802647590637 ; diff loss =  0.0 ; diff weight =  5.8936464483849704e-05
lambda is : 0.0002154434690031884, cost : 0.503 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 20:29:36 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 582, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  582 ; minimum lost =  0.5705476999282837 ; diff loss =  0.0 ; diff weight =  1.5423171362272114e-06
lambda is : 0.00031622776601683783, cost : 0.476 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 20:30:04 Max_iter: 1000
At iteration 536, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  536 ; minimum lost =  0.5768914818763733 ; diff loss =  0.0 ; diff weight =  8.33176000014646e-06
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00046415888336127795, cost : 0.427 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 20:30:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 497, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  497 ; minimum lost =  0.5832952857017517 ; diff loss =  0.0 ; diff weight =  3.7274189708114136e-06
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.379 min
==========
Testing lambda: 0.001 starting at 2024-09-27 20:30:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 496, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  497 ; minimum lost =  0.5901061296463013 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.581100938594318e-07
lambda is : 0.0010000000000000002, cost : 0.357 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 20:31:14 Max_iter: 1000
At iteration 505, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  506 ; minimum lost =  0.5973424315452576 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.102644647398847e-07
lambda is : 0.0014677992676220694, cost : 0.342 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 20:31:35 Max_iter: 1000
At iteration 486, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  487 ; minimum lost =  0.6047187447547913 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.936094460892491e-07
lambda is : 0.0021544346900318843, cost : 0.318 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 20:31:54 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 457, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  457 ; minimum lost =  0.6119043231010437 ; diff loss =  0.0 ; diff weight =  1.0672196140149026e-06
lambda is : 0.003162277660168382, cost : 0.308 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 20:32:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 440, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  440 ; minimum lost =  0.6194968819618225 ; diff loss =  0.0 ; diff weight =  2.5684673801151803e-06
lambda is : 0.004641588833612781, cost : 0.292 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 20:32:30 Max_iter: 1000
At iteration 515, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  515 ; minimum lost =  0.6274402141571045 ; diff loss =  0.0 ; diff weight =  6.9037332650623284e-06
lambda is : 0.006812920690579613, cost : 0.342 min
==========
Testing lambda: 0.01 starting at 2024-09-27 20:32:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 445, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  446 ; minimum lost =  0.6353359818458557 ; diff loss =  1.1920928955078125e-07 ; diff weight =  2.6409810516270227e-07
lambda is : 0.010000000000000004, cost : 0.288 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 20:33:07 Max_iter: 1000
At iteration 505, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  496 ; minimum lost =  0.6435959339141846 ; diff loss =  0.0 ; diff weight =  1.066453364728659e-06
lambda is : 0.014677992676220709, cost : 0.352 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 20:33:29 Max_iter: 1000
At iteration 515, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  516 ; minimum lost =  0.6522173881530762 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.125626335531706e-07
lambda is : 0.02154434690031885, cost : 0.349 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 20:33:50 Max_iter: 1000
At iteration 424, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  425 ; minimum lost =  0.6610652804374695 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.2609972088739596e-07
lambda is : 0.0316227766016838, cost : 0.279 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 20:34:06 Max_iter: 1000
At iteration 455, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  453 ; minimum lost =  0.6712036728858948 ; diff loss =  0.0 ; diff weight =  1.2393709766911343e-05
lambda is : 0.04641588833612786, cost : 0.299 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 20:34:24 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 252, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  252 ; minimum lost =  0.6818601489067078 ; diff loss =  0.0 ; diff weight =  6.3536463130731136e-06
lambda is : 0.0681292069057962, cost : 0.183 min
==========
Testing lambda: 0.1 starting at 2024-09-27 20:34:35 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 185, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  185 ; minimum lost =  0.6905772686004639 ; diff loss =  0.0 ; diff weight =  3.0681490898132324e-05
lambda is : 0.10000000000000002, cost : 0.136 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.361257    0.100681          0.100411            9936  0.988155  0.917189  0.813003   0.759095  0.824786      0.503235   3.977285e-05
0.000015    0.331334    0.112415          0.112155            9113  0.986182  0.908450  0.815615   0.772267  0.827998      0.510472   7.477992e-07
0.000022    0.302211    0.124149          0.123605            8312  0.988516  0.913366  0.821023   0.778455  0.833061      0.517996   6.468120e-05
0.000032    0.268506    0.138700          0.138285            7385  0.986525  0.907660  0.817557   0.784599  0.830396      0.525779   1.488285e-06
0.000046    0.233675    0.157475          0.156782            6427  0.986809  0.911636  0.826931   0.797682  0.839246      0.533708   1.112969e-05
Exporting resultDF
Exporting result Dict
CD8_TEM Time elapsed: 10.910659658908845 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Doublet
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 20:35:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 590, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  591 ; minimum lost =  0.658085823059082 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.757729475888482e-07
lambda is : 9.999999999999997e-06, cost : 0.666 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 20:35:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 739, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  739 ; minimum lost =  0.6613138318061829 ; diff loss =  0.0 ; diff weight =  1.2689115465036593e-05
lambda is : 1.4677992676220687e-05, cost : 0.77 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 20:36:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 577, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  578 ; minimum lost =  0.6645374894142151 ; diff loss =  1.1920928955078125e-07 ; diff weight =  6.778919896532898e-07
lambda is : 2.1544346900318854e-05, cost : 0.629 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 20:37:17 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 608, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  608 ; minimum lost =  0.6678103804588318 ; diff loss =  0.0 ; diff weight =  4.3731847654271405e-06
lambda is : 3.16227766016838e-05, cost : 0.634 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 20:37:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 560, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  560 ; minimum lost =  0.671147346496582 ; diff loss =  0.0 ; diff weight =  3.862732683046488e-06
lambda is : 4.6415888336127784e-05, cost : 0.579 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 20:38:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 577, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  577 ; minimum lost =  0.6745094656944275 ; diff loss =  0.0 ; diff weight =  6.080465027480386e-06
lambda is : 6.81292069057961e-05, cost : 0.571 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 20:39:04 Max_iter: 1000
At iteration 597, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  596 ; minimum lost =  0.6778285503387451 ; diff loss =  0.0 ; diff weight =  1.0647809176589362e-05
lambda is : 9.999999999999991e-05, cost : 0.542 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 20:39:37 Max_iter: 1000
At iteration 513, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  513 ; minimum lost =  0.6809863448143005 ; diff loss =  0.0 ; diff weight =  1.2109667295590043e-05
lambda is : 0.00014677992676220703, cost : 0.477 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 20:40:05 Max_iter: 1000
At iteration 460, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  460 ; minimum lost =  0.6838904619216919 ; diff loss =  0.0 ; diff weight =  4.673357034334913e-05
lambda is : 0.0002154434690031884, cost : 0.409 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 20:40:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 437, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  437 ; minimum lost =  0.6864213943481445 ; diff loss =  0.0 ; diff weight =  3.2076577554107644e-06
lambda is : 0.00031622776601683783, cost : 0.377 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 20:40:52 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 392, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  392 ; minimum lost =  0.6884623765945435 ; diff loss =  0.0 ; diff weight =  7.626186288689496e-06
lambda is : 0.00046415888336127795, cost : 0.326 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 20:41:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 409, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  409 ; minimum lost =  0.689928412437439 ; diff loss =  0.0 ; diff weight =  3.0304860047181137e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 0.337 min
==========
Testing lambda: 0.001 starting at 2024-09-27 20:41:32 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 385, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  383 ; minimum lost =  0.6908891201019287 ; diff loss =  0.0 ; diff weight =  7.39323440939188e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.292 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 20:41:50 Max_iter: 1000
At iteration 458, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  458 ; minimum lost =  0.6914840936660767 ; diff loss =  0.0 ; diff weight =  4.6476128773065284e-05
lambda is : 0.0014677992676220694, cost : 0.312 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 20:42:08 Max_iter: 1000
At iteration 353, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  352 ; minimum lost =  0.6918827295303345 ; diff loss =  0.0 ; diff weight =  9.955304449249525e-06
lambda is : 0.0021544346900318843, cost : 0.234 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 20:42:23 Max_iter: 1000
At iteration 288, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  288 ; minimum lost =  0.6921632289886475 ; diff loss =  0.0 ; diff weight =  1.122518824558938e-05
lambda is : 0.003162277660168382, cost : 0.193 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 20:42:34 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 262, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  262 ; minimum lost =  0.6924176812171936 ; diff loss =  0.0 ; diff weight =  2.154721187253017e-06
lambda is : 0.004641588833612781, cost : 0.186 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 20:42:45 Max_iter: 1000
At iteration 389, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  385 ; minimum lost =  0.6926849484443665 ; diff loss =  0.0 ; diff weight =  1.341101415164303e-05
lambda is : 0.006812920690579613, cost : 0.279 min
==========
Testing lambda: 0.01 starting at 2024-09-27 20:43:02 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 253, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  254 ; minimum lost =  0.6929453015327454 ; diff loss =  5.960464477539063e-08 ; diff weight =  8.455688771391578e-08
lambda is : 0.010000000000000004, cost : 0.194 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 20:43:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 112, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  113 ; minimum lost =  0.6931192278862 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.9319627142522222e-07
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
lambda is : 0.014677992676220709, cost : 0.1 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 20:43:20 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.02154434690031885, cost : 0.018 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 20:43:21 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.016 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 20:43:22 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.016 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 20:43:23 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-27 20:43:24 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.413104    0.181208          0.182336           11362  0.906503  0.220738  0.363649   0.327869  0.366972      0.658086   2.757729e-07
0.000015    0.383362    0.201342          0.202279           10544  0.909431  0.240194  0.381955   0.360360  0.386473      0.661314   1.268912e-05
0.000022    0.354094    0.223714          0.225071            9739  0.919761  0.276465  0.367603   0.351852  0.372549      0.664537   6.778920e-07
0.000032    0.323044    0.246085          0.247863            8885  0.922207  0.300050  0.344590   0.336538  0.350000      0.667810   4.373185e-06
0.000046    0.290540    0.272931          0.273504            7991  0.918843  0.292219  0.384412   0.393617  0.389474      0.671147   3.862733e-06
Exporting resultDF
Exporting result Dict
Doublet Time elapsed: 8.318361421426138 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Eryth
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 20:43:54 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  766 ; minimum lost =  0.1790224015712738 ; diff loss =  -8.195638656616211e-07 ; diff weight =  0.000505829113535583
lambda is : 9.999999999999997e-06, cost : 4.107 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 20:48:01 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  762 ; minimum lost =  0.1669500470161438 ; diff loss =  -3.2782554626464844e-07 ; diff weight =  7.813955744495615e-05
lambda is : 1.4677992676220687e-05, cost : 4.27 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 20:52:17 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  723 ; minimum lost =  0.1717967540025711 ; diff loss =  -2.9802322387695312e-08 ; diff weight =  0.0001280505966860801
lambda is : 2.1544346900318854e-05, cost : 4.338 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 20:56:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  937 ; minimum lost =  0.09850289672613144 ; diff loss =  -6.727874279022217e-06 ; diff weight =  0.10736197978258133
lambda is : 3.16227766016838e-05, cost : 4.842 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 21:01:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  620 ; minimum lost =  0.17756427824497223 ; diff loss =  -3.129243850708008e-07 ; diff weight =  0.00019266485469415784
lambda is : 4.6415888336127784e-05, cost : 5.196 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 21:06:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  635 ; minimum lost =  0.18461386859416962 ; diff loss =  -1.3262033462524414e-06 ; diff weight =  7.654802175238729e-05
lambda is : 6.81292069057961e-05, cost : 5.126 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 21:11:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  439 ; minimum lost =  0.17209097743034363 ; diff loss =  -9.47713851928711e-06 ; diff weight =  41.64524459838867
lambda is : 9.999999999999991e-05, cost : 6.954 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 21:18:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  535 ; minimum lost =  0.17812950909137726 ; diff loss =  -2.9355287551879883e-06 ; diff weight =  0.009187428280711174
lambda is : 0.00014677992676220703, cost : 5.98 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 21:24:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  382 ; minimum lost =  0.20459964871406555 ; diff loss =  -4.351139068603516e-06 ; diff weight =  0.24733178317546844
lambda is : 0.0002154434690031884, cost : 7.303 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 21:32:01 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  430 ; minimum lost =  0.24504780769348145 ; diff loss =  -8.881092071533203e-06 ; diff weight =  1.6968780755996704
lambda is : 0.00031622776601683783, cost : 7.206 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 21:39:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  436 ; minimum lost =  0.3121515214443207 ; diff loss =  -5.334615707397461e-06 ; diff weight =  1.7828482389450073
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00046415888336127795, cost : 7.172 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 21:46:24 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  481 ; minimum lost =  0.42880499362945557 ; diff loss =  -7.599592208862305e-06 ; diff weight =  0.0020849513821303844
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 6.318 min
==========
Testing lambda: 0.001 starting at 2024-09-27 21:52:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  695 ; minimum lost =  0.47151774168014526 ; diff loss =  -9.357929229736328e-06 ; diff weight =  9.59560347837396e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 6.257 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 21:58:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  475 ; minimum lost =  0.3553968667984009 ; diff loss =  -1.6689300537109375e-05 ; diff weight =  88.66924285888672
lambda is : 0.0014677992676220694, cost : 6.632 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 22:05:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  567 ; minimum lost =  0.5906310081481934 ; diff loss =  -2.980232238769531e-07 ; diff weight =  0.00045052729547023773
lambda is : 0.0021544346900318843, cost : 6.228 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 22:11:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  851 ; minimum lost =  0.6709723472595215 ; diff loss =  -5.960464477539062e-07 ; diff weight =  8.844053809298202e-05
lambda is : 0.003162277660168382, cost : 6.396 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 22:18:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 608, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  146 ; minimum lost =  0.6902889609336853 ; diff loss =  0.0 ; diff weight =  2.940249578387011e-05
lambda is : 0.004641588833612781, cost : 0.871 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 22:19:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 327, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  327 ; minimum lost =  0.6917023658752441 ; diff loss =  -6.556510925292969e-07 ; diff weight =  1.8609615608511376e-06
lambda is : 0.006812920690579613, cost : 0.281 min
==========
Testing lambda: 0.01 starting at 2024-09-27 22:19:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 234, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  234 ; minimum lost =  0.6925010681152344 ; diff loss =  0.0 ; diff weight =  0.00012001769209746271
lambda is : 0.010000000000000004, cost : 0.166 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 22:19:33 Max_iter: 1000
At iteration 197, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  198 ; minimum lost =  0.692933976650238 ; diff loss =  5.960464477539063e-08 ; diff weight =  5.080993901174224e-07
lambda is : 0.014677992676220709, cost : 0.152 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 22:19:42 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 33, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  33 ; minimum lost =  0.6931446194648743 ; diff loss =  0.0 ; diff weight =  2.5716542495501926e-06
lambda is : 0.02154434690031885, cost : 0.057 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 22:19:46 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.016 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 22:19:47 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.015 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 22:19:47 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.015 min
==========
Testing lambda: 0.1 starting at 2024-09-27 22:19:48 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.015 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.234875    0.132530          0.136364            6460  0.996226  0.868588  0.758874   0.700000  0.756757      0.179022       0.000506
0.000015    0.189972    0.156627          0.151515            5225  0.999759  0.908568  0.778637   0.736842  0.777778      0.166950       0.000078
0.000022    0.157832    0.180723          0.181818            4341  0.999601  0.835197  0.778637   0.736842  0.777778      0.171797       0.000128
0.000032    0.154959    0.192771          0.181818            4262  0.999288  0.892738  0.848658   0.875000  0.848485      0.098503       0.107362
0.000046    0.084024    0.265060          0.272727            2311  0.999918  0.942640  0.823268   0.823529  0.823529      0.177564       0.000193
Exporting resultDF
Exporting result Dict
Eryth Time elapsed: 96.0350071310997 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for HSPC
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 22:20:19 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  873 ; minimum lost =  0.03789833188056946 ; diff loss =  -5.282461643218994e-06 ; diff weight =  0.0010744824539870024
lambda is : 9.999999999999997e-06, cost : 3.053 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 22:23:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  939 ; minimum lost =  0.05085790902376175 ; diff loss =  -3.241002559661865e-07 ; diff weight =  0.03195805475115776
lambda is : 1.4677992676220687e-05, cost : 3.427 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 22:26:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  770 ; minimum lost =  0.039234790951013565 ; diff loss =  -7.338821887969971e-07 ; diff weight =  0.5793887972831726
lambda is : 2.1544346900318854e-05, cost : 3.844 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 22:30:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  767 ; minimum lost =  0.02142651565372944 ; diff loss =  -9.94652509689331e-07 ; diff weight =  39.111690521240234
lambda is : 3.16227766016838e-05, cost : 3.877 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 22:34:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.03670796751976013 ; diff loss =  1.4901161193847656e-08 ; diff weight =  8.350399730261415e-05
lambda is : 4.6415888336127784e-05, cost : 1.696 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 22:36:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  645 ; minimum lost =  0.059500012546777725 ; diff loss =  -4.805624485015869e-07 ; diff weight =  0.0009143592906184494
lambda is : 6.81292069057961e-05, cost : 4.847 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 22:41:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  908 ; minimum lost =  0.0763150155544281 ; diff loss =  -1.6391277313232422e-07 ; diff weight =  0.0022117134649306536
lambda is : 9.999999999999991e-05, cost : 5.05 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 22:46:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  614 ; minimum lost =  0.08742181956768036 ; diff loss =  -8.940696716308594e-07 ; diff weight =  0.00019100164354313165
lambda is : 0.00014677992676220703, cost : 5.159 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 22:51:16 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  732 ; minimum lost =  0.09443636238574982 ; diff loss =  -2.086162567138672e-07 ; diff weight =  0.00011832757445517927
lambda is : 0.0002154434690031884, cost : 4.021 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 22:55:18 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  583 ; minimum lost =  0.15068194270133972 ; diff loss =  -1.8775463104248047e-06 ; diff weight =  0.00011770385026466101
lambda is : 0.00031622776601683783, cost : 5.482 min
==========
Testing lambda: 0.000464 starting at 2024-09-27 23:00:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  521 ; minimum lost =  0.14841844141483307 ; diff loss =  -2.980232238769531e-07 ; diff weight =  13.731446266174316
lambda is : 0.00046415888336127795, cost : 6.043 min
==========
Testing lambda: 0.000681 starting at 2024-09-27 23:06:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  906 ; minimum lost =  0.23910662531852722 ; diff loss =  -8.195638656616211e-07 ; diff weight =  0.0009598329197615385
lambda is : 0.0006812920690579617, cost : 6.042 min
==========
Testing lambda: 0.001 starting at 2024-09-27 23:12:52 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  572 ; minimum lost =  0.2927102744579315 ; diff loss =  -2.7418136596679688e-06 ; diff weight =  4.661704952013679e-05
lambda is : 0.0010000000000000002, cost : 5.815 min
==========
Testing lambda: 0.001468 starting at 2024-09-27 23:18:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  546 ; minimum lost =  0.39790892601013184 ; diff loss =  -1.7285346984863281e-06 ; diff weight =  6.742976256646216e-05
lambda is : 0.0014677992676220694, cost : 6.051 min
==========
Testing lambda: 0.002154 starting at 2024-09-27 23:24:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  822 ; minimum lost =  0.49892234802246094 ; diff loss =  -1.9371509552001953e-06 ; diff weight =  0.0005266264779493213
lambda is : 0.0021544346900318843, cost : 6.04 min
==========
Testing lambda: 0.003162 starting at 2024-09-27 23:30:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  566 ; minimum lost =  0.5435452461242676 ; diff loss =  -1.7881393432617188e-07 ; diff weight =  0.0013137218775227666
lambda is : 0.003162277660168382, cost : 5.966 min
==========
Testing lambda: 0.004642 starting at 2024-09-27 23:36:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  638 ; minimum lost =  0.4418395459651947 ; diff loss =  -1.9073486328125e-06 ; diff weight =  0.0009128189994953573
lambda is : 0.004641588833612781, cost : 5.478 min
==========
Testing lambda: 0.006813 starting at 2024-09-27 23:42:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 810, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  808 ; minimum lost =  0.5543520450592041 ; diff loss =  0.0 ; diff weight =  3.226935223210603e-05
lambda is : 0.006812920690579613, cost : 1.892 min
==========
Testing lambda: 0.01 starting at 2024-09-27 23:44:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 486, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  150 ; minimum lost =  0.6819354891777039 ; diff loss =  1.7881393432617188e-06 ; diff weight =  0.00019403963233344257
lambda is : 0.010000000000000004, cost : 1.137 min
==========
Testing lambda: 0.014678 starting at 2024-09-27 23:45:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 419, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  418 ; minimum lost =  0.6896563768386841 ; diff loss =  0.0 ; diff weight =  8.593691745772958e-05
lambda is : 0.014677992676220709, cost : 0.374 min
==========
Testing lambda: 0.021544 starting at 2024-09-27 23:45:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 209, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  208 ; minimum lost =  0.6920546293258667 ; diff loss =  0.0 ; diff weight =  9.240074723493308e-05
lambda is : 0.02154434690031885, cost : 0.155 min
==========
Testing lambda: 0.031623 starting at 2024-09-27 23:45:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 158, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  155 ; minimum lost =  0.6930912137031555 ; diff loss =  0.0 ; diff weight =  4.379860547487624e-05
lambda is : 0.0316227766016838, cost : 0.155 min
==========
Testing lambda: 0.046416 starting at 2024-09-27 23:45:55 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.018 min
==========
Testing lambda: 0.068129 starting at 2024-09-27 23:45:56 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.015 min
==========
Testing lambda: 0.1 starting at 2024-09-27 23:45:57 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.228839    0.345725          0.350000            6294  0.999996  0.999192  0.829949   0.690141  0.816667      0.037898       0.001074
0.000015    0.265089    0.319703          0.322727            7291  1.000000  1.000000  0.818429   0.671233  0.803279      0.050858       0.031958
0.000022    0.169503    0.423792          0.427273            4662  0.999993  0.998445  0.881378   0.777778  0.875000      0.039235       0.579389
0.000032    0.106566    0.505576          0.504545            2931  0.999993  0.998445  0.910924   0.830508  0.907407      0.021427      39.111691
0.000046    0.038685    0.631970          0.636364            1064  0.999991  0.997986  0.960019   0.941176  0.960000      0.036708       0.000084
Exporting resultDF
Exporting result Dict
HSPC Time elapsed: 85.78089300394058 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for ILC
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-27 23:46:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  417 ; minimum lost =  0.4905540347099304 ; diff loss =  -3.93986701965332e-05 ; diff weight =  0.6674453020095825
lambda is : 9.999999999999997e-06, cost : 6.224 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-27 23:52:42 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  740 ; minimum lost =  0.45439738035202026 ; diff loss =  -5.066394805908203e-07 ; diff weight =  0.03624088317155838
lambda is : 1.4677992676220687e-05, cost : 3.103 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-27 23:55:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 970, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  969 ; minimum lost =  0.4653894305229187 ; diff loss =  0.0 ; diff weight =  3.3866406738525257e-05
lambda is : 2.1544346900318854e-05, cost : 0.795 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-27 23:56:36 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 895, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  891 ; minimum lost =  0.5156087279319763 ; diff loss =  0.0 ; diff weight =  3.218380152247846e-05
lambda is : 3.16227766016838e-05, cost : 0.727 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-27 23:57:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 937, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  938 ; minimum lost =  0.5818081498146057 ; diff loss =  1.7881393432617188e-07 ; diff weight =  3.891998119343043e-07
lambda is : 4.6415888336127784e-05, cost : 0.734 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-27 23:58:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 823, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  820 ; minimum lost =  0.6645920276641846 ; diff loss =  0.0 ; diff weight =  1.2124477507313713e-05
lambda is : 6.81292069057961e-05, cost : 0.667 min
==========
Testing lambda: 0.0001 starting at 2024-09-27 23:58:44 Max_iter: 1000
At iteration 472, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  473 ; minimum lost =  0.6848586201667786 ; diff loss =  5.960464477539063e-08 ; diff weight =  8.18472301489237e-07
lambda is : 9.999999999999991e-05, cost : 0.412 min
==========
Testing lambda: 0.000147 starting at 2024-09-27 23:59:08 Max_iter: 1000
At iteration 456, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  457 ; minimum lost =  0.6871000528335571 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.916636721143732e-07
lambda is : 0.00014677992676220703, cost : 0.384 min
==========
Testing lambda: 0.000215 starting at 2024-09-27 23:59:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 370, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  371 ; minimum lost =  0.6888812780380249 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.3054154496549017e-07
lambda is : 0.0002154434690031884, cost : 0.304 min
==========
Testing lambda: 0.000316 starting at 2024-09-27 23:59:50 Max_iter: 1000
At iteration 357, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  357 ; minimum lost =  0.6902313232421875 ; diff loss =  0.0 ; diff weight =  2.1354318960220553e-05
lambda is : 0.00031622776601683783, cost : 0.276 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 00:00:06 Max_iter: 1000
At iteration 326, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  327 ; minimum lost =  0.6911852955818176 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.451134026974614e-07
lambda is : 0.00046415888336127795, cost : 0.236 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 00:00:20 Max_iter: 1000
At iteration 380, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  380 ; minimum lost =  0.6918104290962219 ; diff loss =  0.0 ; diff weight =  8.840511327434797e-06
lambda is : 0.0006812920690579617, cost : 0.281 min
==========
Testing lambda: 0.001 starting at 2024-09-28 00:00:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 244, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  245 ; minimum lost =  0.6922153830528259 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.4244315000032657e-07
lambda is : 0.0010000000000000002, cost : 0.172 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 00:00:48 Max_iter: 1000
At iteration 325, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  324 ; minimum lost =  0.6924930214881897 ; diff loss =  0.0 ; diff weight =  5.5115642680902965e-06
lambda is : 0.0014677992676220694, cost : 0.227 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 00:01:01 Max_iter: 1000
At iteration 248, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  248 ; minimum lost =  0.6927257776260376 ; diff loss =  0.0 ; diff weight =  1.6598240108578466e-05
lambda is : 0.0021544346900318843, cost : 0.177 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 00:01:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 203, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  203 ; minimum lost =  0.6929280161857605 ; diff loss =  0.0 ; diff weight =  1.2669718216784531e-06
lambda is : 0.003162277660168382, cost : 0.153 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 00:01:21 Max_iter: 1000
At iteration 137, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  137 ; minimum lost =  0.6930928826332092 ; diff loss =  0.0 ; diff weight =  9.649761523178313e-06
lambda is : 0.004641588833612781, cost : 0.12 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 00:01:28 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.006812920690579613, cost : 0.017 min
==========
Testing lambda: 0.01 starting at 2024-09-28 00:01:29 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.010000000000000004, cost : 0.015 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 00:01:30 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.014677992676220709, cost : 0.015 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 00:01:31 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.02154434690031885, cost : 0.015 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 00:01:32 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.015 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 00:01:33 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.015 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 00:01:34 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.015 min
==========
Testing lambda: 0.1 starting at 2024-09-28 00:01:35 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.015 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.348058    0.113821          0.118812            9573  0.999814  0.921541  0.805416   0.714286  0.800000      0.490554   6.674453e-01
0.000015    0.274978    0.146341          0.148515            7563  0.998836  0.885638  0.870131   0.833333  0.869565      0.454397   3.624088e-02
0.000022    0.259090    0.146341          0.148515            7126  0.999454  0.900290  0.826524   0.791667  0.826087      0.465389   3.386641e-05
0.000032    0.229312    0.162602          0.168317            6307  0.999822  0.930992  0.844349   0.826087  0.844444      0.515609   3.218380e-05
0.000046    0.200371    0.186992          0.188119            5511  0.999857  0.941124  0.863375   0.863636  0.863636      0.581808   3.891998e-07
Exporting resultDF
Exporting result Dict
ILC Time elapsed: 15.240917114416758 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for MAIT
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-28 00:02:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  600 ; minimum lost =  0.5037129521369934 ; diff loss =  -1.5020370483398438e-05 ; diff weight =  0.0011410784209147096
lambda is : 9.999999999999997e-06, cost : 5.8 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-28 00:07:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.24410448968410492 ; diff loss =  9.98377799987793e-07 ; diff weight =  0.00037274707574397326
lambda is : 1.4677992676220687e-05, cost : 2.06 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-28 00:09:57 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  629 ; minimum lost =  0.5110758543014526 ; diff loss =  -1.4960765838623047e-05 ; diff weight =  0.0007840020698495209
lambda is : 2.1544346900318854e-05, cost : 5.508 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-28 00:15:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  634 ; minimum lost =  0.5190507769584656 ; diff loss =  -6.139278411865234e-06 ; diff weight =  0.0018859008559957147
lambda is : 3.16227766016838e-05, cost : 5.331 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-28 00:20:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  670 ; minimum lost =  0.5273379683494568 ; diff loss =  -4.291534423828125e-06 ; diff weight =  0.00023980536207091063
lambda is : 4.6415888336127784e-05, cost : 4.875 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-28 00:25:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  746 ; minimum lost =  0.5335620641708374 ; diff loss =  -5.364418029785156e-07 ; diff weight =  0.00026969140162691474
lambda is : 6.81292069057961e-05, cost : 4.283 min
==========
Testing lambda: 0.0001 starting at 2024-09-28 00:29:57 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  749 ; minimum lost =  0.5392963290214539 ; diff loss =  0.0 ; diff weight =  6.193286480993265e-06
lambda is : 9.999999999999991e-05, cost : 4.341 min
==========
Testing lambda: 0.000147 starting at 2024-09-28 00:34:17 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  709 ; minimum lost =  0.5524337291717529 ; diff loss =  -8.344650268554688e-07 ; diff weight =  0.00016547556151635945
lambda is : 0.00014677992676220703, cost : 4.827 min
==========
Testing lambda: 0.000215 starting at 2024-09-28 00:39:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  659 ; minimum lost =  0.5717166662216187 ; diff loss =  -1.430511474609375e-06 ; diff weight =  0.0001621606934349984
lambda is : 0.0002154434690031884, cost : 5.413 min
==========
Testing lambda: 0.000316 starting at 2024-09-28 00:44:32 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  703 ; minimum lost =  0.5910302996635437 ; diff loss =  -2.9802322387695312e-06 ; diff weight =  0.00033256609458476305
lambda is : 0.00031622776601683783, cost : 5.555 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 00:50:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  999 ; minimum lost =  0.5717769265174866 ; diff loss =  0.0 ; diff weight =  9.633836270950269e-06
lambda is : 0.00046415888336127795, cost : 2.46 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 00:52:33 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.6244588494300842 ; diff loss =  1.1920928955078125e-07 ; diff weight =  1.246998999704374e-05
lambda is : 0.0006812920690579617, cost : 2.488 min
==========
Testing lambda: 0.001 starting at 2024-09-28 00:55:02 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  186 ; minimum lost =  0.6451391577720642 ; diff loss =  3.2186508178710938e-06 ; diff weight =  0.00014095021469984204
lambda is : 0.0010000000000000002, cost : 5.142 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 01:00:10 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 755, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  191 ; minimum lost =  0.6489407420158386 ; diff loss =  1.1920928955078125e-07 ; diff weight =  0.0001409251563018188
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 2.606 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 01:02:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 690, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  186 ; minimum lost =  0.6526075005531311 ; diff loss =  6.556510925292969e-07 ; diff weight =  0.00014356452447827905
lambda is : 0.0021544346900318843, cost : 2.232 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 01:05:01 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 628, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  200 ; minimum lost =  0.6563643217086792 ; diff loss =  1.1920928955078125e-07 ; diff weight =  0.00011601598089328036
lambda is : 0.003162277660168382, cost : 1.754 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 01:06:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 560, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  225 ; minimum lost =  0.6612354516983032 ; diff loss =  2.9802322387695312e-06 ; diff weight =  6.927387585164979e-05
lambda is : 0.004641588833612781, cost : 1.207 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 01:07:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 560, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  512 ; minimum lost =  0.6672737002372742 ; diff loss =  5.364418029785156e-07 ; diff weight =  0.00020005504484288394
lambda is : 0.006812920690579613, cost : 1.251 min
==========
Testing lambda: 0.01 starting at 2024-09-28 01:09:13 Max_iter: 1000
At iteration 531, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  532 ; minimum lost =  0.673596203327179 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.772225565830013e-07
lambda is : 0.010000000000000004, cost : 0.381 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 01:09:36 Max_iter: 1000
At iteration 379, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  379 ; minimum lost =  0.679146945476532 ; diff loss =  0.0 ; diff weight =  3.5911882150685415e-05
lambda is : 0.014677992676220709, cost : 0.255 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 01:09:52 Max_iter: 1000
At iteration 337, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  338 ; minimum lost =  0.6843931674957275 ; diff loss =  1.1920928955078125e-07 ; diff weight =  6.476356020357343e-07
lambda is : 0.02154434690031885, cost : 0.226 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 01:10:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 332, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  330 ; minimum lost =  0.6891032457351685 ; diff loss =  0.0 ; diff weight =  1.8142120097763836e-05
lambda is : 0.0316227766016838, cost : 0.241 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 01:10:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 312, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  311 ; minimum lost =  0.6923779845237732 ; diff loss =  0.0 ; diff weight =  2.4716810003155842e-05
lambda is : 0.04641588833612786, cost : 0.248 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 01:10:34 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.018 min
==========
Testing lambda: 0.1 starting at 2024-09-28 01:10:36 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.328498    0.105402          0.105698            9035  0.993972  0.942598  0.884164   0.848214  0.886470      0.503713       0.001141
0.000015    0.244546    0.137022          0.137077            6726  0.997274  0.956843  0.909282   0.886154  0.911392      0.244104       0.000373
0.000022    0.256835    0.135705          0.135425            7064  0.997225  0.956081  0.914156   0.904762  0.916399      0.511076       0.000784
0.000032    0.219132    0.156126          0.156895            6027  0.997014  0.959363  0.911173   0.899054  0.913462      0.519051       0.001886
0.000046    0.177283    0.184453          0.184145            4876  0.996160  0.960855  0.920187   0.900621  0.922099      0.527338       0.000240
Exporting resultDF
Exporting result Dict
MAIT Time elapsed: 68.66380384763082 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for NK
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-28 01:11:08 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 992, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  445 ; minimum lost =  0.2495574951171875 ; diff loss =  5.960464477539063e-08 ; diff weight =  5.5769356549717486e-05
lambda is : 9.999999999999997e-06, cost : 1.798 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-28 01:12:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 946, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  298 ; minimum lost =  0.2613692879676819 ; diff loss =  0.0 ; diff weight =  9.025354665936902e-05
lambda is : 1.4677992676220687e-05, cost : 1.695 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-28 01:14:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 894, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  298 ; minimum lost =  0.27144408226013184 ; diff loss =  0.0 ; diff weight =  9.647252591094002e-05
lambda is : 2.1544346900318854e-05, cost : 1.684 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-28 01:16:19 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  290 ; minimum lost =  0.2820109724998474 ; diff loss =  0.0 ; diff weight =  7.351028034463525e-05
lambda is : 3.16227766016838e-05, cost : 1.845 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-28 01:18:10 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 977, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  314 ; minimum lost =  0.2964164614677429 ; diff loss =  2.9802322387695312e-08 ; diff weight =  6.616851169383153e-05
lambda is : 4.6415888336127784e-05, cost : 1.793 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-28 01:19:57 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 879, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  314 ; minimum lost =  0.30999866127967834 ; diff loss =  0.0 ; diff weight =  7.752631063340232e-05
lambda is : 6.81292069057961e-05, cost : 1.589 min
==========
Testing lambda: 0.0001 starting at 2024-09-28 01:21:33 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 899, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  298 ; minimum lost =  0.32303518056869507 ; diff loss =  0.0 ; diff weight =  4.9530615797266364e-05
lambda is : 9.999999999999991e-05, cost : 1.644 min
==========
Testing lambda: 0.000147 starting at 2024-09-28 01:23:11 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 831, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  285 ; minimum lost =  0.33491063117980957 ; diff loss =  0.0 ; diff weight =  6.033421232132241e-05
lambda is : 0.00014677992676220703, cost : 1.607 min
==========
Testing lambda: 0.000215 starting at 2024-09-28 01:24:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 794, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  290 ; minimum lost =  0.3465680480003357 ; diff loss =  2.9802322387695312e-08 ; diff weight =  5.490596595336683e-05
lambda is : 0.0002154434690031884, cost : 1.348 min
==========
Testing lambda: 0.000316 starting at 2024-09-28 01:26:09 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 739, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  221 ; minimum lost =  0.3621532618999481 ; diff loss =  0.0 ; diff weight =  5.202037573326379e-05
lambda is : 0.00031622776601683783, cost : 1.319 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 01:27:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 696, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  227 ; minimum lost =  0.3750838339328766 ; diff loss =  0.0 ; diff weight =  5.873030022485182e-05
lambda is : 0.00046415888336127795, cost : 1.234 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 01:28:42 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 682, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  226 ; minimum lost =  0.38793936371803284 ; diff loss =  0.0 ; diff weight =  5.641990355798043e-05
lambda is : 0.0006812920690579617, cost : 1.142 min
==========
Testing lambda: 0.001 starting at 2024-09-28 01:29:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 622, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  241 ; minimum lost =  0.4011998772621155 ; diff loss =  0.0 ; diff weight =  4.99173766002059e-05
lambda is : 0.0010000000000000002, cost : 1.031 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 01:30:52 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 617, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  252 ; minimum lost =  0.41844233870506287 ; diff loss =  0.0 ; diff weight =  3.9512349758297205e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 0.992 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 01:31:52 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 586, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  283 ; minimum lost =  0.43758946657180786 ; diff loss =  0.0 ; diff weight =  2.61476197920274e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 0.938 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 01:32:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 560, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  559 ; minimum lost =  0.4591329097747803 ; diff loss =  0.0 ; diff weight =  7.832668052287772e-05
lambda is : 0.003162277660168382, cost : 0.86 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 01:33:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 548, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  549 ; minimum lost =  0.48130327463150024 ; diff loss =  2.9802322387695312e-08 ; diff weight =  9.276684522774303e-07
lambda is : 0.004641588833612781, cost : 0.778 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 01:34:26 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 469, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  468 ; minimum lost =  0.5030612945556641 ; diff loss =  0.0 ; diff weight =  7.415300206048414e-05
lambda is : 0.006812920690579613, cost : 0.364 min
==========
Testing lambda: 0.01 starting at 2024-09-28 01:34:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 495, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  493 ; minimum lost =  0.5234291553497314 ; diff loss =  0.0 ; diff weight =  0.0001277627015952021
lambda is : 0.010000000000000004, cost : 0.321 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 01:35:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 608, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  605 ; minimum lost =  0.54218989610672 ; diff loss =  0.0 ; diff weight =  1.2004681593680289e-05
lambda is : 0.014677992676220709, cost : 0.402 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 01:35:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 690, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  691 ; minimum lost =  0.5620627403259277 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.0602362010558863e-07
lambda is : 0.02154434690031885, cost : 0.475 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 01:36:00 Max_iter: 1000
At iteration 766, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  764 ; minimum lost =  0.585355281829834 ; diff loss =  0.0 ; diff weight =  1.3110977306496352e-05
lambda is : 0.0316227766016838, cost : 0.494 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 01:36:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 539, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  538 ; minimum lost =  0.6116808652877808 ; diff loss =  0.0 ; diff weight =  8.070158219197765e-05
lambda is : 0.04641588833612786, cost : 0.368 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 01:36:52 Max_iter: 1000
At iteration 534, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  535 ; minimum lost =  0.6389762759208679 ; diff loss =  1.1920928955078125e-07 ; diff weight =  9.80371851255768e-07
lambda is : 0.0681292069057962, cost : 0.341 min
==========
Testing lambda: 0.1 starting at 2024-09-28 01:37:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 585, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  584 ; minimum lost =  0.6647745966911316 ; diff loss =  0.0 ; diff weight =  1.520625392004149e-05
lambda is : 0.10000000000000002, cost : 0.461 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.352858    0.118462          0.118628            9705  0.995234  0.976744  0.906254   0.858635  0.913675      0.249557       0.000056
0.000015    0.336860    0.125116          0.124652            9265  0.995859  0.977932  0.915045   0.870235  0.921821      0.261369       0.000090
0.000022    0.305374    0.138976          0.138554            8399  0.994989  0.977291  0.911090   0.867587  0.918315      0.271444       0.000096
0.000032    0.272833    0.155979          0.156163            7504  0.995996  0.977687  0.911925   0.868999  0.919105      0.282011       0.000074
0.000046    0.235748    0.178340          0.178174            6484  0.995772  0.977524  0.919954   0.882645  0.926681      0.296416       0.000066
Exporting resultDF
Exporting result Dict
NK Time elapsed: 26.650543558597565 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for NK_CD56bright
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-28 01:38:10 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 994, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  993 ; minimum lost =  0.2569851875305176 ; diff loss =  0.0 ; diff weight =  4.176118818577379e-05
lambda is : 9.999999999999997e-06, cost : 0.879 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-28 01:39:03 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 935, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  935 ; minimum lost =  0.3071107864379883 ; diff loss =  0.0 ; diff weight =  5.942515144852223e-06
lambda is : 1.4677992676220687e-05, cost : 0.793 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-28 01:39:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 887, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  888 ; minimum lost =  0.372383713722229 ; diff loss =  5.960464477539063e-08 ; diff weight =  7.921083238215942e-07
lambda is : 2.1544346900318854e-05, cost : 0.753 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-28 01:40:35 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 930, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  930 ; minimum lost =  0.45359373092651367 ; diff loss =  0.0 ; diff weight =  2.000123458856251e-06
lambda is : 3.16227766016838e-05, cost : 0.76 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-28 01:41:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  999 ; minimum lost =  0.547606348991394 ; diff loss =  0.0 ; diff weight =  5.7137531257467344e-05
lambda is : 4.6415888336127784e-05, cost : 0.803 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-28 01:42:09 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  999 ; minimum lost =  0.6522981524467468 ; diff loss =  -5.960464477539063e-08 ; diff weight =  4.1787236114032567e-05
lambda is : 6.81292069057961e-05, cost : 2.483 min
==========
Testing lambda: 0.0001 starting at 2024-09-28 01:44:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 746, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  361 ; minimum lost =  0.6644939184188843 ; diff loss =  0.0 ; diff weight =  2.707323983486276e-05
lambda is : 9.999999999999991e-05, cost : 1.6 min
==========
Testing lambda: 0.000147 starting at 2024-09-28 01:46:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 690, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  332 ; minimum lost =  0.6675270795822144 ; diff loss =  2.980232238769531e-07 ; diff weight =  3.815917807514779e-05
lambda is : 0.00014677992676220703, cost : 1.25 min
==========
Testing lambda: 0.000215 starting at 2024-09-28 01:47:29 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 669, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  307 ; minimum lost =  0.6701800227165222 ; diff loss =  0.0 ; diff weight =  4.28077946708072e-05
lambda is : 0.0002154434690031884, cost : 1.297 min
==========
Testing lambda: 0.000316 starting at 2024-09-28 01:48:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 651, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  286 ; minimum lost =  0.6724896430969238 ; diff loss =  2.384185791015625e-07 ; diff weight =  4.698231350630522e-05
lambda is : 0.00031622776601683783, cost : 1.335 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 01:50:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 651, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  275 ; minimum lost =  0.6745033264160156 ; diff loss =  1.1920928955078125e-07 ; diff weight =  4.9601989303482696e-05
lambda is : 0.00046415888336127795, cost : 1.498 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 01:51:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 591, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  279 ; minimum lost =  0.6763096451759338 ; diff loss =  2.384185791015625e-07 ; diff weight =  3.7080659240018576e-05
lambda is : 0.0006812920690579617, cost : 1.153 min
==========
Testing lambda: 0.001 starting at 2024-09-28 01:52:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 568, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  325 ; minimum lost =  0.6780304908752441 ; diff loss =  0.0 ; diff weight =  1.943456481967587e-05
lambda is : 0.0010000000000000002, cost : 1.075 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 01:53:51 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 541, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  463 ; minimum lost =  0.6798422336578369 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.2058572994865244e-06
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0014677992676220694, cost : 1.047 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 01:54:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 430, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  430 ; minimum lost =  0.6816821098327637 ; diff loss =  0.0 ; diff weight =  1.2226786338942475e-06
lambda is : 0.0021544346900318843, cost : 0.292 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 01:55:11 Max_iter: 1000
At iteration 459, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  459 ; minimum lost =  0.6834542751312256 ; diff loss =  0.0 ; diff weight =  2.0470524759730324e-05
lambda is : 0.003162277660168382, cost : 0.299 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 01:55:29 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 487, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  487 ; minimum lost =  0.6852110624313354 ; diff loss =  0.0 ; diff weight =  8.108299880404957e-06
lambda is : 0.004641588833612781, cost : 0.33 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 01:55:49 Max_iter: 1000
At iteration 386, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  387 ; minimum lost =  0.6870278716087341 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.171626978357381e-07
lambda is : 0.006812920690579613, cost : 0.268 min
==========
Testing lambda: 0.01 starting at 2024-09-28 01:56:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 369, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  370 ; minimum lost =  0.6888659596443176 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.0227709168475485e-07
lambda is : 0.010000000000000004, cost : 0.257 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 01:56:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 224, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  223 ; minimum lost =  0.6906423568725586 ; diff loss =  0.0 ; diff weight =  2.4863227736204863e-05
lambda is : 0.014677992676220709, cost : 0.166 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 01:56:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 222, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  223 ; minimum lost =  0.6921321749687195 ; diff loss =  1.7881393432617188e-07 ; diff weight =  4.595876248458808e-07
lambda is : 0.02154434690031885, cost : 0.163 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 01:56:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 145, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  145 ; minimum lost =  0.6930178999900818 ; diff loss =  0.0 ; diff weight =  1.963254726433661e-05
lambda is : 0.0316227766016838, cost : 0.13 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 01:56:48 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.018 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 01:56:49 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-28 01:56:50 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.294030    0.149300             0.148            8087  0.992252  0.926863  0.852461   0.779070  0.850794      0.256985   4.176119e-05
0.000015    0.267270    0.160187             0.162            7351  0.994716  0.930829  0.861412   0.801205  0.860841      0.307111   5.942515e-06
0.000022    0.243201    0.175739             0.176            6689  0.993850  0.935645  0.869436   0.815951  0.869281      0.372384   7.921083e-07
0.000032    0.221204    0.189736             0.188            6084  0.996708  0.941706  0.889045   0.852564  0.889632      0.453594   2.000123e-06
0.000046    0.202771    0.202177             0.202            5577  0.994340  0.931615  0.866495   0.842105  0.867797      0.547606   5.713753e-05
Exporting resultDF
Exporting result Dict
NK_CD56bright Time elapsed: 18.810025453567505 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for NK_Proliferating
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-28 01:57:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.1932731568813324 ; diff loss =  9.998679161071777e-06 ; diff weight =  0.002349472139030695
lambda is : 9.999999999999997e-06, cost : 2.689 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-28 02:00:02 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.19908814132213593 ; diff loss =  1.0058283805847168e-05 ; diff weight =  0.002940202597528696
lambda is : 1.4677992676220687e-05, cost : 2.642 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-28 02:02:41 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.20927727222442627 ; diff loss =  1.341104507446289e-07 ; diff weight =  0.00020907550060655922
lambda is : 2.1544346900318854e-05, cost : 2.641 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-28 02:05:19 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.22441649436950684 ; diff loss =  5.513429641723633e-07 ; diff weight =  0.00020613902597688138
lambda is : 3.16227766016838e-05, cost : 2.598 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-28 02:07:55 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.24589286744594574 ; diff loss =  2.682209014892578e-07 ; diff weight =  0.00019423574849497527
lambda is : 4.6415888336127784e-05, cost : 2.577 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-28 02:10:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.27578219771385193 ; diff loss =  2.086162567138672e-07 ; diff weight =  9.30336827877909e-05
lambda is : 6.81292069057961e-05, cost : 2.528 min
==========
Testing lambda: 0.0001 starting at 2024-09-28 02:13:01 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.3170400559902191 ; diff loss =  8.940696716308594e-08 ; diff weight =  7.076954352669418e-05
lambda is : 9.999999999999991e-05, cost : 2.435 min
==========
Testing lambda: 0.000147 starting at 2024-09-28 02:15:27 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.37239110469818115 ; diff loss =  1.1920928955078125e-07 ; diff weight =  5.2352490456542e-05
lambda is : 0.00014677992676220703, cost : 2.485 min
==========
Testing lambda: 0.000215 starting at 2024-09-28 02:17:57 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.44412362575531006 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.9382470276905224e-05
lambda is : 0.0002154434690031884, cost : 2.448 min
==========
Testing lambda: 0.000316 starting at 2024-09-28 02:20:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.533010721206665 ; diff loss =  4.172325134277344e-07 ; diff weight =  0.00014574738452211022
lambda is : 0.00031622776601683783, cost : 2.544 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 02:22:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  132 ; minimum lost =  0.6685539484024048 ; diff loss =  0.0 ; diff weight =  3.961589027312584e-05
lambda is : 0.00046415888336127795, cost : 3.671 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 02:26:36 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 865, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  136 ; minimum lost =  0.6705867052078247 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.7759760743938386e-05
lambda is : 0.0006812920690579617, cost : 2.329 min
==========
Testing lambda: 0.001 starting at 2024-09-28 02:28:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 720, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  142 ; minimum lost =  0.6724802255630493 ; diff loss =  0.0 ; diff weight =  3.252135866205208e-05
lambda is : 0.0010000000000000002, cost : 1.963 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 02:30:54 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 584, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  154 ; minimum lost =  0.6743927001953125 ; diff loss =  8.344650268554688e-07 ; diff weight =  2.817125277942978e-05
lambda is : 0.0014677992676220694, cost : 1.493 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 02:32:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 495, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  179 ; minimum lost =  0.6767020225524902 ; diff loss =  2.980232238769531e-07 ; diff weight =  2.0130593838985078e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0021544346900318843, cost : 1.126 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 02:33:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 478, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  264 ; minimum lost =  0.6797404289245605 ; diff loss =  8.344650268554688e-07 ; diff weight =  8.259640708274674e-06
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 0.959 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 02:34:29 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 389, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  389 ; minimum lost =  0.6831569075584412 ; diff loss =  0.0 ; diff weight =  3.977955202572048e-06
lambda is : 0.004641588833612781, cost : 0.278 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 02:34:45 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 326, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  326 ; minimum lost =  0.6853893995285034 ; diff loss =  -2.384185791015625e-07 ; diff weight =  1.648476882110117e-06
lambda is : 0.006812920690579613, cost : 0.226 min
==========
Testing lambda: 0.01 starting at 2024-09-28 02:34:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 340, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  340 ; minimum lost =  0.6871979832649231 ; diff loss =  0.0 ; diff weight =  1.3446724551613443e-06
lambda is : 0.010000000000000004, cost : 0.242 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 02:35:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 249, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  250 ; minimum lost =  0.6890159845352173 ; diff loss =  1.1920928955078125e-07 ; diff weight =  9.085298984246037e-07
lambda is : 0.014677992676220709, cost : 0.193 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 02:35:25 Max_iter: 1000
At iteration 301, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  302 ; minimum lost =  0.6908083558082581 ; diff loss =  5.960464477539063e-08 ; diff weight =  8.584996180616145e-07
lambda is : 0.02154434690031885, cost : 0.218 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 02:35:38 Max_iter: 1000
At iteration 206, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  205 ; minimum lost =  0.6922957301139832 ; diff loss =  0.0 ; diff weight =  1.1980533599853516e-05
lambda is : 0.0316227766016838, cost : 0.154 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 02:35:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 58, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  55 ; minimum lost =  0.6931368112564087 ; diff loss =  0.0 ; diff weight =  1.5585683286190033e-05
lambda is : 0.04641588833612786, cost : 0.068 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 02:35:51 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.018 min
==========
Testing lambda: 0.1 starting at 2024-09-28 02:35:52 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.330279    0.235437          0.231013            9084  0.994792  0.871547  0.853134   0.805556  0.852941      0.193273       0.002349
0.000015    0.301011    0.257282          0.253165            8279  0.989624  0.851915  0.841234   0.801887  0.841584      0.199088       0.002940
0.000022    0.269161    0.281553          0.278481            7403  0.991638  0.867744  0.849166   0.798165  0.848780      0.209277       0.000209
0.000032    0.234439    0.308252          0.306962            6448  0.994841  0.860670  0.827293   0.785047  0.827586      0.224416       0.000206
0.000046    0.197898    0.347087          0.341772            5443  0.997060  0.864854  0.825790   0.831579  0.827225      0.245893       0.000194
Exporting resultDF
Exporting result Dict
NK_Proliferating Time elapsed: 38.66716630856196 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Plasmablast
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-28 02:36:24 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  685 ; minimum lost =  0.09311503171920776 ; diff loss =  1.706928014755249e-05 ; diff weight =  0.17555426061153412
lambda is : 9.999999999999997e-06, cost : 4.284 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-28 02:40:41 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  658 ; minimum lost =  0.14034275710582733 ; diff loss =  -5.0067901611328125e-06 ; diff weight =  0.0794309452176094
lambda is : 1.4677992676220687e-05, cost : 4.852 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-28 02:45:32 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  979 ; minimum lost =  0.13577215373516083 ; diff loss =  0.0 ; diff weight =  1.2802452147298027e-05
lambda is : 2.1544346900318854e-05, cost : 2.494 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-28 02:48:02 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  622 ; minimum lost =  0.15720610320568085 ; diff loss =  -8.642673492431641e-07 ; diff weight =  0.010989663191139698
lambda is : 3.16227766016838e-05, cost : 5.055 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-28 02:53:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 903, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  904 ; minimum lost =  0.12429199367761612 ; diff loss =  1.4901161193847656e-08 ; diff weight =  9.490752290730597e-07
lambda is : 4.6415888336127784e-05, cost : 1.593 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-28 02:54:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  514 ; minimum lost =  0.10730863362550735 ; diff loss =  -3.129243850708008e-06 ; diff weight =  0.004061944782733917
lambda is : 6.81292069057961e-05, cost : 6.168 min
==========
Testing lambda: 0.0001 starting at 2024-09-28 03:00:51 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  486 ; minimum lost =  0.14694567024707794 ; diff loss =  -2.339482307434082e-06 ; diff weight =  0.0025838841684162617
lambda is : 9.999999999999991e-05, cost : 6.397 min
==========
Testing lambda: 0.000147 starting at 2024-09-28 03:07:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 830, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  829 ; minimum lost =  0.18714165687561035 ; diff loss =  0.0 ; diff weight =  6.711741298204288e-05
lambda is : 0.00014677992676220703, cost : 1.473 min
==========
Testing lambda: 0.000215 starting at 2024-09-28 03:08:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.22646452486515045 ; diff loss =  4.470348358154297e-08 ; diff weight =  2.601392043288797e-05
lambda is : 0.0002154434690031884, cost : 1.66 min
==========
Testing lambda: 0.000316 starting at 2024-09-28 03:10:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 822, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  820 ; minimum lost =  0.27912136912345886 ; diff loss =  0.0 ; diff weight =  2.2808817448094487e-05
lambda is : 0.00031622776601683783, cost : 1.46 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 03:11:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.3501761555671692 ; diff loss =  2.0116567611694336e-05 ; diff weight =  0.01215375866740942
lambda is : 0.00046415888336127795, cost : 2.137 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 03:13:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 986, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  986 ; minimum lost =  0.43205559253692627 ; diff loss =  0.0 ; diff weight =  7.048676252452424e-06
lambda is : 0.0006812920690579617, cost : 3.099 min
==========
Testing lambda: 0.001 starting at 2024-09-28 03:17:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  550 ; minimum lost =  0.5595307350158691 ; diff loss =  -9.894371032714844e-06 ; diff weight =  2.2561112928087823e-05
lambda is : 0.0010000000000000002, cost : 5.667 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 03:22:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  679 ; minimum lost =  0.5945531129837036 ; diff loss =  -5.960464477539062e-07 ; diff weight =  0.1579834222793579
lambda is : 0.0014677992676220694, cost : 4.69 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 03:27:26 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 960, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  961 ; minimum lost =  0.6570482850074768 ; diff loss =  1.1324882507324219e-06 ; diff weight =  4.771927706315182e-07
lambda is : 0.0021544346900318843, cost : 1.156 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 03:28:35 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 630, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  269 ; minimum lost =  0.6807770729064941 ; diff loss =  0.0 ; diff weight =  4.6882807509973645e-05
lambda is : 0.003162277660168382, cost : 0.973 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 03:29:33 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 392, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  393 ; minimum lost =  0.683605432510376 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.919616631264944e-07
lambda is : 0.004641588833612781, cost : 0.259 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 03:29:49 Max_iter: 1000
At iteration 422, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  423 ; minimum lost =  0.6857064962387085 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.8060845263789815e-07
lambda is : 0.006812920690579613, cost : 0.293 min
==========
Testing lambda: 0.01 starting at 2024-09-28 03:30:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 321, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  322 ; minimum lost =  0.6873534321784973 ; diff loss =  5.960464477539063e-08 ; diff weight =  6.428103347388969e-07
lambda is : 0.010000000000000004, cost : 0.222 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 03:30:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 281, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  282 ; minimum lost =  0.6890082359313965 ; diff loss =  5.960464477539063e-08 ; diff weight =  7.835213295948051e-07
lambda is : 0.014677992676220709, cost : 0.198 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 03:30:32 Max_iter: 1000
At iteration 270, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  270 ; minimum lost =  0.6906391382217407 ; diff loss =  0.0 ; diff weight =  3.6659308534581214e-05
lambda is : 0.02154434690031885, cost : 0.202 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 03:30:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 196, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  196 ; minimum lost =  0.6920417547225952 ; diff loss =  0.0 ; diff weight =  1.1846423149108887e-06
lambda is : 0.0316227766016838, cost : 0.167 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 03:30:54 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 110, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  111 ; minimum lost =  0.6930180788040161 ; diff loss =  1.1920928955078125e-07 ; diff weight =  4.880130290985107e-07
lambda is : 0.04641588833612786, cost : 0.092 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 03:30:59 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.017 min
==========
Testing lambda: 0.1 starting at 2024-09-28 03:31:00 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.015 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.246037    0.391156          0.392405            6767  0.999955  0.990769  0.936114   0.876923  0.934426      0.093115   1.755543e-01
0.000015    0.290649    0.333333          0.333333            7994  0.999954  0.990782  0.901865   0.814286  0.897638      0.140343   7.943095e-02
0.000022    0.202189    0.428571          0.430380            5561  1.000000  1.000000  0.936114   0.876923  0.934426      0.135772   1.280245e-05
0.000032    0.227531    0.401361          0.400844            6258  1.000000  1.000000  0.915112   0.838235  0.912000      0.157206   1.098966e-02
0.000046    0.153614    0.469388          0.468354            4225  1.000000  1.000000  0.966488   0.934426  0.966102      0.124292   9.490752e-07
Exporting resultDF
Exporting result Dict
Plasmablast Time elapsed: 54.78316686550776 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Platelet
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-28 03:31:34 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.1753225326538086 ; diff loss =  0.00016620755195617676 ; diff weight =  0.2211124300956726
lambda is : 9.999999999999997e-06, cost : 2.446 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-28 03:34:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.25792574882507324 ; diff loss =  0.00021541118621826172 ; diff weight =  0.3479086458683014
lambda is : 1.4677992676220687e-05, cost : 3.322 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-28 03:37:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.24200432002544403 ; diff loss =  0.00010335445404052734 ; diff weight =  0.19589442014694214
lambda is : 2.1544346900318854e-05, cost : 2.89 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-28 03:40:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  860 ; minimum lost =  0.30314022302627563 ; diff loss =  -5.960464477539063e-08 ; diff weight =  0.00017471236060373485
lambda is : 3.16227766016838e-05, cost : 3.412 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-28 03:43:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  872 ; minimum lost =  0.29755693674087524 ; diff loss =  -8.940696716308594e-08 ; diff weight =  5.387014971347526e-05
lambda is : 4.6415888336127784e-05, cost : 3.314 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-28 03:46:57 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  801 ; minimum lost =  0.3079620599746704 ; diff loss =  -1.7881393432617188e-07 ; diff weight =  6.666048284387216e-05
lambda is : 6.81292069057961e-05, cost : 3.996 min
==========
Testing lambda: 0.0001 starting at 2024-09-28 03:50:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  796 ; minimum lost =  0.31303098797798157 ; diff loss =  -2.682209014892578e-07 ; diff weight =  5.918400711379945e-05
lambda is : 9.999999999999991e-05, cost : 4.011 min
==========
Testing lambda: 0.000147 starting at 2024-09-28 03:54:57 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  788 ; minimum lost =  0.32065606117248535 ; diff loss =  -2.384185791015625e-07 ; diff weight =  4.95370986755006e-05
lambda is : 0.00014677992676220703, cost : 4.132 min
==========
Testing lambda: 0.000215 starting at 2024-09-28 03:59:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  763 ; minimum lost =  0.34651413559913635 ; diff loss =  -2.086162567138672e-07 ; diff weight =  6.689831934636459e-05
lambda is : 0.0002154434690031884, cost : 4.354 min
==========
Testing lambda: 0.000316 starting at 2024-09-28 04:03:26 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  966 ; minimum lost =  0.36318111419677734 ; diff loss =  -2.086162567138672e-07 ; diff weight =  0.0038556877989321947
lambda is : 0.00031622776601683783, cost : 4.461 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 04:07:54 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  792 ; minimum lost =  0.40530043840408325 ; diff loss =  -1.7881393432617188e-07 ; diff weight =  3.259667937527411e-05
lambda is : 0.00046415888336127795, cost : 4.371 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 04:12:16 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  97 ; minimum lost =  0.4907097816467285 ; diff loss =  1.1920928955078125e-07 ; diff weight =  7.733210804872215e-05
lambda is : 0.0006812920690579617, cost : 5.04 min
==========
Testing lambda: 0.001 starting at 2024-09-28 04:17:19 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  97 ; minimum lost =  0.4965601861476898 ; diff loss =  -1.3113021850585938e-06 ; diff weight =  8.416354103246704e-05
lambda is : 0.0010000000000000002, cost : 5.661 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 04:22:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  97 ; minimum lost =  0.5082218050956726 ; diff loss =  -1.1920928955078125e-07 ; diff weight =  7.83495997893624e-05
lambda is : 0.0014677992676220694, cost : 4.873 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 04:27:51 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  96 ; minimum lost =  0.5184582471847534 ; diff loss =  -5.960464477539063e-08 ; diff weight =  8.030718890950084e-05
lambda is : 0.0021544346900318843, cost : 5.538 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 04:33:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  103 ; minimum lost =  0.5255860090255737 ; diff loss =  -1.1920928955078125e-07 ; diff weight =  7.435332372551784e-05
lambda is : 0.003162277660168382, cost : 5.606 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 04:38:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  107 ; minimum lost =  0.539100706577301 ; diff loss =  -1.1920928955078125e-07 ; diff weight =  7.227127207443118e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 5.681 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 04:44:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  106 ; minimum lost =  0.5538761615753174 ; diff loss =  0.0 ; diff weight =  6.860127905383706e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.006812920690579613, cost : 5.097 min
==========
Testing lambda: 0.01 starting at 2024-09-28 04:49:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  122 ; minimum lost =  0.5704800486564636 ; diff loss =  -1.1920928955078125e-07 ; diff weight =  6.226685218280181e-05
lambda is : 0.010000000000000004, cost : 5.655 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 04:55:25 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  142 ; minimum lost =  0.592612087726593 ; diff loss =  -2.980232238769531e-07 ; diff weight =  5.1130380597896874e-05
lambda is : 0.014677992676220709, cost : 6.291 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 05:01:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 555, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  161 ; minimum lost =  0.6182145476341248 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.751483382075094e-05
lambda is : 0.02154434690031885, cost : 1.51 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 05:03:13 Max_iter: 1000
At iteration 343, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  343 ; minimum lost =  0.6428651809692383 ; diff loss =  0.0 ; diff weight =  8.031330071389675e-05
lambda is : 0.0316227766016838, cost : 0.228 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 05:03:27 Max_iter: 1000
At iteration 534, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  535 ; minimum lost =  0.6717768311500549 ; diff loss =  1.1920928955078125e-07 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.338 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 05:03:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 425, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  426 ; minimum lost =  0.6839793920516968 ; diff loss =  1.7881393432617188e-07 ; diff weight =  8.85279803242156e-07
lambda is : 0.0681292069057962, cost : 0.287 min
==========
Testing lambda: 0.1 starting at 2024-09-28 05:04:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 202, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  202 ; minimum lost =  0.6913908123970032 ; diff loss =  0.0 ; diff weight =  3.21634543070104e-05
lambda is : 0.10000000000000002, cost : 0.148 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.171211    0.083461          0.083497            4709  0.991807  0.972139  0.934945   0.953237  0.936396      0.175323       0.221112
0.000015    0.162013    0.091118          0.091356            4456  0.989989  0.964780  0.934513   0.963235  0.935714      0.257926       0.347909
0.000022    0.124636    0.117917          0.118861            3428  0.985963  0.964771  0.938724   0.953571  0.940141      0.242004       0.195894
0.000032    0.100276    0.140123          0.139489            2758  0.990265  0.967206  0.936537   0.960000  0.937833      0.303140       0.000175
0.000046    0.076280    0.183002          0.182711            2098  0.991509  0.970911  0.928490   0.973384  0.929220      0.297557       0.000054
Exporting resultDF
Exporting result Dict
Platelet Time elapsed: 92.78693495194118 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for Treg
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-28 05:04:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.4976453483104706 ; diff loss =  0.0005030632019042969 ; diff weight =  0.052725013345479965
lambda is : 9.999999999999997e-06, cost : 4.556 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-28 05:09:17 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.5992945432662964 ; diff loss =  0.000773310661315918 ; diff weight =  0.1314351111650467
lambda is : 1.4677992676220687e-05, cost : 4.429 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-28 05:13:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  223 ; minimum lost =  0.6213374733924866 ; diff loss =  0.07466071844100952 ; diff weight =  6.329823372652754e-05
lambda is : 2.1544346900318854e-05, cost : 4.59 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-28 05:18:18 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  247 ; minimum lost =  0.6255955696105957 ; diff loss =  3.9696693420410156e-05 ; diff weight =  0.00025344666210003197
lambda is : 3.16227766016838e-05, cost : 4.637 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-28 05:22:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  240 ; minimum lost =  0.6299448013305664 ; diff loss =  4.291534423828125e-05 ; diff weight =  0.000199348374735564
lambda is : 4.6415888336127784e-05, cost : 4.53 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-28 05:27:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  233 ; minimum lost =  0.6345688104629517 ; diff loss =  -5.960464477539062e-07 ; diff weight =  0.00018025145982392132
lambda is : 6.81292069057961e-05, cost : 4.904 min
==========
Testing lambda: 0.0001 starting at 2024-09-28 05:32:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  199 ; minimum lost =  0.6388366222381592 ; diff loss =  -2.980232238769531e-07 ; diff weight =  9.688633872428909e-05
lambda is : 9.999999999999991e-05, cost : 4.987 min
==========
Testing lambda: 0.000147 starting at 2024-09-28 05:37:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  196 ; minimum lost =  0.6429144144058228 ; diff loss =  -1.0132789611816406e-06 ; diff weight =  9.974639397114515e-05
lambda is : 0.00014677992676220703, cost : 4.884 min
==========
Testing lambda: 0.000215 starting at 2024-09-28 05:42:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  191 ; minimum lost =  0.6468466520309448 ; diff loss =  2.086162567138672e-06 ; diff weight =  0.0001298587303608656
lambda is : 0.0002154434690031884, cost : 4.042 min
==========
Testing lambda: 0.000316 starting at 2024-09-28 05:46:17 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  180 ; minimum lost =  0.6497496366500854 ; diff loss =  4.589557647705078e-06 ; diff weight =  0.00012366579903755337
lambda is : 0.00031622776601683783, cost : 3.946 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 05:50:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  181 ; minimum lost =  0.6523070931434631 ; diff loss =  3.814697265625e-06 ; diff weight =  0.0001480237115174532
lambda is : 0.00046415888336127795, cost : 3.987 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 05:54:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  180 ; minimum lost =  0.6557080149650574 ; diff loss =  1.7285346984863281e-06 ; diff weight =  0.00015633006114512682
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0006812920690579617, cost : 3.817 min
==========
Testing lambda: 0.001 starting at 2024-09-28 05:58:02 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 953, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  180 ; minimum lost =  0.6590514183044434 ; diff loss =  1.7881393432617188e-07 ; diff weight =  0.00020117490203119814
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 3.727 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 06:01:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 937, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  186 ; minimum lost =  0.6625314950942993 ; diff loss =  0.0 ; diff weight =  0.000192322870134376
lambda is : 0.0014677992676220694, cost : 3.549 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 06:05:19 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 823, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  199 ; minimum lost =  0.6665796041488647 ; diff loss =  1.7881393432617188e-07 ; diff weight =  0.000158490554895252
lambda is : 0.0021544346900318843, cost : 2.982 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 06:08:18 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 601, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  236 ; minimum lost =  0.6715715527534485 ; diff loss =  8.344650268554688e-07 ; diff weight =  7.957449997775257e-05
lambda is : 0.003162277660168382, cost : 1.253 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 06:09:33 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 430, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  431 ; minimum lost =  0.6775331497192383 ; diff loss =  5.960464477539063e-08 ; diff weight =  8.347370794581366e-07
lambda is : 0.004641588833612781, cost : 0.326 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 06:09:52 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 386, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  387 ; minimum lost =  0.6821956634521484 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.694292161071644e-07
lambda is : 0.006812920690579613, cost : 0.256 min
==========
Testing lambda: 0.01 starting at 2024-09-28 06:10:08 Max_iter: 1000
At iteration 433, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  425 ; minimum lost =  0.686051070690155 ; diff loss =  0.0 ; diff weight =  1.1499031643324997e-05
lambda is : 0.010000000000000004, cost : 0.292 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 06:10:25 Max_iter: 1000
At iteration 323, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  323 ; minimum lost =  0.6892410516738892 ; diff loss =  0.0 ; diff weight =  1.9195240383851342e-05
lambda is : 0.014677992676220709, cost : 0.217 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 06:10:38 Max_iter: 1000
At iteration 182, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  183 ; minimum lost =  0.6914706230163574 ; diff loss =  1.7881393432617188e-07 ; diff weight =  8.270144462585449e-07
lambda is : 0.02154434690031885, cost : 0.135 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 06:10:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 135, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  135 ; minimum lost =  0.6929482221603394 ; diff loss =  0.0 ; diff weight =  9.585171937942505e-06
lambda is : 0.0316227766016838, cost : 0.112 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 06:10:53 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.017 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 06:10:54 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.016 min
==========
Testing lambda: 0.1 starting at 2024-09-28 06:10:55 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.016 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.334315    0.088571          0.089065            9195  0.992444  0.890227  0.810704   0.758958  0.813264      0.497645       0.052725
0.000015    0.295339    0.100000          0.100529            8123  0.993137  0.891007  0.808392   0.748408  0.810345      0.599295       0.131435
0.000022    0.280832    0.107143          0.107584            7724  0.992360  0.899860  0.826880   0.805654  0.830601      0.621337       0.000063
0.000032    0.240620    0.123571          0.124339            6618  0.994826  0.899976  0.841815   0.819788  0.845173      0.625596       0.000253
0.000046    0.205279    0.142500          0.142857            5646  0.991679  0.884300  0.804138   0.824219  0.808429      0.629945       0.000199
Exporting resultDF
Exporting result Dict
Treg Time elapsed: 66.33610659837723 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for cDC1
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-28 06:11:26 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  978 ; minimum lost =  0.35381048917770386 ; diff loss =  -9.5367431640625e-07 ; diff weight =  0.002253861166536808
lambda is : 9.999999999999997e-06, cost : 4.927 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-28 06:16:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.10657010972499847 ; diff loss =  2.4050474166870117e-05 ; diff weight =  0.02197962999343872
lambda is : 1.4677992676220687e-05, cost : 2.562 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-28 06:18:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.37302762269973755 ; diff loss =  0.0005289614200592041 ; diff weight =  0.1773439198732376
lambda is : 2.1544346900318854e-05, cost : 5.312 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-28 06:24:15 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  598 ; minimum lost =  0.6177411079406738 ; diff loss =  -1.5139579772949219e-05 ; diff weight =  0.0009286192362196743
lambda is : 3.16227766016838e-05, cost : 6.252 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-28 06:30:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.37479764223098755 ; diff loss =  0.0004954040050506592 ; diff weight =  0.17138886451721191
lambda is : 4.6415888336127784e-05, cost : 5.645 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-28 06:36:08 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  616 ; minimum lost =  0.6026026606559753 ; diff loss =  -1.233816146850586e-05 ; diff weight =  0.0009668501443229616
lambda is : 6.81292069057961e-05, cost : 6.376 min
==========
Testing lambda: 0.0001 starting at 2024-09-28 06:42:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  583 ; minimum lost =  0.6019114851951599 ; diff loss =  -1.1861324310302734e-05 ; diff weight =  0.0006068826769478619
lambda is : 9.999999999999991e-05, cost : 6.441 min
==========
Testing lambda: 0.000147 starting at 2024-09-28 06:48:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  584 ; minimum lost =  0.5989210605621338 ; diff loss =  -9.238719940185547e-06 ; diff weight =  0.00178915960714221
lambda is : 0.00014677992676220703, cost : 6.548 min
==========
Testing lambda: 0.000215 starting at 2024-09-28 06:55:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.16779066622257233 ; diff loss =  2.086162567138672e-06 ; diff weight =  0.0008547150064259768
lambda is : 0.0002154434690031884, cost : 3.102 min
==========
Testing lambda: 0.000316 starting at 2024-09-28 06:58:37 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.1978215128183365 ; diff loss =  1.043081283569336e-07 ; diff weight =  7.252902287291363e-05
lambda is : 0.00031622776601683783, cost : 2.91 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 07:01:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  534 ; minimum lost =  0.605990469455719 ; diff loss =  -1.519918441772461e-05 ; diff weight =  0.00029664902831427753
lambda is : 0.00046415888336127795, cost : 7.015 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 07:08:32 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  781 ; minimum lost =  0.25434979796409607 ; diff loss =  -6.884336471557617e-06 ; diff weight =  0.01628595031797886
lambda is : 0.0006812920690579617, cost : 4.62 min
==========
Testing lambda: 0.001 starting at 2024-09-28 07:13:09 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  947 ; minimum lost =  0.5267559289932251 ; diff loss =  -5.0067901611328125e-06 ; diff weight =  2.025106550718192e-05
lambda is : 0.0010000000000000002, cost : 5.37 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 07:18:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  736 ; minimum lost =  0.5836212635040283 ; diff loss =  -9.5367431640625e-07 ; diff weight =  0.008757165633141994
lambda is : 0.0014677992676220694, cost : 5.897 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 07:24:25 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  650 ; minimum lost =  0.5564076900482178 ; diff loss =  -6.556510925292969e-07 ; diff weight =  0.0008177998242899776
lambda is : 0.0021544346900318843, cost : 5.937 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 07:30:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  117 ; minimum lost =  0.6698384881019592 ; diff loss =  -5.125999450683594e-06 ; diff weight =  0.0006380709819495678
lambda is : 0.003162277660168382, cost : 5.919 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 07:36:17 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 732, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  731 ; minimum lost =  0.6498279571533203 ; diff loss =  0.0 ; diff weight =  2.1714022295782343e-05
lambda is : 0.004641588833612781, cost : 2.362 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 07:38:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 858, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  130 ; minimum lost =  0.6788426637649536 ; diff loss =  1.1324882507324219e-06 ; diff weight =  0.0006236589979380369
lambda is : 0.006812920690579613, cost : 2.719 min
==========
Testing lambda: 0.01 starting at 2024-09-28 07:41:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 398, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  149 ; minimum lost =  0.6828333139419556 ; diff loss =  -0.001825094223022461 ; diff weight =  0.0005344431265257299
lambda is : 0.010000000000000004, cost : 1.779 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 07:43:08 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 398, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  238 ; minimum lost =  0.6890153884887695 ; diff loss =  5.960464477539063e-08 ; diff weight =  0.00011214673577342182
lambda is : 0.014677992676220709, cost : 0.514 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 07:43:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 196, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  197 ; minimum lost =  0.6918245553970337 ; diff loss =  1.1920928955078125e-07 ; diff weight =  8.940696716308594e-07
lambda is : 0.02154434690031885, cost : 0.144 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 07:43:48 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 159, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  160 ; minimum lost =  0.6927955150604248 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.1350722312927246e-07
lambda is : 0.0316227766016838, cost : 0.123 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 07:43:55 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.017 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 07:43:56 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.014 min
==========
Testing lambda: 0.1 starting at 2024-09-28 07:43:57 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.015 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.366783    0.304348          0.305556           10088  0.999939  0.982616  0.870073   0.783784  0.865672      0.353810       0.002254
0.000015    0.290903    0.384058          0.388889            8001  1.000000  1.000000  0.953338   0.909091  0.952381      0.106570       0.021980
0.000022    0.355512    0.318841          0.324074            9778  1.000000  1.000000  0.912632   0.833333  0.909091      0.373028       0.177344
0.000032    0.316499    0.362319          0.361111            8705  1.000000  1.000000  0.953338   0.909091  0.952381      0.617741       0.000929
0.000046    0.312282    0.369565          0.370370            8589  1.000000  1.000000  0.983696   0.967742  0.983607      0.374798       0.171389
Exporting resultDF
Exporting result Dict
cDC1 Time elapsed: 92.64910941521326 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for cDC2
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-28 07:44:33 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.11816410720348358 ; diff loss =  5.453824996948242e-06 ; diff weight =  0.008602800779044628
lambda is : 9.999999999999997e-06, cost : 2.757 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-28 07:47:19 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.12674613296985626 ; diff loss =  1.753866672515869e-05 ; diff weight =  0.015620633028447628
lambda is : 1.4677992676220687e-05, cost : 2.902 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-28 07:50:13 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.14193759858608246 ; diff loss =  2.650916576385498e-05 ; diff weight =  0.012042971327900887
lambda is : 2.1544346900318854e-05, cost : 2.858 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-28 07:53:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.1519278585910797 ; diff loss =  1.6421079635620117e-05 ; diff weight =  0.02308412827551365
lambda is : 3.16227766016838e-05, cost : 3.03 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-28 07:56:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.17571136355400085 ; diff loss =  6.282329559326172e-05 ; diff weight =  0.0711972713470459
lambda is : 4.6415888336127784e-05, cost : 3.232 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-28 07:59:20 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  962 ; minimum lost =  0.19665378332138062 ; diff loss =  -9.387731552124023e-07 ; diff weight =  0.006615032907575369
lambda is : 6.81292069057961e-05, cost : 3.773 min
==========
Testing lambda: 0.0001 starting at 2024-09-28 08:03:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  944 ; minimum lost =  0.23100270330905914 ; diff loss =  -6.705522537231445e-07 ; diff weight =  0.0009401361458003521
lambda is : 9.999999999999991e-05, cost : 3.96 min
==========
Testing lambda: 0.000147 starting at 2024-09-28 08:07:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.2644163966178894 ; diff loss =  7.75456428527832e-05 ; diff weight =  0.028001993894577026
lambda is : 0.00014677992676220703, cost : 3.751 min
==========
Testing lambda: 0.000215 starting at 2024-09-28 08:10:49 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  990 ; minimum lost =  0.46776723861694336 ; diff loss =  -8.046627044677734e-07 ; diff weight =  3.699560693348758e-05
lambda is : 0.0002154434690031884, cost : 3.89 min
==========
Testing lambda: 0.000316 starting at 2024-09-28 08:14:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  193 ; minimum lost =  0.5519617199897766 ; diff loss =  0.006018280982971191 ; diff weight =  0.00014155622920952737
lambda is : 0.00031622776601683783, cost : 4.233 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 08:18:57 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  186 ; minimum lost =  0.5582283139228821 ; diff loss =  0.0002238154411315918 ; diff weight =  0.0001224714651471004
lambda is : 0.00046415888336127795, cost : 4.326 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 08:23:16 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  172 ; minimum lost =  0.5610218048095703 ; diff loss =  0.0023123621940612793 ; diff weight =  0.00013823008339386433
lambda is : 0.0006812920690579617, cost : 4.392 min
==========
Testing lambda: 0.001 starting at 2024-09-28 08:27:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  168 ; minimum lost =  0.5671230554580688 ; diff loss =  0.002246260643005371 ; diff weight =  0.0001527985732536763
lambda is : 0.0010000000000000002, cost : 4.127 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 08:31:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  167 ; minimum lost =  0.5732806921005249 ; diff loss =  -3.5762786865234375e-07 ; diff weight =  0.00013520717038773
lambda is : 0.0014677992676220694, cost : 4.636 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 08:36:25 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  167 ; minimum lost =  0.5796328186988831 ; diff loss =  0.0018299221992492676 ; diff weight =  0.00015993646229617298
lambda is : 0.0021544346900318843, cost : 4.809 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 08:41:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  170 ; minimum lost =  0.5884673595428467 ; diff loss =  2.9206275939941406e-06 ; diff weight =  0.00014795007882639766
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.003162277660168382, cost : 3.185 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 08:44:25 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 800, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  174 ; minimum lost =  0.597509503364563 ; diff loss =  0.0 ; diff weight =  0.00014278768503572792
lambda is : 0.004641588833612781, cost : 2.776 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 08:47:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 889, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  191 ; minimum lost =  0.6093165874481201 ; diff loss =  1.7881393432617188e-07 ; diff weight =  0.0001222332357428968
lambda is : 0.006812920690579613, cost : 2.95 min
==========
Testing lambda: 0.01 starting at 2024-09-28 08:50:09 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 690, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  195 ; minimum lost =  0.6199046969413757 ; diff loss =  1.7881393432617188e-07 ; diff weight =  0.00012279328075237572
lambda is : 0.010000000000000004, cost : 1.916 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 08:52:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 646, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  213 ; minimum lost =  0.6301901936531067 ; diff loss =  0.0 ; diff weight =  0.00013428792590275407
lambda is : 0.014677992676220709, cost : 1.599 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 08:53:39 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 574, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  241 ; minimum lost =  0.644004762172699 ; diff loss =  2.384185791015625e-07 ; diff weight =  6.597246101591736e-05
lambda is : 0.02154434690031885, cost : 0.924 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 08:54:35 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 450, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  451 ; minimum lost =  0.6636244654655457 ; diff loss =  5.960464477539063e-08 ; diff weight =  8.395468853450438e-07
lambda is : 0.0316227766016838, cost : 0.301 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 08:54:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 340, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  341 ; minimum lost =  0.6774344444274902 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.73719217350299e-07
lambda is : 0.04641588833612786, cost : 0.238 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 08:55:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 330, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  330 ; minimum lost =  0.6865711212158203 ; diff loss =  0.0 ; diff weight =  3.0994415283203125e-06
lambda is : 0.0681292069057962, cost : 0.237 min
==========
Testing lambda: 0.1 starting at 2024-09-28 08:55:21 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 172, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  173 ; minimum lost =  0.6923079490661621 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.8743019104003906e-07
lambda is : 0.10000000000000002, cost : 0.137 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.342168    0.307087          0.309524            9411  0.999175  0.978728  0.902431   0.864583  0.903811      0.118164       0.008603
0.000015    0.314172    0.335004          0.337743            8641  0.998764  0.976030  0.911046   0.877193  0.912409      0.126746       0.015621
0.000022    0.283850    0.365784          0.369489            7807  0.998136  0.978920  0.920189   0.887324  0.921389      0.141938       0.012043
0.000032    0.248437    0.405154          0.409171            6833  0.997178  0.977165  0.912253   0.882979  0.913761      0.151928       0.023084
0.000046    0.204043    0.452040          0.455026            5612  0.999407  0.984202  0.926012   0.891228  0.927007      0.175711       0.071197
Exporting resultDF
Exporting result Dict
cDC2 Time elapsed: 71.13747413953145 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for dnT
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-28 08:56:01 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 795, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  796 ; minimum lost =  0.17558026313781738 ; diff loss =  4.470348358154297e-08 ; diff weight =  9.621952585803228e-07
lambda is : 9.999999999999997e-06, cost : 0.769 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-28 08:56:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  1000 ; minimum lost =  0.23222124576568604 ; diff loss =  1.341104507446289e-07 ; diff weight =  6.533595296787098e-05
lambda is : 1.4677992676220687e-05, cost : 3.509 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-28 09:00:18 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  965 ; minimum lost =  0.3151586055755615 ; diff loss =  -3.5762786865234375e-07 ; diff weight =  0.0018052896484732628
lambda is : 2.1544346900318854e-05, cost : 5.409 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-28 09:05:42 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  388 ; minimum lost =  0.3564496636390686 ; diff loss =  0.0 ; diff weight =  0.004757384303957224
lambda is : 3.16227766016838e-05, cost : 3.384 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-28 09:09:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  973 ; minimum lost =  0.33114635944366455 ; diff loss =  -2.682209014892578e-06 ; diff weight =  0.00888428557664156
lambda is : 4.6415888336127784e-05, cost : 3.02 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-28 09:12:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 977, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  977 ; minimum lost =  0.35466688871383667 ; diff loss =  0.0 ; diff weight =  1.1116063433291856e-05
lambda is : 6.81292069057961e-05, cost : 0.767 min
==========
Testing lambda: 0.0001 starting at 2024-09-28 09:12:52 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 609, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  608 ; minimum lost =  0.38497060537338257 ; diff loss =  0.0 ; diff weight =  1.9007704850082519e-06
lambda is : 9.999999999999991e-05, cost : 0.537 min
==========
Testing lambda: 0.000147 starting at 2024-09-28 09:13:25 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 655, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  651 ; minimum lost =  0.42073744535446167 ; diff loss =  0.0 ; diff weight =  2.605609324746183e-06
lambda is : 0.00014677992676220703, cost : 0.566 min
==========
Testing lambda: 0.000215 starting at 2024-09-28 09:13:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 662, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  662 ; minimum lost =  0.4728320240974426 ; diff loss =  0.0 ; diff weight =  7.932090738904662e-06
lambda is : 0.0002154434690031884, cost : 0.538 min
==========
Testing lambda: 0.000316 starting at 2024-09-28 09:14:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 690, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  689 ; minimum lost =  0.54083651304245 ; diff loss =  0.0 ; diff weight =  1.8267670611749054e-06
lambda is : 0.00031622776601683783, cost : 0.546 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 09:15:04 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 747, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  747 ; minimum lost =  0.6246402859687805 ; diff loss =  0.0 ; diff weight =  2.4026492155826418e-06
lambda is : 0.00046415888336127795, cost : 0.606 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 09:15:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 386, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  386 ; minimum lost =  0.690224289894104 ; diff loss =  0.0 ; diff weight =  4.024346708320081e-06
lambda is : 0.0006812920690579617, cost : 0.271 min
==========
Testing lambda: 0.001 starting at 2024-09-28 09:15:56 Max_iter: 1000
At iteration 373, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  372 ; minimum lost =  0.6910936832427979 ; diff loss =  0.0 ; diff weight =  1.4408940842258744e-05
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.0010000000000000002, cost : 0.264 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 09:16:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 342, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  340 ; minimum lost =  0.6917246580123901 ; diff loss =  0.0 ; diff weight =  7.821163308108225e-06
lambda is : 0.0014677992676220694, cost : 0.241 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 09:16:27 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 297, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  296 ; minimum lost =  0.6922343969345093 ; diff loss =  0.0 ; diff weight =  1.1264544809819199e-05
lambda is : 0.0021544346900318843, cost : 0.218 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 09:16:40 Max_iter: 1000
At iteration 243, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  242 ; minimum lost =  0.6926604509353638 ; diff loss =  0.0 ; diff weight =  2.4870470952009782e-05
lambda is : 0.003162277660168382, cost : 0.17 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 09:16:50 Max_iter: 1000
At iteration 257, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  256 ; minimum lost =  0.6929560899734497 ; diff loss =  0.0 ; diff weight =  3.671241529445979e-06
lambda is : 0.004641588833612781, cost : 0.193 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 09:17:01 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 164, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  164 ; minimum lost =  0.6930832862854004 ; diff loss =  0.0 ; diff weight =  1.7916510842042044e-05
lambda is : 0.006812920690579613, cost : 0.135 min
==========
Testing lambda: 0.01 starting at 2024-09-28 09:17:10 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 35, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  35 ; minimum lost =  0.6931461095809937 ; diff loss =  0.0 ; diff weight =  1.5253666788339615e-05
lambda is : 0.010000000000000004, cost : 0.053 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 09:17:13 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.014677992676220709, cost : 0.017 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 09:17:14 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.02154434690031885, cost : 0.014 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 09:17:15 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0316227766016838, cost : 0.014 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 09:17:15 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.04641588833612786, cost : 0.014 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 09:17:16 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.0681292069057962, cost : 0.014 min
==========
Testing lambda: 0.1 starting at 2024-09-28 09:17:17 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.014 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.197462    0.202091          0.200000            5431  0.968486  0.676663  0.678601   0.868421  0.660000      0.175580   9.621953e-07
0.000015    0.198044    0.212544          0.213333            5447  0.963023  0.671916  0.681429   0.850000  0.666667      0.232221   6.533595e-05
0.000022    0.213496    0.205575          0.204444            5872  0.956702  0.670399  0.687793   0.891892  0.666667      0.315159   1.805290e-03
0.000032    0.231603    0.188153          0.191111            6370  0.951462  0.676985  0.692913   0.853659  0.679612      0.356450   4.757384e-03
0.000046    0.183319    0.219512          0.220000            5042  0.959309  0.674112  0.653066   0.804878  0.640777      0.331146   8.884286e-03
Exporting resultDF
Exporting result Dict
dnT Time elapsed: 21.457030653953552 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for gdT
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-28 09:17:56 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  709 ; minimum lost =  0.1495697796344757 ; diff loss =  -4.470348358154297e-08 ; diff weight =  0.00014033984916750342
lambda is : 9.999999999999997e-06, cost : 2.959 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-28 09:20:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  999 ; minimum lost =  0.15225473046302795 ; diff loss =  0.0 ; diff weight =  4.444271689862944e-05
lambda is : 1.4677992676220687e-05, cost : 1.114 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-28 09:22:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  707 ; minimum lost =  0.15593945980072021 ; diff loss =  0.0 ; diff weight =  0.0002124293678207323
lambda is : 2.1544346900318854e-05, cost : 2.693 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-28 09:24:42 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 943, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  942 ; minimum lost =  0.16074854135513306 ; diff loss =  0.0 ; diff weight =  9.085555575438775e-06
lambda is : 3.16227766016838e-05, cost : 1.065 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-28 09:25:46 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 953, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  953 ; minimum lost =  0.16731664538383484 ; diff loss =  0.0 ; diff weight =  1.9778578916884726e-06
lambda is : 4.6415888336127784e-05, cost : 0.906 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-28 09:26:40 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 713, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  713 ; minimum lost =  0.1762300729751587 ; diff loss =  0.0 ; diff weight =  4.004802121926332e-06
lambda is : 6.81292069057961e-05, cost : 0.74 min
==========
Testing lambda: 0.0001 starting at 2024-09-28 09:27:24 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 699, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  697 ; minimum lost =  0.18843163549900055 ; diff loss =  0.0 ; diff weight =  5.935148146818392e-05
lambda is : 9.999999999999991e-05, cost : 0.675 min
==========
Testing lambda: 0.000147 starting at 2024-09-28 09:28:05 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 938, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  933 ; minimum lost =  0.20520077645778656 ; diff loss =  0.0 ; diff weight =  3.6224816994945286e-06
lambda is : 0.00014677992676220703, cost : 0.777 min
==========
Testing lambda: 0.000215 starting at 2024-09-28 09:28:52 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 711, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  711 ; minimum lost =  0.22821277379989624 ; diff loss =  0.0 ; diff weight =  6.161320925457403e-06
lambda is : 0.0002154434690031884, cost : 0.607 min
==========
Testing lambda: 0.000316 starting at 2024-09-28 09:29:28 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 777, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  774 ; minimum lost =  0.25952035188674927 ; diff loss =  0.0 ; diff weight =  4.409428584040143e-06
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00031622776601683783, cost : 0.637 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 09:30:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 794, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  794 ; minimum lost =  0.3015354573726654 ; diff loss =  0.0 ; diff weight =  1.9451276784820948e-06
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.00046415888336127795, cost : 0.637 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 09:30:44 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 806, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  807 ; minimum lost =  0.3566392660140991 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.839259198277432e-07
lambda is : 0.0006812920690579617, cost : 0.639 min
==========
Testing lambda: 0.001 starting at 2024-09-28 09:31:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 787, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  788 ; minimum lost =  0.4265485107898712 ; diff loss =  2.9802322387695312e-08 ; diff weight =  1.8940586699045525e-07
lambda is : 0.0010000000000000002, cost : 0.601 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 09:31:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 809, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  805 ; minimum lost =  0.5109728574752808 ; diff loss =  0.0 ; diff weight =  1.910330183818587e-06
lambda is : 0.0014677992676220694, cost : 0.649 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 09:32:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 757, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  757 ; minimum lost =  0.6048394441604614 ; diff loss =  0.0 ; diff weight =  4.7709008867968805e-06
lambda is : 0.0021544346900318843, cost : 0.753 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 09:33:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 795, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  268 ; minimum lost =  0.6574122905731201 ; diff loss =  5.960464477539063e-08 ; diff weight =  0.00026873417664319277
lambda is : 0.003162277660168382, cost : 0.906 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 09:34:17 Max_iter: 1000
At iteration 511, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  512 ; minimum lost =  0.6644261479377747 ; diff loss =  5.960464477539063e-08 ; diff weight =  1.922183656688503e-07
lambda is : 0.004641588833612781, cost : 0.347 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 09:34:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 362, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  363 ; minimum lost =  0.6683836579322815 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.508563904437324e-07
lambda is : 0.006812920690579613, cost : 0.244 min
==========
Testing lambda: 0.01 starting at 2024-09-28 09:34:53 Max_iter: 1000
At iteration 503, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  504 ; minimum lost =  0.6725860834121704 ; diff loss =  5.960464477539063e-08 ; diff weight =  4.691416677360394e-07
lambda is : 0.010000000000000004, cost : 0.34 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 09:35:13 Max_iter: 1000
At iteration 440, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  441 ; minimum lost =  0.6766335368156433 ; diff loss =  5.960464477539063e-08 ; diff weight =  2.180820644070991e-07
lambda is : 0.014677992676220709, cost : 0.283 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 09:35:30 Max_iter: 1000
At iteration 416, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  417 ; minimum lost =  0.6803383231163025 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.266009116487112e-07
lambda is : 0.02154434690031885, cost : 0.276 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 09:35:47 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 403, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  404 ; minimum lost =  0.6844698190689087 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.295145063475502e-07
lambda is : 0.0316227766016838, cost : 0.266 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 09:36:03 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 351, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  352 ; minimum lost =  0.6884704232215881 ; diff loss =  5.960464477539063e-08 ; diff weight =  3.2782554626464844e-07
lambda is : 0.04641588833612786, cost : 0.246 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 09:36:17 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 185, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  186 ; minimum lost =  0.6919256448745728 ; diff loss =  1.1920928955078125e-07 ; diff weight =  3.0547380447387695e-07
lambda is : 0.0681292069057962, cost : 0.148 min
==========
Testing lambda: 0.1 starting at 2024-09-28 09:36:26 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.017 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.267997    0.147532          0.147376            7371  0.991151  0.915374  0.834461   0.820707  0.839793      0.149570       0.000140
0.000015    0.230912    0.164700          0.165545            6351  0.989458  0.905237  0.815227   0.804569  0.821244      0.152255       0.000044
0.000022    0.199753    0.186695          0.187752            5494  0.992108  0.919192  0.832739   0.815000  0.838046      0.155939       0.000212
0.000032    0.164049    0.210300          0.211306            4512  0.992613  0.916988  0.837453   0.841689  0.842801      0.160749       0.000009
0.000046    0.132163    0.243562          0.244280            3635  0.993947  0.927768  0.856156   0.854167  0.860892      0.167317       0.000002
Exporting resultDF
Exporting result Dict
gdT Time elapsed: 18.657888154188793 minutes.
Z-transformed rep_cells adata: (57515, 27504)
TYPE <class 'numpy.ndarray'>
====================
Starting job for pDC
[-11.51292546 -11.12916128 -10.7453971  -10.36163292  -9.97786874
  -9.59410455  -9.21034037  -8.82657619  -8.44281201  -8.05904783
  -7.67528364  -7.29151946  -6.90775528  -6.5239911   -6.14022691
  -5.75646273  -5.37269855  -4.98893437  -4.60517019  -4.221406
  -3.83764182  -3.45387764  -3.07011346  -2.68634928  -2.30258509]
[1.00000000e-05 1.46779927e-05 2.15443469e-05 3.16227766e-05
 4.64158883e-05 6.81292069e-05 1.00000000e-04 1.46779927e-04
 2.15443469e-04 3.16227766e-04 4.64158883e-04 6.81292069e-04
 1.00000000e-03 1.46779927e-03 2.15443469e-03 3.16227766e-03
 4.64158883e-03 6.81292069e-03 1.00000000e-02 1.46779927e-02
 2.15443469e-02 3.16227766e-02 4.64158883e-02 6.81292069e-02
 1.00000000e-01]
Alpha: 0.01
Weight tolerance: 1e-06
Testing lambda: 1e-05 starting at 2024-09-28 09:36:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  976 ; minimum lost =  0.06685411930084229 ; diff loss =  -2.9802322387695312e-08 ; diff weight =  0.3139885365962982
lambda is : 9.999999999999997e-06, cost : 2.418 min
==========
Testing lambda: 1.5e-05 starting at 2024-09-28 09:39:23 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  784 ; minimum lost =  0.17155534029006958 ; diff loss =  -5.9157609939575195e-06 ; diff weight =  0.002096461597830057
lambda is : 1.4677992676220687e-05, cost : 4.327 min
==========
Testing lambda: 2.2e-05 starting at 2024-09-28 09:43:43 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  792 ; minimum lost =  0.183875173330307 ; diff loss =  -7.331371307373047e-06 ; diff weight =  0.0010463288053870201
lambda is : 2.1544346900318854e-05, cost : 4.176 min
==========
Testing lambda: 3.2e-05 starting at 2024-09-28 09:47:53 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  985 ; minimum lost =  0.1530163586139679 ; diff loss =  -3.5017728805541992e-06 ; diff weight =  0.007193399593234062
lambda is : 3.16227766016838e-05, cost : 3.949 min
==========
Testing lambda: 4.6e-05 starting at 2024-09-28 09:51:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  863 ; minimum lost =  0.14206412434577942 ; diff loss =  -1.043081283569336e-07 ; diff weight =  0.0002520387643016875
lambda is : 4.6415888336127784e-05, cost : 3.665 min
==========
Testing lambda: 6.8e-05 starting at 2024-09-28 09:55:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  921 ; minimum lost =  0.1512548327445984 ; diff loss =  -9.685754776000977e-07 ; diff weight =  0.00043040630407631397
lambda is : 6.81292069057961e-05, cost : 3.122 min
==========
Testing lambda: 0.0001 starting at 2024-09-28 09:58:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  942 ; minimum lost =  0.13105793297290802 ; diff loss =  -2.9802322387695312e-08 ; diff weight =  9.97528786683688e-06
lambda is : 9.999999999999991e-05, cost : 3.003 min
==========
Testing lambda: 0.000147 starting at 2024-09-28 10:01:38 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  870 ; minimum lost =  0.1707194447517395 ; diff loss =  -8.195638656616211e-07 ; diff weight =  8.496759255649522e-05
lambda is : 0.00014677992676220703, cost : 3.603 min
==========
Testing lambda: 0.000215 starting at 2024-09-28 10:05:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  975 ; minimum lost =  0.1862943172454834 ; diff loss =  -2.2351741790771484e-07 ; diff weight =  1.3913017937738914e-05
lambda is : 0.0002154434690031884, cost : 2.728 min
==========
Testing lambda: 0.000316 starting at 2024-09-28 10:07:58 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  955 ; minimum lost =  0.206049382686615 ; diff loss =  -5.513429641723633e-07 ; diff weight =  0.0006776718073524535
lambda is : 0.00031622776601683783, cost : 3.028 min
==========
Testing lambda: 0.000464 starting at 2024-09-28 10:10:59 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  783 ; minimum lost =  0.34032341837882996 ; diff loss =  -1.043081283569336e-06 ; diff weight =  6.236547778826207e-05
lambda is : 0.00046415888336127795, cost : 4.509 min
==========
Testing lambda: 0.000681 starting at 2024-09-28 10:15:30 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  765 ; minimum lost =  0.3093568682670593 ; diff loss =  -1.4007091522216797e-06 ; diff weight =  4.3499494495335966e-05
lambda is : 0.0006812920690579617, cost : 4.607 min
==========
Testing lambda: 0.001 starting at 2024-09-28 10:20:06 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  719 ; minimum lost =  0.3569682538509369 ; diff loss =  -3.5762786865234375e-07 ; diff weight =  2.131013934558723e-05
lambda is : 0.0010000000000000002, cost : 4.939 min
==========
Testing lambda: 0.001468 starting at 2024-09-28 10:25:03 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  790 ; minimum lost =  0.4195828437805176 ; diff loss =  -2.086162567138672e-06 ; diff weight =  0.00013282020518090576
lambda is : 0.0014677992676220694, cost : 5.536 min
==========
Testing lambda: 0.002154 starting at 2024-09-28 10:30:35 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  619 ; minimum lost =  0.34942659735679626 ; diff loss =  -4.172325134277344e-07 ; diff weight =  3.091463804594241e-05
lambda is : 0.0021544346900318843, cost : 5.681 min
==========
Testing lambda: 0.003162 starting at 2024-09-28 10:36:16 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  695 ; minimum lost =  0.35564640164375305 ; diff loss =  -2.9802322387695312e-08 ; diff weight =  0.0026220513973385096
lambda is : 0.003162277660168382, cost : 4.58 min
==========
Testing lambda: 0.004642 starting at 2024-09-28 10:40:50 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 947, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  948 ; minimum lost =  0.4059833884239197 ; diff loss =  2.9802322387695312e-08 ; diff weight =  2.5947707626983174e-07
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
lambda is : 0.004641588833612781, cost : 2.156 min
==========
Testing lambda: 0.006813 starting at 2024-09-28 10:43:00 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  934 ; minimum lost =  0.6037870049476624 ; diff loss =  -8.940696716308594e-07 ; diff weight =  0.017746545374393463
lambda is : 0.006812920690579613, cost : 6.123 min
==========
Testing lambda: 0.01 starting at 2024-09-28 10:49:07 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  120 ; minimum lost =  0.6455869674682617 ; diff loss =  -7.152557373046875e-07 ; diff weight =  7.172283949330449e-05
lambda is : 0.010000000000000004, cost : 6.115 min
==========
Testing lambda: 0.014678 starting at 2024-09-28 10:55:14 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
OWL-QN did not convergence, Device: cuda
OWL-QN did not convergence, Device: cuda
minimum epoch =  151 ; minimum lost =  0.65780109167099 ; diff loss =  -5.960464477539062e-07 ; diff weight =  7.343586185015738e-05
lambda is : 0.014677992676220709, cost : 6.133 min
==========
Testing lambda: 0.021544 starting at 2024-09-28 11:01:22 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 392, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  200 ; minimum lost =  0.6687124967575073 ; diff loss =  -0.0018265247344970703 ; diff weight =  7.084530807333067e-05
lambda is : 0.02154434690031885, cost : 0.83 min
==========
Testing lambda: 0.031623 starting at 2024-09-28 11:02:12 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 407, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  407 ; minimum lost =  0.6835529804229736 ; diff loss =  0.0 ; diff weight =  1.8976925275637768e-06
lambda is : 0.0316227766016838, cost : 0.321 min
==========
Testing lambda: 0.046416 starting at 2024-09-28 11:02:31 Max_iter: 1000
/home/jovyan/work/GitHub/EvanPys/Progress/ADlasso2/AD2_w_utils_weightdiff.py:167: UserWarning: line search did not converge.
  warnings.warn('line search did not converge.')
At iteration 213, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  214 ; minimum lost =  0.6894537210464478 ; diff loss =  1.7881393432617188e-07 ; diff weight =  2.432874168789567e-07
lambda is : 0.04641588833612786, cost : 0.152 min
==========
Testing lambda: 0.068129 starting at 2024-09-28 11:02:40 Max_iter: 1000
At iteration 134, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  134 ; minimum lost =  0.6926374435424805 ; diff loss =  0.0 ; diff weight =  1.019896717480151e-05
lambda is : 0.0681292069057962, cost : 0.109 min
==========
Testing lambda: 0.1 starting at 2024-09-28 11:02:47 Max_iter: 1000
At iteration 0, Convergence with weight difference, Device: cuda
Convergence with weight difference, Device: cuda
minimum epoch =  1 ; minimum lost =  0.6931473612785339 ; diff loss =  998.3068526387215 ; diff weight =  0.0
lambda is : 0.10000000000000002, cost : 0.018 min
==========
          Percentage  Prevalence  Train_prevalence  Feature_number       AUC      AUPR       MCC  Precision  F1 score  loss_history  error_history
0.000010    0.223458    0.356784          0.357143            6146  0.999951  0.995448  0.939133   0.883212  0.937984      0.066854       0.313989
0.000015    0.305519    0.274707          0.275210            8403  0.995476  0.983631  0.855452   0.740741  0.848057      0.171555       0.002096
0.000022    0.270215    0.309883          0.310924            7432  0.987786  0.976677  0.865732   0.771242  0.861314      0.183875       0.001046
0.000032    0.228585    0.350084          0.350840            6287  0.999860  0.991513  0.941771   0.895522  0.941176      0.153016       0.007193
0.000046    0.176083    0.423786          0.424370            4843  0.985010  0.978232  0.929406   0.887218  0.929134      0.142064       0.000252
Exporting resultDF
Exporting result Dict
pDC Time elapsed: 85.95979214906693 minutes.
***** Finished lambda tuning
====================
